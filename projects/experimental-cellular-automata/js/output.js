(()=>{"use strict";var e={},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,i),a.exports}class n{constructor(e,t){this.width=e,this.height=t,this.data=new Uint8Array(this.width*this.height),this.rows=new Array(this.height),this.transposed=!1,this.get=this.getNormal,this.set=this.setNormal}static fromArray(e,t=!1,i=!1,r=!1){const a=e.length,o=e[0].length,s=new n(o,a);for(let t=0;t<a;t++){r&&(t=a-t-1);for(let n=0;n<o;n++)i&&(n=o-n-1),s.set(t,n,e[t][n])}return t&&s.transpose(),s}toArray(){const e=[];for(let t=0;t<this.height;t++){const i=[];for(let e=0;e<this.width;e++)i.push(this.get(t,e));e.push(i)}return e}clone(){const e=new n;for(let t in this)this.hasOwnProperty(t)&&("object"==typeof this[t]&&null!==this[t]?e[t]=JSON.parse(JSON.stringify(this[t])):e[t]=this[t]);return e}transpose(){[this.width,this.height]=[this.height,this.width],[this.get,this.set]=this.transposed?[this.getNormal,this.setNormal]:[this.getTransposed,this.setTransposed],this.transposed=!this.transposed}flipX(){for(let e=0;e<this.height;e++)for(let t=0;t<this.width/2;t++){const i=this.get(e,t);this.set(e,t,this.get(e,this.width-t-1)),this.set(e,this.width-t-1,i)}}flipY(){for(let e=0;e<this.height/2;e++)for(let t=0;t<this.width;t++){const i=this.get(e,t);this.set(e,t,this.get(this.height-e-1,t)),this.set(this.height-e-1,t,i)}}getNormal(e,t){return this.data[e*this.width+t]}setNormal(e,t,i){this.data[e*this.width+t]=i}getTransposed(e,t){return this.data[t*this.height+e]}setTransposed(e,t,i){this.data[t*this.height+e]=i}}function r(e){let t=Object.values(e).reduce(((e,t)=>e+t),0),i=Object.values(e).reduce(((e,i,n)=>[...e,i/t+(e[n-1]||0)]),[]);return function(){let t=Math.random(),n=i.findIndex((e=>t<e));return Object.keys(e)[n]}}const a=15;function o(e,t,i,n,r,a,o,s,l){const h=n.height-1,g=n.width-1,d=n.data,c=n.width;var u=r[0],m=r[1];let f;for(var y=-1;y<=1;y++)for(var C=-1;C<=1;C++){if(0==y&&0==C)continue;if(a[0]=((-1===y?1:y)+(-1===C?1:C))%2,a[o%4+1]=-1==y?1:0,a[(1+o)%4+1]=-1==C?1:0,a[(2+o)%4+1]=1==y?1:0,a[(3+o)%4+1]=1==C?1:0,a[(1+o)%2+5]=y*C==1?0:1,a[o%2+5]=y*C==-1?0:1,0==t||0==i||t==h||i==g)var[b,S]=e.findNeighbour(e,t,i,y,C);else var b=t+y,S=i+C;const n=d[b*c+S],r=n%s,w=Math.floor(n/s)%l;f=0;for(var B=0;B<s-1;B++)r==B+1&&(u[B]+=1,f+=s,u[f+B]+=a[0],f+=s,u[f+B]+=1-a[0],f+=s,u[f+B]+=a[1],f+=s,u[f+B]+=1-a[1],f+=s,u[f+B]+=a[2],f+=s,u[f+B]+=1-a[2],f+=s,u[f+B]+=a[3],f+=s,u[f+B]+=1-a[3],f+=s,u[f+B]+=a[4],f+=s,u[f+B]+=1-a[4],f+=s,u[f+B]+=a[5],f+=s,u[f+B]+=1-a[5],f+=s,u[f+B]+=a[6],f+=s,u[f+B]+=1-a[6]),f=0;for(f=0,B=0;B<l;B++)w==B&&(m[B]+=1,f+=l,m[f+B]+=a[0],f+=l,m[f+B]+=1-a[0],f+=l,m[f+B]+=a[1],f+=l,m[f+B]+=1-a[1],f+=l,m[f+B]+=a[2],f+=l,m[f+B]+=1-a[2],f+=l,m[f+B]+=a[3],f+=l,m[f+B]+=1-a[3],f+=l,m[f+B]+=a[4],f+=l,m[f+B]+=1-a[4],f+=l,m[f+B]+=a[5],f+=l,m[f+B]+=1-a[5],f+=l,m[f+B]+=a[6],f+=l,m[f+B]+=1-a[6]),f=0}return[u,m]}const s="mix",l="isotropic",h="xcross",g="vcross",d="xvcross",c="directional1",u="directional2",m="directional3",f="directional2b",y="directional",C="hexagonal1",b="hexagonal2",S={[s]:.2,[l]:.4,[h]:.05,[g]:.05,[d]:.05,[c]:.05,[u]:.05,[m]:.05,[f]:.05,[y]:.05,[C]:.05,[b]:.05};function B(e,t){var i,n=t;if(n==s){var r=Math.random();n=r<.5?l:r<.7?h:r<.9?g:y}return n==l?Math.floor(Math.random()*e):n==g?Math.floor(Math.random()*e+e):n==h?Math.floor(Math.random()*e+2*e):n==d?Math.floor(2*Math.random()*e+e):n==c?Math.floor(2*Math.random()*e+3*e):n==u?Math.floor(4*Math.random()*e+3*e):n==m?Math.floor(6*Math.random()*e+3*e):n==f?((i=Math.floor(4*Math.random()*e+3*e))>=5*e&&(i+=2*e),i):n==y?Math.floor(8*Math.random()*e+3*e):n==C?((i=Math.floor(2*Math.random()*e+11*e))>=12*e&&(i+=e),i):n==b?((i=Math.floor(2*Math.random()*e+12*e))>=13*e&&(i+=e),i):void 0}function w(e){var t=8;return[1,2].includes(e)?t=4:[3,5,7,9].includes(e)?t=3:[4,6,8,10].includes(e)?t=5:[11,13].includes(e)?t=6:[12,14].includes(e)&&(t=2),t}const p="A",v="C",M="E",I="B";class N{constructor(e,t,i,n,r,a=null,o=4){this.type=e,this.threshold=t,this.neighbourType=i,this.inactivation=n,this.modulo=r,this.periodicity=a,this.nStatesPrimary=o,this.testInactive=function(e,t){return e==v?function(e){return 0==e}:e==p?function(e){return e%t==0}:function(e){return!0}}(this.inactivation,this.modulo);var s=[i[0],i[1][0]*o+i[1][1]];this.neighbourType.length>2&&s.push(i[2][0]*o+i[2][1]),this.testValue=function(e,t,i){return t==M&&2==i.length?function(t){return t[i[0]][i[1]]==e}:t==I&&2==i.length?function(t){return t[i[0]][i[1]]>e}:t==M&&3==i.length?function(t){return t[i[0]][i[1]]+t[i[0]][i[2]]==e}:t==I&&3==i.length?function(t){return t[i[0]][i[1]]+t[i[0]][i[2]]>e}:void 0}(this.threshold,this.type,s),this.testPeriodicity=function(e){let t;return t=null==e?function(e){return!0}:function(t){return e[t%e.length]},t}(a)}test(e,t,i){var n=this.testPeriodicity(i);return this.testValue(e)&&this.testInactive(t)&&n}name(){var e="";null!=this.periodicity&&this.periodicity.length>1&&(e=this.periodicity.map((e=>e?"1":"0")).join(""));var t=`${this.neighbourType[0]}|`;t+=`${this.neighbourType[1][0]}:${this.neighbourType[1][1]}`,this.neighbourType.length>2&&(t+=`|${this.neighbourType[2][0]}:${this.neighbourType[2][1]}`);var i=this.inactivation;return this.inactivation==p&&(i+=this.modulo),`${this.type}${this.threshold}${i}[${t}]${e}`}static fromName(e){var t=null,i=4;e.startsWith(M)?t=M:e.startsWith(I)&&(t=I);var n=e.substring(t.length),r=parseInt(n.substring(0,1)),a=null;(n=n.substring(1)).startsWith(v)?a=v:n.startsWith(p)?(isNaN(n.charAt(1))||(i=parseInt(n.charAt(1)),n=n.substring(1)),a=p):n.startsWith("N")&&(a="N");var o=(n=n.substring(a.length)).split("[")[1].split("]")[0].split("|"),s=[parseInt(o[0])],l=o[1].split(":").map((e=>parseInt(e)));if(s.push(l),o.length>2){var h=o[2].split(":").map((e=>parseInt(e)));s.push(h)}var g=null;return(n=n.split("]")[1]).length>0&&(g=n.split("").map((e=>"1"===e))),new N(t,r,s,a,i,g)}static randomSample(e,t,i=null,n=s,a=null){var o=[e,t];const l=[M,I],h=l[Math.floor(Math.random()*l.length)],g=[v,p,"N"],d=g[Math.floor(Math.random()*g.length)];null===i&&(i={0:2/3,1:1/3});const c=r(i)(),u=B(o[c],n),m=[Math.floor(u/o[c]),u%o[c]];var f=void 0;if(Math.random()<.5){for(var y=B(o[c],n);u==y;)y=B(o[c],n);f=[c,m,[Math.floor(y/o[c]),y%o[c]]]}else f=[c,m];var C,b=0,S=w(f[1][0]);if(f.length>2&&w(f[2][0])>S&&(S=w(f[2][0])),b=h===I?Math.floor(Math.random()*S):Math.floor(Math.random()*S)+1,C=Math.random()<.5&&d==p?Math.floor(5*Math.random())+2:0==c?e:t,Math.random()<.2)R=null;else{var R;null==a&&(a=Math.floor(20*Math.random())+2);do{R=new Array(a).fill(0).map((()=>Math.random()<.5))}while(!R.includes(!0))}return new N(h,b,f,d,C,R,e)}}function R(e){return e.replace(/\[([0-9]+)\]|\{([0-9A-Za-z|]+)\}/g,((e,t,i)=>{if(t){let e="";for(const i of t)Math.random()>.5&&(e+=i);return e}if(i){const e=i.split("|");return e[Math.floor(Math.random()*e.length)]}}))}class x{constructor(){this.nStates=void 0}updateRule(e,t,i,n){throw new Error("Must override method")}getName(){throw new Error("Must override method")}}class P extends x{constructor(e){super(),this.seedingPatterns=this.getSeedingPatterns(),this.constructSeedingSampler(e,!0),this.randomnessLogShift=0}getSeedingPatterns(){throw new Error("Must override method")}constructSeedingSampler(e,t=!0){t&&null!=e.config.ruleConfig.randomnessConfig&&(e.config.randomnessConfig=e.config.ruleConfig.randomnessConfig);let i=e.config.randomnessConfig;i.seedMasks=Object.keys(i.seedingPatterns).reduce(((e,t)=>(e[t]=i.seedingPatterns[t].mask,e)),{}),i.seedMasksAsArrays=Object.keys(i.seedingPatterns).reduce(((e,t)=>(null!=i.seedingPatterns[t].mask?e[t]=i.seedingPatterns[t].mask.toArray():e[t]=null,e)),{}),i.seedProb=Object.keys(i.seedingPatterns).reduce(((e,t)=>(e[t]=i.seedingPatterns[t].prob,e)),{}),i.seedSampler=r(i.seedProb)}}class k extends P{constructor(e,t){super(e),null==t&&(t=k.generateRule()),this.initialiseRule(t)}updateRule(e,t,i,n){var r=e%this.nStates;return 1==r&&this.survive.includes(i[0][this.neighbourhood[0]])?t=1:r>0&&r<this.nStates-1?t+=1:r==this.nStates-1?t=0:0==r&&this.birth.includes(i[0][this.neighbourhood[1]])?t=1:0==r&&this.inhibited.includes(i[0][this.neighbourhood[2]])&&(t=this.nStates-1),t}initialiseRule(e){this.ruleString=R(e),console.log("Sampled rulestring: ",this.ruleString);const t=this.ruleString.split("/");for(var i of(this.neighbourhood=[0,0,0],this.inhibited=[],this.nStates=Number(t[t.length-1]),t))"N"==i[0]?(this.neighbourhood=i.substring(1).split("|").map((e=>{const[t,i]=e.split(":");return i?parseInt(t)*this.nStates+parseInt(i):parseInt(t)})),this.neighbourhood.length<3&&(this.neighbourhood=[this.neighbourhood[0],this.neighbourhood[0],this.neighbourhood[0]])):"B"==i[0]?this.birth=new Uint8Array(i.substring(1).split("").map(Number)):"S"==i[0]?this.survive=new Uint8Array(i.substring(1).split("").map(Number)):"I"==i[0]&&(this.inhibited=new Uint8Array(i.substring(1).split("").map(Number)))}static generateRule(e){let t=Math.floor(10*Math.random())+3,i=[8,8,8];null==e&&(e=[Math.floor(Math.random()*a*t),Math.floor(Math.random()*a*t),Math.floor(Math.random()*a*t)]);let n=[Math.floor(e[0]/t)%a,Math.floor(e[1]/t)%a,Math.floor(e[2]/t)%a];for(let e=0;e<3;e++)i[e]=w(n[e]);let r=this.generateRandomArray(1,i[0]);0==r.length&&(r=[2]);let o=this.generateRandomArray(1,i[1]),s=this.generateRandomArray(1,i[2]);return s=s.filter((e=>!r.includes(e)&&!o.includes(e)&&2!=e)),this.getRuleString(e,r,o,s,t)}static getRuleString(e,t,i,n,r){return`N${e.map((e=>Math.floor(e/r)%a+":"+e%r)).join("|")}/B${t.join("")}/S${i.join("")}/I${n.join("")}/${r}`}static generateRandomArray(e,t){let i=[];for(let n=e;n<=t;n++)Math.random()<.5&&i.push(n);return i}getName(){return this.ruleString}getSeedingPatterns(){return{random:{prob:1,mask:null}}}}class E extends k{constructor(e,t,i=null){if(super(e,null),"ships"==i){this.initialiseRule(this.ruleString),this.neighbourhood[0]=0;let e=Array.from(this.birth).indexOf(1);if(-1!==e){let t=new Uint8Array(this.birth.length-1);t.set(this.birth.subarray(0,e),0),t.set(this.birth.subarray(e+1),e),this.birth=t}if(-1===this.birth.indexOf(2)){let e=new Uint8Array(this.birth.length+1);e[0]=2,e.set(this.birth,1),this.birth=e}if(e=Array.from(this.survive).indexOf(1),-1!==e){let t=new Uint8Array(this.survive.length-1);t.set(this.survive.subarray(0,e),0),t.set(this.survive.subarray(e+1),e),this.survive=t}this.inhibited=this.inhibited.filter((e=>!this.birth.includes(e)&&!this.survive.includes(e)&&2!=e)),this.ruleString=k.getRuleString(this.neighbourhood,this.birth,this.survive,this.inhibited,this.nStates),this.activationSeed=8,this.randomnessLogShift=.5}else this.activationSeed=20,this.randomnessLogShift=1.5;this.initialiseRule(t),this.activationFactor=this.activationSeed/this.birth[0]**3}updateRule(e,t,i,n,r){var a=e%this.nStates;return 1==a&&this.survive.includes(i[0][this.neighbourhood[0]])?t=1:a>0&&a<this.nStates-1?t+=1:a==this.nStates-1?t=0:0==a&&this.birth.includes(i[0][this.neighbourhood[1]])&&Math.random()>this.activationFactor*r-.05?t=1:0==a&&this.inhibited.includes(i[0][this.neighbourhood[2]])&&(t=this.nStates-1),t}getName(){return`SGen${this.activationSeed}/${this.ruleString}`}initialiseRule(e){if("SGen"==(e=R(e)).substring(0,4)){e.split("/")[0].length>4&&(this.activationSeed=parseFloat(e.split("/")[0].substring(4)));const t=e.split("/").slice(1).join("/");super.initialiseRule(t)}else super.initialiseRule(e)}}class L extends x{constructor(e,t,i,n,r=4){super(),this.conditions=e,this.nStates=this.conditions.length+1,this.nStatesPrimary=r,this.conditionLevels=t,this.neighbourhoodGeometryType=i,this.periodicityLength=n}updateRule(e,t,i,n){t=0;for(let r=0;r<this.conditions.length;r++)if(this.conditions[r].test(i,e,n)){t=r+1;break}return t}getName(){return this.conditions.map((e=>e.name())).join("||")}static sampleRule(e,t){var i=e.nConditions,n=e.chosenConditionLevels,a=e.neighbourhoodGeometryType,o=e.periodicityLength,s=[];null==i&&(i=Math.floor(8*Math.random())+2),null==a&&(a=r(S)()),null==o&&(o=this.samplePeriodicityLength());var l=i+1;for(let e=0;e<i;e++)s.push(N.randomSample(t,l,n,a,o));return console.log((new Date).toLocaleTimeString()+" Sampling coloring rule "+a+": "+s.map((e=>e.name())).join(", ")),new L(s,n,a,o,t)}static samplePeriodicityLength(){var e=Math.random();return e<.2?null:e<.6?1:e<.7?2:e<.8?3:e<.9?4:Math.floor(20*Math.random())+5}static ruleFromNames(e){var t=(e=R(e)).split("||").map((e=>N.fromName(e)));return new L(t,null,s,null)}evolveRule(e=null){var t,i=this.conditions.length;null==e&&(e=this.conditionLevels),0==(t=2==i?Math.floor(2*Math.random())+1:10==i?Math.floor(2*Math.random()):Math.floor(3*Math.random()))?this.removeCondition():1==t?this.changeCondition(e):this.addCondition(e)}addCondition(e){var t=this.conditions.slice();t.push(N.randomSample(this.nStatesPrimary,this.nStates,this.conditionLevels,this.neighbourhoodGeometryType,this.periodicityLength)),console.log((new Date).toLocaleTimeString()+" Adding condition "+this.neighbourhoodGeometryType+": "+t.map((e=>e.name())).join("||")),this.conditions=t}removeCondition(){var e=this.conditions.slice(),t=Math.floor(Math.random()*e.length);e.splice(t,1)[0],console.log((new Date).toLocaleTimeString()+" Removing condition: "+e.map((e=>e.name())).join("||")),this.conditions=e}changeCondition(e){var t=this.conditions.slice(),i=Math.floor(Math.random()*t.length);t[i]=N.randomSample(this.nStatesPrimary,this.nStates,e,this.neighbourhoodGeometryType,this.periodicityLength),console.log((new Date).toLocaleTimeString()+" Changing condition "+i+" to "+this.neighbourhoodGeometryType+": "+t.map((e=>e.name())).join("||")),this.conditions=t}}function A({none:e=1,p2h:t=1,p2v:i=1,d2a:n=1,d2b:r=1,g2:a=1,p4:o=1,d4:s=1,g4:l=1,r8:h=1}={}){return{Random:{prob:e,mask:null},"Random p2h":{prob:t,mask:null},"Random p2v":{prob:i,mask:null},"Random d2a":{prob:n,mask:null},"Random d2b":{prob:r,mask:null},"Random g2":{prob:a,mask:null},"Random p4":{prob:o,mask:null},"Random d4":{prob:s,mask:null},"Random g4":{prob:l,mask:null},"Random r8":{prob:h,mask:null}}}function F({diamondWave:e=.001,glider:t=.001,oscillatorI:i=.001,oscillatorII:r=.001,shortLivedStar:a=.001,snake:o=.001,spaceship:s=.001,squareWave:l=.001,star:h=.001}){return{Glider:{prob:t,mask:n.fromArray([[0,0,1,2],[0,2,0,0],[1,2,1,0]])},"Diamond wave":{prob:e,mask:n.fromArray([[0,0],[1,1]])},"Oscillator I":{prob:i,mask:n.fromArray([[0,0,1,0],[1,2,2,0],[0,2,2,1],[0,1,0,0]])},"Oscillator II":{prob:r,mask:n.fromArray([[0,0,2,0,0,0,0],[0,1,1,0,0,1,0],[0,0,2,1,2,1,2],[0,0,1,0,1,0,0],[2,1,2,1,2,0,0],[0,1,0,0,1,1,0],[0,0,0,0,2,0,0]])},"Short-lived star":{prob:a,mask:n.fromArray([[1,0],[0,1]])},Snake:{prob:o,mask:n.fromArray([[0,1,2,1,2,1,0],[1,2,0,1,0,2,1],[1,2,0,1,0,2,1],[0,1,2,1,2,1,0]])},Spaceship:{prob:s,mask:n.fromArray([[1,1],[2,0],[0,2]])},"Square wave":{prob:l,mask:n.fromArray([[1,1],[2,2]])},Star:{prob:h,mask:n.fromArray([[1,0,1],[0,0,0],[1,0,1]])}}}const G={Default:{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:A()},"Brian's brain default":{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...A(),...F({glider:1,oscillatorI:2,oscillatorII:2,star:4,snake:4,squareWave:4})}},"Brian's brain gliders":{randomnessLogShift:1,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...A(),...F({glider:120})}},"Brian's brain snakes":{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...A(),...F({snake:100})}},"Brian's brain stars":{randomnessLogShift:1,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...A(),...F({oscillatorI:20,oscillatorII:20,star:40,shortLivedStar:20})}},"Brian's brain waves":{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...A(),...F({spaceship:3,squareWave:8})}},"Brian's brain diamond waves":{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...A(),...F({diamondWave:20})}}};var W=2e4;const H={Test:{name:"Test",rules:{"SGen{50|75|100}/N0/B{12|13|14|1}[5678]/S{12|13|14|23|24|34|1|2|3|4}[5678]/I[12345678]/{6|7|8|9|10}":1},randomnessConfig:G["Brian's brain diamond waves"],timeBetweenRuleChanges:W},TestRuleGroup:{name:"TestRuleGroup",ruleGroup:{"Brian's brain":1,"Brian's brain (modified)":1,"Brian's brain diamond waves":1,"Brian's brain family":1,"Brian's brain gliders":1,"Brian's brain S0 family":1,"Brian's brain snakes":1,"Brian's brain stars":1,"Brian's brain waves":1,"Burst family":1,"Caterpillars family":1,"Conway's game of life":1,Crawlers:1}},Custom:{name:"Custom",rules:{}},"Asteroid fields family":{name:"Asteroid fields family",rules:{"N0/B2[5678]/S0[5678]/I[2345678]/4":1},timeBetweenRuleChanges:W},"Bloomerang family":{name:"Bloomerang family",rules:{"N0/B34[5678]/S234[678]/I[12345678]/{9|10|11|12|13|14|24}":1},timeBetweenRuleChanges:W},"Bombers family":{name:"Bombers family",rules:{"N0/B24[5678]/S345[678]/I[12345678]/{11|12|13|14}":1},timeBetweenRuleChanges:W},"Brian's brain":{name:"Brian's brain",rules:{"N0/B2/S/I/3":1},randomnessConfig:G["Brian's brain default"],timeBetweenRuleChanges:W},"Brian's brain (modified)":{name:"Brian's brain (modified)",rules:{"N0/B2/S/I345678/3":1},randomnessConfig:G["Brian's brain default"],timeBetweenRuleChanges:W},"Brian's brain diamond waves":{name:"Brian's brain diamond waves",rules:{"N0/B2[45678]/S[45678]/I34[5678]/{3|4}":1},randomnessConfig:G["Brian's brain diamond waves"],timeBetweenRuleChanges:W},"Brian's brain family":{name:"Brian's brain family",rules:{"N0/B2[45678]/S[45678]/I[345678]/{3|4}":1},randomnessConfig:G["Brian's brain default"],timeBetweenRuleChanges:W},"Brian's brain gliders":{name:"Brian's brain gliders",rules:{"N0/B2[45678]/S[45678]/I34[5678]/3":1},randomnessConfig:G["Brian's brain gliders"],timeBetweenRuleChanges:W},"Brian's brain S0 family":{name:"Brian's brain S0 family",rules:{"N0/B2[45678]/S0[45678]/I[345678]/{4|5}":1},randomnessConfig:G["Brian's brain default"],timeBetweenRuleChanges:W},"Brian's brain snakes":{name:"Brian's brain snakes",rules:{"N0/B2[45678]/S[45678]/I34[5678]/{3|4}":1},randomnessConfig:G["Brian's brain snakes"],timeBetweenRuleChanges:W},"Brian's brain stars":{name:"Brian's brain stars",rules:{"N0/B2/S/I345678/3":1},randomnessConfig:G["Brian's brain stars"],timeBetweenRuleChanges:W},"Brian's brain waves":{name:"Brian's brain waves",rules:{"N0/B2[45678]/S[45678]/I34[5678]/{3|4}":1},randomnessConfig:G["Brian's brain waves"],timeBetweenRuleChanges:W},"Burst family":{name:"Burst family",rules:{"N0/B34[568]/S0235[678]/I[345678]/5":1,"N0/B34[568]/S235[678]/I[345678]/5":1},timeBetweenRuleChanges:W},"Caterpillars family":{name:"Caterpillars family",rules:{"N0/B378/S124567/I1345678/3":5},timeBetweenRuleChanges:W},"Conway's game of life":{name:"Conway's game of life",rules:{"N0/B3/S23/I/2":1},timeBetweenRuleChanges:W},Crawlers:{name:"Crawlers",rules:{"N11:1|0:0|0:0/B2/S1/I1/6":1},timeBetweenRuleChanges:W},"Flaming ships":{name:"Flaming ships",rules:{"B24/S34/I15678/4":1},timeBetweenRuleChanges:W},"Flaming ships family":{name:"Flaming ships family",rules:{"N0/B24[678]/S34[678]/I[12345678]/{3|4|5|6|7|8|9|10|11|12|13|14}":1},timeBetweenRuleChanges:W},"Leggy ships family":{name:"Leggy ships family",rules:{"N0/B23[5678]/S14[5678]/I1[2345678]/{5|6|7|8|9|10}":1},timeBetweenRuleChanges:W},"Life-like family":{name:"Life-like family",rules:{"N0/B34[5678]/S235[678]/I[45678]/5":1},timeBetweenRuleChanges:W},"Slow growth":{name:"Slow growth",rules:{"N0/B34[5678]/S234[678]/I2[45678]/{10|11|12|13|14|15|16|17|18|19|20}":1},timeBetweenRuleChanges:W},"Star wars":{name:"Star wars",rules:{"N0/B2/S345/I/4":1},timeBetweenRuleChanges:W},"Star wars family":{name:"Star wars family",rules:{"N0/B2[5678]/S345[78]/I[12345678]/{3|4}":6,"N0/B2[5678]/S345[678]/I[12345678]/{5|6|7|8|9|10}":1},timeBetweenRuleChanges:W},"Star wars S0 family":{name:"Star wars S0 family",rules:{"N0/B2[5678]/S0345[678]/I[12345678]/{7|8}":8},timeBetweenRuleChanges:W},"Star cruiser family":{name:"Star cruiser family",rules:{"N0/B245[678]/S34[678]/I[12345678]/{5|6|7|8}":15},timeBetweenRuleChanges:W},"Straight ships":{name:"Straight ships",rules:{"B2/S245678/I1/4":1},timeBetweenRuleChanges:W},"Straight ships family":{name:"Straight ships family",rules:{"N0/B2[5678]/S2[45678]/I1[345678]/{3|4|5|6|7|8}":1},timeBetweenRuleChanges:W},"Straight ships S0 family":{name:"Straight ships S0 family",rules:{"N0/B2[5678]/S02[45678]/I1[345678]/5":1},timeBetweenRuleChanges:W},"Trains family":{name:"Trains family",rules:{"N1:0|1:0|0:0/B14/S[34]/I1[345678]/{12|13|14|15|16|17|18|19|20}":1},timeBetweenRuleChanges:W},"Wiggly ships":{name:"Wiggly ships",rules:{"N0/B24568/S34678/I34678/7":1},timeBetweenRuleChanges:W},"Wiggly ships family":{name:"Wiggly ships family",rules:{"N0/B24568/S34678/I3[45678]/{4|5|6|7|8|9|10|11}":1},timeBetweenRuleChanges:W},"Safe mixed generations":{name:"Safe mixed generations",rules:{"N0/B2/S/I345678/3":20,"N0/B2/S/I/3":4,"N0/B2/S345/I/4":5,"B2/S245678/I1/4":5,"B24/S34/I15678/4":5,"N0/B3/S23/I/2":8,"N0/B2[45678]/S[45678]/I[345678]/{3|4}":12,"N0/B2[5678]/S345[78]/I[12345678]/{3|4}":6,"N0/B27/S345/I12357/5":4,"N0/B2[5678]/S2[45678]/I1[345678]/{3|4|5|6|7|8}":12,"N0/B24[678]/S34[678]/I[12345678]/{3|4|5|6|7|8|9|10|11|12|13|14}":15,"N0/B34[5678]/S235[678]/I[45678]/5":15,"N0/B24568/S34678/I34678/7":5,"N0/B24568/S34678/I3[45678]/{4|5|6|7|8|9|10|11}":15,"N0/B245[678]/S34[678]/I[12345678]/{5|6|7|8}":15},timeBetweenRuleChanges:W},"Mixed generations":{name:"Mixed generations",rules:{"N0/B2/S/I345678/3":20,"N0/B2/S/I/3":4,"N0/B2/S345/I/4":5,"B2/S245678/I1/4":5,"B24/S34/I15678/4":5,"N0/B3/S23/I/2":8,"N0/B2[45678]/S[45678]/I[345678]/{3|4}":12,"N0/B2[5678]/S345[678]/I[12345678]/{5|6|7|8|9|10}":9,"N0/B2[5678]/S345[78]/I[12345678]/{3|4}":6,"N0/B2[5678]/S2[45678]/I1[345678]/{3|4|5|6|7|8}":12,"N0/B24[678]/S34[678]/I[12345678]/{3|4|5|6|7|8|9|10|11|12|13|14}":15,"N0/B34[5678]/S235[678]/I[45678]/5":15,"N0/B23[5678]/S14[5678]/I1[2345678]/{5|6|7|8|9|10}":10,"N0/B34[5678]/S234[678]/I2[45678]/{10|11|12|13|14|15|16|17|18|19|20}":12,"N0/B34[5678]/S234[678]/I[12345678]/{9|10|11|12|13|14|24}":12,"N0/B24[5678]/S345[678]/I[12345678]/{11|12|13|14}":8,"N0/B34[568]/S0235[678]/I[345678]/5":8,"N0/B34[568]/S235[678]/I[345678]/5":8,"N0/B378/S124567/I1345678/3":5,"N0/B2[5678]/S0[5678]/I[2345678]/4":8,"N0/B2[5678]/S02[45678]/I1[345678]/5":8,"N0/B2[45678]/S0[45678]/I[345678]/{4|5}":8,"N0/B2[5678]/S0345[678]/I[12345678]/{7|8}":8,"N0/B27/S345/I12357/5":2,"N0/B245[678]/S34[678]/I[12345678]/{5|6|7|8}":15,"N{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1}|0:{0|1}|0:0/B2[45678]/S2[45678]/I1[345678]/{9|10|11|12|13|14}":6,"N0/B23/S34[678]/I1[2345678]/{6|7|8|9|10|11|12|13}":3,"N0/B234[5678]/S2[45678]/I1[5678]/{6|7|8|9|10|11|12|13|14}":12,"N0/B234[5678]/S3[45678]/I1[5678]/{6|7|8|9|10|11|12|13|14}":8,"N0/B234[5678]/S[45678]/I1[5678]/{6|7|8|9|10|11|12|13|14}":8,"N0/B234578/S37/I/11":1,"N0/B23[45678]/S3[5678]/I[45678]/{5|6|7|8|9|10|11|12}":8,"N0/B2368/S358/I/5":1,"N0/B24[5678]/S3[45678]/I[5678]/{5|6|7|8|9|10|11|12|13|14}":5,"N0/B24568/S3478/I34578/5":1,"N0/B24568/S3478/I34578/6":1,"N0/B24568/S3478/I34578/7":3,"N0/B24568/S34578/I34578/9":1,"N0/B24568/S34578/I34578/12":1,"N0/B24568/S34578/I34578/13":1,"N0/B24568/S34578/I34578/14":1,"N0/B24568/S34678/I34678/7":5,"N0/B24568/S34678/I3[45678]/{4|5|6|7|8|9|10|11}":15,"N0/B245[678]/S346[78]/I123[45678]/{4|5|6|7|8|9|10|11}":8,"N0/B25[678]/S3[45678]/I[5678]/{5|6|7|8|9|10|11|12|13|14}":12,"N0/B25/S345/I/4":1,"N0/B25/S345/I/5":1,"N0:0/B2[5678]/S34567/I1[345678]/{5|6|7|8|9|10|11|12|13|14}":5,"N0/B2[5678]/S34[5678]/I[5678]/{5|6}":15,"N0/B25678/S2478/I345678/12":1,"N0/B2568/S345678/I345678/8":1,"N0/B2568/S345678/I345678/10":1,"N0/B2568/S345678/I345678/12":1,"N0/B2568/S34578/I34578/4":1,"N0/B2568/S34578/I34578/5":1,"N0/B2568/S34578/I34578/6":1,"N0/B2568/S34578/I34578/7":1,"N0/B2568/S34578/I34578/8":1,"N{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1}|0:0|0:0/B2[45678]/S1[345678]/I1[2345678]/{5|6|7|8|9|10|11|12|13|14|15}":15,"N{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1}|0:0|0:0/B23[45678]/S1[345678]/I1[2345678]/{5|6|7|8|9|10|11|12|13|14|15}":6,"N1/B2[45678]/S3[45678]/I[12345678]/{5|6|7|8|9|10|11|12|13|14}":3,"N1/B23[45678]/S1[2345678]/I[12345678]/{5|6|7|8|9|10|11|12|13|14}":3,"N5|1|18/B2[345678]/S1[345678]/I[345678]/{7|7|7|8|8|8|11|12|13|14|15}":8,"N11:1|0:0|0:0/B245/S1/I12357/6":3,"SGen/N0/B2[345678]/S[2345678]/I[12345678]/{3|4|5|6|7|8|9|10|11|12|13|14}":20,"SGen/N0/B[12345678]/S[012345678]/I[12345678]/{3|4|5|6|7|8|9|10|11|12|13|14}":10,"SGen{50|75|100}/N0/B{12|13|14|1}[5678]/S{12|13|14|23|24|34|1|2|3|4}[5678]/I[12345678]/{6|7|8|9|10}":20,"N0/B1[2345678]/S[12345678]/I[12345678]/{25|50|75|100}":12,"N0/B1/S[5678]/I[2345678]/{25|50|75|100}":12,"N{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/B1[2345678]/S[12345678]/I[12345678]/{25|50|75|100}":20,"N45|0|33/B2/S/I34/7":1,"N58|0|16/B24568/S/I1/{5|6|7|8}":3,"N66|0|67/B2/S23/I23/6":3,"N66|0|0/B2/S1/I1/6":2,"N67|0|0/B2/S1/I1/6":2},timeBetweenRuleChanges:W}};class D{colorUnit;ruleChain;updateRule;setRuleChain(){throw new Error("Must override method")}setUpdateRule(){this.updateRule=function(e,t,i,n,r){t=this.ruleChain[0].updateRule(e%this.ruleChain[0].nStates,t,i,n,r);var a=this.ruleChain[0].nStates;for(let r=1;r<this.ruleChain.length;r++)t+=a*this.ruleChain[r].updateRule(Math.floor(e/a)%this.ruleChain[r].nStates,t,i,n),t%=a*=this.ruleChain[r].nStates;return t%a}}setBaseRule(){throw new Error("Must override method")}setStyleRule(){throw new Error("Must override method")}getName(){return this.ruleChain.map((e=>e.getName())).join("-")}}class T extends D{constructor(e){super(),this.ruleConfig=e.config.ruleConfig,this.styleConfig=e.config.styleConfig,this.randomnessConfig=e.config.randomnessConfig,this.currentGenerationsRule=null,this.setRuleChain(e),this.setUpdateRule()}setRuleChain(e){this.ruleChain=[null],this.setBaseRule(e),this.setStyleRule(e)}setBaseRule(e){if(this.ruleConfig=e.config.ruleConfig,"ruleGroup"in this.ruleConfig){var t=r(this.ruleConfig.ruleGroup)();this.ruleConfig.sampledRule=t,this.ruleConfig.rules=H[t].rules,this.ruleConfig.randomnessConfig=H[t].randomnessConfig,this.ruleConfig.timeBetweenRuleChanges=H[t].timeBetweenRuleChanges,console.log("Sampled rule: "+t)}else this.ruleConfig=e.config.ruleConfig;let i=r(this.ruleConfig.rules)();var n=k;if("SGen"==i.substring(0,4)&&(n=E),["Random","andom"].includes(i))i=null;else for(;i.split("/").length<5;)if("N"!=i[0])i="N0/"+i;else{i=i+"/"+(Math.floor(10*Math.random())+3)}this.ruleChain[0]=new n(e,i),this.colorUnit=this.ruleChain[0].nStates}setStyleRule(e){if(this.styleConfig=e.config.styleConfig,0===Object.keys(this.styleConfig).length||"No style"==this.styleConfig.name)return this.colorUnit=1,void(this.ruleChain=this.ruleChain.slice(0,1));for(;this.ruleChain.length>1;)this.ruleChain.pop();if(this.styleConfig.style)return this.ruleChain.push(L.ruleFromNames(this.styleConfig.style)),void(this.colorUnit=this.ruleChain[0].nStates);var t=this.styleConfig.conditionLevels,i=r(t.reduce(((e,t,i)=>(e[i]=t.weight,e)),{}))();this.styleConfig.chosenConditionLevels=t[i].probabilities;var n=this.ruleChain[0].nStates;this.ruleChain.push(L.sampleRule(this.styleConfig,n)),this.colorUnit=this.ruleChain[0].nStates}updateGlobalDataWithConfig(e){}}class U{constructor({r:e=0,g:t=0,b:i=0,t:n=255,drift:r=0,redPerturbationStrength:a=0,greenPerturbationStrength:o=0,bluePerturbationStrength:s=0,brightnessPerturbationStrength:l=0}={}){this.r=e,this.g=t,this.b=i,this.t=n,this.drift=r,this.redPerturbationStrength=a,this.greenPerturbationStrength=o,this.bluePerturbationStrength=s,this.brightnessPerturbationStrength=l,this.updateDoubles()}updateDoubles(){this.redPertStrength2=2*this.redPerturbationStrength,this.greenPertStrength2=2*this.greenPerturbationStrength,this.bluePertStrength2=2*this.bluePerturbationStrength,this.brightnessPertStrength2=2*this.brightnessPerturbationStrength}}function O(e){let t=e;for(let i of["r","g","b"]){let n=Math.round(2*Math.random()*e.drift-e.drift),r=e[i]+n;r=Math.max(0,Math.min(255,r)),t[i]=r}return t}function j(){return 10**(1.5*Math.random()-.5)}function z(){return Math.floor(256*Math.random())}function Y(){return 21*Math.random()}function q(){return new U({r:z(),g:z(),b:z(),t:255,drift:j(),redPerturbationStrength:Y(),greenPerturbationStrength:Y(),bluePerturbationStrength:Y(),brightnessPerturbationStrength:Y()})}const V={blue:new U({r:13,g:112,b:255}),grey:new U({r:240,g:239,b:239}),black:new U({r:0,g:0,b:0}),yellow:new U({r:247,g:255,b:28}),white:new U({r:255,g:255,b:255}),whitish:new U({r:240,g:240,b:240}),redBlue1:new U({r:221,g:12,b:12}),redBlue2:new U({r:29,g:29,b:189}),turquoiseRed1:new U({r:39,g:192,b:177}),turquoiseRed2:new U({r:252,g:53,b:47}),magentaCyan1:new U({r:156,g:36,b:150}),magentaCyan2:new U({r:114,g:223,b:174}),transparent:new U({r:0,g:0,b:0,t:0}),darkGrey:new U({r:75,g:75,b:75}),mediumGrey:new U({r:175,g:175,b:175}),basicRed:new U({r:255,g:0,b:0}),basicGreen:new U({r:0,g:255,b:0}),basicBlue:new U({r:0,g:0,b:255}),basicYellow:new U({r:255,g:255,b:0}),basicMajenta:new U({r:255,g:0,b:255}),basicCyan:new U({r:0,g:255,b:255}),cgaBlack:new U({r:0,g:0,b:0}),cgaDarkGrey:new U({r:85,g:85,b:85}),cgaBlue:new U({r:0,g:0,b:170}),cgaLightBlue:new U({r:85,g:85,b:255}),cgaGreen:new U({r:0,g:170,b:0}),cgaLightGreen:new U({r:85,g:255,b:85}),cgaCyan:new U({r:0,g:170,b:170}),cgaLightCyan:new U({r:85,g:255,b:255}),cgaRed:new U({r:170,g:0,b:0}),cgaLightRed:new U({r:255,g:85,b:85}),cgaMajenta:new U({r:170,g:0,b:170}),cgaLightMajenta:new U({r:255,g:85,b:255}),cgaBrown:new U({r:170,g:85,b:0}),cgaYellow:new U({r:255,g:255,b:85}),cgaGrey:new U({r:170,g:170,b:170}),cgaWhite:new U({r:255,g:255,b:255})},X=[V.basicRed,V.basicGreen,V.basicBlue,V.basicYellow,V.basicMajenta,V.basicCyan],$=[V.cgaBlack,V.cgaDarkGrey,V.cgaBlue,V.cgaLightBlue,V.cgaGreen,V.cgaLightGreen,V.cgaCyan,V.cgaLightCyan,V.cgaRed,V.cgaLightRed,V.cgaMajenta,V.cgaLightMajenta,V.cgaBrown,V.cgaYellow,V.cgaGrey,V.cgaWhite];var K=()=>X[Math.floor(Math.random()*X.length)],_=()=>$[Math.floor(Math.random()*$.length)];function J(e){return"Basic"===e?K:"CGA"===e?_:q}function Z(e){e.colors=e.config.colorConfig.colorPattern.map((e=>"Random"===e?q():"Basic"===e?K():"CGA"===e?_():V[e]));var t=J(e.config.colorConfig.extraColorSampler);if(null!==e.config.colorConfig.minNColors&&e.colors.length<e.config.colorConfig.maxNColors){for(let i=e.colors.length;i<e.config.colorConfig.minNColors;i++)e.colors.push(t());if(null!==e.config.colorConfig.maxNColors&&e.config.colorConfig.maxNColors>e.config.colorConfig.minNColors){var i=Math.floor(Math.random()*(e.config.colorConfig.maxNColors-e.config.colorConfig.minNColors))+1;for(let n=0;n<i;n++)e.colors.push(t())}}e.nColors=e.colors.length,e.colorCount=new Array(e.nColors).fill(0)}function Q(e){if("VariableGR"!=e.metaRule)for(var t of e.colors)0!=t.redPerturbationStrength&&(t.redPerturbationStrength=Y()),0!=t.greenPerturbationStrength&&(t.greenPerturbationStrength=Y()),0!=t.bluePerturbationStrength&&(t.bluePerturbationStrength=Y()),0!=t.brightnessPerturbationStrength&&(t.brightnessPerturbationStrength=Y()),t.updateDoubles()}function ee(e){for(var t of e.colors)0!=t.drift&&(t.drift=j())}const te=2e3;function ie(e,t,i){return{probabilities:{0:e,1:t},weight:i}}const ne={Mixed:[ie(1,0,3),ie(.8,.2,3),ie(.5,.5,2),ie(0,1,2)],Static:[ie(1,0,1)],"Almost static":[ie(.8,.2,1)],Dynamic:[ie(.5,.5,1)],"Fully dynamic":[ie(0,1,1)]};function re(e,t=2){return 1==t?Array(e).fill("{E|B}{1|2|3|4}{A|N|C}[0|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1|2|3|4|5}]").join("||"):2==t?Array(e).fill("{E|B}{2|3|4}{A|N|C}[0|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1|2|3|4|5}]").join("||"):3==t?Array(e).fill("{E|B}{3|4}{A|N|C}[0|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1|2|3|4|5}]").join("||"):void 0}const ae={Test:{name:"Test",nConditions:null,conditionLevels:ne.Static,conditionLevelsName:"Static",neighbourhoodGeometryType:null,periodicityLength:1,timeBetweenStyleChanges:te},TestFixedStyle:{name:"TestFixStyle",style:"E2C[1|0:0]1||E8N[1|0:0]1"},Mixed:{name:"Mixed",nConditions:null,conditionLevels:ne.Mixed,conditionLevelsName:"Mixed",neighbourhoodGeometryType:null,periodicityLength:1,timeBetweenStyleChanges:te},"Mixed static":{name:"Mixed static",nConditions:null,conditionLevels:ne.Static,conditionLevelsName:"Static",neighbourhoodGeometryType:null,periodicityLength:null,timeBetweenStyleChanges:te},"Mixed almost static":{name:"Mixed almost static",nConditions:null,conditionLevels:ne["Almost static"],conditionLevelsName:"Almost static",neighbourhoodGeometryType:null,periodicityLength:1,timeBetweenStyleChanges:te},"Mixed dynamic":{name:"Mixed dynamic",nConditions:null,conditionLevels:ne.Dynamic,conditionLevelsName:"Dynamic",neighbourhoodGeometryType:null,periodicityLength:1,timeBetweenStyleChanges:te},"Mixed fully dynamic":{name:"Mixed fully dynamic",nConditions:null,conditionLevels:ne["Fully dynamic"],conditionLevelsName:"Fully dynamic",neighbourhoodGeometryType:null,periodicityLength:1,timeBetweenStyleChanges:te},"Mixed with periodicity":{name:"Mixed with periodicity",nConditions:null,conditionLevels:ne.Mixed,conditionLevelsName:"Mixed",neighbourhoodGeometryType:null,periodicityLength:null,timeBetweenStyleChanges:te},"Mixed safe":{name:"Mixed safe",nConditions:null,conditionLevels:ne.Static,conditionLevelsName:"Static",neighbourhoodGeometryType:null,periodicityLength:1,timeBetweenStyleChanges:te},Custom:{name:"Custom",style:null},"No style":{name:"No style"},"*Ancient Greece I":{name:"*Ancient Greece I",style:"E1C[0|2:1]||"+re(3),timeBetweenStyleChanges:te},"*Bars I":{name:"*Bars I",style:"B1N[0|4:0]||"+re(5),timeBetweenStyleChanges:te},"Blinking stained glass I":{name:"Blinking stained glass I",style:"E2C[1|0:0]1||E8N[1|0:0]"},"Blobs I":{name:"Blobs I",style:"E3C[1|0:9]"},"Brutalist I":{name:"Brutalist I",style:"E4C[1|0:4|0:8]1||E3C[1|0:9]"},"*Checkerboard I":{name:"*Checkerboard I",style:"E4A3[1|0:4|0:7]||"+re(5),timeBetweenStyleChanges:te},"Checkerboard II":{name:"Checkerboard II",style:"E3A6[0|11:0|13:1]||E3N[0|13:0]||B2N[0|11:2]||E5N[0|11:2]||E2C[0|13:1|11:0]||E4A6[0|13:2|13:0]",timeBetweenStyleChanges:te},"Comics I":{name:"Comics I",style:"B3C[0|2:2|2:0]||B3N[0|2:1]||B0A3[0|2:0]||E3C[0|2:0]||B1N[0|2:0|2:2]||E4C[0|2:0]||E1A3[0|2:0|2:1]",timeBetweenStyleChanges:te},"*Diagonal I":{name:"*Diagonal I",style:"E4A2[0|4:2|3:0]||"+re(5),timeBetweenStyleChanges:te},"Diamonds I":{name:"Diamonds I",style:"E4C[1|0:4|0:8]"},"Diamonds II":{name:"Diamonds II",style:"E4C[1|0:5|0:7]"},"*Dots I":{name:"*Dots I",style:"B1C[0|9:0]||"+re(5),timeBetweenStyleChanges:te},"*Glyph I":{name:"*Glyph I",style:"B1N[0|4:2|3:0]||"+re(5),timeBetweenStyleChanges:te},"*Glyph II":{name:"*Glyph II",style:"E3C[0|7:2|3:1]||"+re(5),timeBetweenStyleChanges:te},"Growing checkerboards II":{name:"Growing checkerboards II",style:"B3C[0|2:1]1||B1C[0|0:0]1||B5C[0|0:0]1||E2C[1|0:0]1||E4C[1|1:2|0:7]1||E8N[1|0:0]"},"Growing checkerboards I":{name:"Growing checkerboards I",style:"B1C[0|0:0]1||B5C[0|0:0]1||E2C[1|0:0]1||E4C[1|1:2|0:7]1||E8N[1|0:0]"},"Jiggly squares I":{name:"Jiggly squares I",style:"B1A6[1|13:3]||B4N[1|11:2|11:5]||B0A3[0|13:2]||B3C[0|13:1]||B4C[1|11:3|13:1]"},"*Lines I":{name:"*Lines I",condition:"B0A2[0|0:0|0:2]||"+re(5),timeBetweenStyleChanges:te},"Loose labyrinth I":{name:"Loose labyrinth I",style:"E3C[1|0:9]||E4C[1|0:4|0:8]"},"Loose labyrinth II":{name:"Loose labyrinth II",style:"E3C[1|0:9]||E3C[0|0:0]"},"Matrix I":{name:"Matrix I",style:"E3C[1|0:9]||E5A2[1|0:7]1||E7A5[1|0:7]1||B6C[1|0:6]1||E4C[1|0:4|0:8]1||E4N[1|0:8|0:0]1||E4A3[1|0:4|0:7]||B1A4[1|0:7|0:6]1||E1C[1|0:7|0:4]1"},"Morse I":{name:"Morse I",style:"E4A3[1|0:4|0:7]"},"*Morse II":{name:"*Morse II",style:"B0A3[0|7:1|4:0]||"+re(3,1),timeBetweenStyleChanges:te},"*Morse III":{name:"*Morse I",style:"B0A3[0|4:0]||"+re(3,1),timeBetweenStyleChanges:te},"*Ragged I":{name:"*Ragged I",style:"E1C[0|0:1|0:2]||B2A3[0|0:1|0:2]"+re(5),timeBetweenStyleChanges:te},"*Silouhette I":{name:"*Silouhette I",style:"E1C[0|0:0|0:1]||"+re(5),timeBetweenStyleChanges:te},"Sparse blinkers I":{name:"Sparse blinkers I",style:"B4N[1|0:6|0:2]"},"*Stripes I":{name:"*Stripes I",style:"E1A4[0|3:0]||"+re(5,1),timeBetweenStyleChanges:te}},oe={"Black-white-random":{name:"Black-white-random",colorPattern:["black","white"],extraColorSampler:"Random",minNColors:2,maxNColors:7},Random:{name:"Random",colorPattern:[],extraColorSampler:"Random",minNColors:2,maxNColors:7},Basic:{name:"Basic",colorPattern:["black","white"],extraColorSampler:"Basic",minNColors:3,maxNColors:5},Monochrome:{name:"Monochrome",colorPattern:["black","white","darkGrey","mediumGrey"],extraColorSampler:null,minNColors:null,maxNColors:null},"Black and white":{name:"Black and white",colorPattern:["black","white"],minNColors:null,maxNColors:null},GR:{name:"GR",colorPattern:["black","blue","grey","yellow"],minNColors:null,maxNColors:null},"CGA-4-0":{name:"CGA-4-0",colorPattern:["cgaBlack","cgaLightGreen","cgaLightRed","cgaYellow"],minNColors:null,maxNColors:null},"CGA-4-1":{name:"CGA-4-1",colorPattern:["cgaBlack","cgaWhite","cgaLightCyan","cgaLightMajenta"],minNColors:null,maxNColors:null},"CGA-16":{name:"CGA-16",colorPattern:[],extraColorSampler:"CGA",minNColors:4,maxNColors:8},GRMouse:{name:"GRMouse",colorPattern:["transparent","blue","black","yellow"],minNColors:null,maxNColors:null}},se={Mixed:{name:"Mixed",ruleConfig:H["Mixed generations"],styleConfig:ae.Mixed,colorConfig:oe["Black-white-random"],randomnessConfig:G.Default},"Mixed safe":{name:"Mixed safe",ruleConfig:H["Mixed generations"],styleConfig:ae["Mixed safe"],colorConfig:oe["Black-white-random"],randomnessConfig:G.Default},Safe:{name:"Safe",ruleConfig:H["Brian's brain (modified)"],styleConfig:ae["Mixed safe"],colorConfig:oe["Black-white-random"],randomnessConfig:G.Default},GR:{name:"GR",ruleConfig:H["Brian's brain (modified)"],styleConfig:ae["Mixed safe"],colorConfig:oe.GR,randomnessConfig:G.Default},GRMouse:{name:"GRMouse",ruleConfig:H["Brian's brain (modified)"],styleConfig:ae["Mixed safe"],colorConfig:oe.GRMouse,randomnessConfig:G.Default},"Test rule":{name:"Test rule",ruleConfig:H.Test,styleConfig:ae["Mixed static"],colorConfig:oe["Black-white-random"],randomnessConfig:G.Default},Custom:{name:"Custom",ruleConfig:H.Custom,styleConfig:ae.Custom,colorConfig:oe["Black-white-random"],randomnessConfig:G.Default}},le={Default:{name:"Default",gracePeriod:100,maxColorChange:330,maxFlickerIndex:10,maxPropOfCellsChanged:1,minNumberOfCellsChanged:3,maxPropOfPlainColor:.99,activityLevelWindowSize:50,flickerIndexWindowSize:100},Disabled:{name:"Disabled",gracePeriod:100,maxColorChange:1e4,maxFlickerIndex:1e3,maxPropOfCellsChanged:1,minNumberOfCellsChanged:0,maxPropOfPlainColor:1,activityLevelWindowSize:50,flickerIndexWindowSize:100}};function he(e,t=!1){if(Math.random()<Math.exp(e.ruleLogSwitchProbability)||t||e.changeRuleFlag){if(e.colorCount=new Array(e.nColors).fill(0),"VariableGR"==e.metaRule)e.nColors=4,e.config=se.GR,e.sanityConfig=le.Default,e.useLogo=!0;else if("VariableDemo"==e.metaRule)e.config=se["Mixed safe"],e.sanityConfig=le.Default,e.useLogo=!1;else if("Variable"==e.metaRule)e.config=se["Mixed safe"],e.sanityConfig=le.Default;else if("VariableMix"==e.metaRule)e.config=se.Mixed,e.sanityConfig=le.Default;else if("VariableUnsafe"==e.metaRule)e.config=se.Mixed,e.sanityConfig=le.Default;else if("VariableTest"==e.metaRule)e.config=se["Test rule"],e.sanityConfig=le.Disabled;else if("CustomRule"==e.metaRule){if(e.config=se.Custom,e.sanityConfig=le.Disabled,e.currentRuleAndStyle){var[i,n]=e.currentRuleAndStyle.split("-");e.config.ruleConfig.rules={[i]:1},n?e.config.styleConfig.style=n:e.config.styleConfig={}}}else"GRMouse"==e.metaRule?(e.config=se.GRMouse,e.sanityConfig=le.Default):(e.config=se["Default mixed"],e.sanityConfig=le.Default);e.resampleRuleClass(),e.ruleLogSwitchProbability=-25,e.styleLogEvolveProbability=-25,e.changeRuleFlag=!1,e.time=0,ge(e),Z(e)}e.changeBaseRuleFlag&&(e.ruleClass.setBaseRule(e),e.ruleLogSwitchProbability=-25,e.changeBaseRuleFlag=!1,e.time=0,ge(e),Q(e),ee(e)),e.changeStyleFlag&&(e.ruleClass.setStyleRule(e),e.styleLogEvolveProbability=-25,e.changeStyleFlag=!1,e.time=0,ge(e),Q(e),ee(e)),(Math.random()<Math.exp(e.styleLogEvolveProbability)||e.evolveColoringRuleFlag)&&"CustomRule"!=e.metaRule&&!e.config.styleConfig.style&&(de(e.ruleClass),e.useLogo&&null!==e.ruleClass2&&de(e.ruleClass2),e.styleLogEvolveProbability=-25,e.evolveColoringRuleFlag=!1,e.time=0,ge(e),Q(e),ee(e));e.ruleLogSwitchProbability=e.ruleLogSwitchProbability+1*e.logMultiplicativeFactor,e.ruleLogSwitchProbability>0&&(e.ruleLogSwitchProbability=0),e.styleLogEvolveProbability=e.styleLogEvolveProbability+1*e.logMultiplicativeEvolveFactor,e.styleLogEvolveProbability>0&&(e.styleLogEvolveProbability=0)}function ge(e){if("undefined"!=typeof document){var t=document.getElementById("currentRuleAndStyle");t&&(e.useLogo&&null!==e.ruleClass2?t.value=e.ruleClass.getName()+"__"+e.ruleClass2.getName():t.value=e.ruleClass.getName())}}function de(e){e.ruleChain[1]&&"function"==typeof e.ruleChain[1].evolveRule&&e.ruleChain[1].evolveRule(e.conditionLevels)}function ce(e,t,i,n,r){let a=(t+n+e.gridHeight)%e.gridHeight,o=(i+r+e.gridWidth)%e.gridWidth,s=a,l=o;return(a-t-n>0||a-t-n<0)&&(l=(e.gridWidth-o-e.gridPeriodicityShiftX+e.gridWidth)%e.gridWidth),(o-i-r>0||o-i-r<0)&&(s=(e.gridHeight-a-e.gridPeriodicityShiftY+e.gridHeight)%e.gridHeight),[s,l]}function ue(e,t,i,n,r){let a=(t+n+e.gridHeight)%e.gridHeight,o=(i+r+e.gridWidth)%e.gridWidth,s=a,l=o;return(a-t-n>0||a-t-n<0)&&(l=(e.gridWidth-o-e.gridPeriodicityShiftX+e.gridWidth)%e.gridWidth),o-i-r>0?s=(a+e.gridPeriodicityShiftY+e.gridHeight)%e.gridHeight:o-i-r<0&&(s=(a-e.gridPeriodicityShiftY+e.gridHeight)%e.gridHeight),[s,l]}function me(e,t,i,n,r){let a=(t+n+e.gridHeight)%e.gridHeight,o=(i+r+e.gridWidth)%e.gridWidth,s=a,l=o;return a-t-n>0?l=(o+e.gridPeriodicityShiftX+e.gridWidth)%e.gridWidth:a-t-n<0&&(l=(o-e.gridPeriodicityShiftX+e.gridWidth)%e.gridWidth),(o-i-r>0||o-i-r<0)&&(s=(e.gridHeight-a-e.gridPeriodicityShiftY+e.gridHeight)%e.gridHeight),[s,l]}function fe(e,t,i,n,r){let a=(t+n+e.gridHeight)%e.gridHeight,o=(i+r+e.gridWidth)%e.gridWidth,s=a,l=o;return a-t-n>0?l=(o+e.gridPeriodicityShiftX+e.gridWidth)%e.gridWidth:a-t-n<0&&(l=(o-e.gridPeriodicityShiftX+e.gridWidth)%e.gridWidth),o-i-r>0?s=(a+e.gridPeriodicityShiftY+e.gridHeight)%e.gridHeight:o-i-r<0&&(s=(a-e.gridPeriodicityShiftY+e.gridHeight)%e.gridHeight),[s,l]}function ye(e){e.gridFlipX&&e.gridFlipY?e.findNeighbour=ce:e.gridFlipX?e.findNeighbour=ue:e.gridFlipY?e.findNeighbour=me:e.findNeighbour=fe}function Ce(e){he(e,!0)}function be(e,t,i){return(e*(i-1)+t)/i}function Se(e,t=!1){(e.time%200==0||t)&&(isNaN(e.brightness)&&(e.brightness=127,e.maxBrightness=130,e.minBrightness=124),isNaN(e.maxBrightness)&&(e.maxBrightness=130),isNaN(e.minBrightness)&&(e.minBrightness=124),console.log("Activity level: "+e.activityLevel.toFixed(2)+"."),console.log("Proportion of cells changed: "+e.relCellChanged.toFixed(4)+"."),console.log("Mean color change magnitude: "+e.meanColorChangeHistoric.toFixed(1)+"."),console.log("Brightness: "+e.brightness.toFixed(1)+"."),console.log("Max - min brightness: "+e.diffBrightness+"."),console.log("Flicker index: "+e.flickerIndex.toFixed(2)+"."),console.log("Color count: "+e.colorCount.map((e=>e.toFixed(3)))+"."))}function Be(e){let t=e.imageData;for(var i=0,n=0,r=0,a=e.colors.length,o=new Array(a).fill(0),s=0;s<e.gridHeight;s++)for(var l=0;l<e.gridWidth;l++){var h=Math.floor(e.grid.get(s,l)/e.ruleClass.colorUnit)%a;if(o[h]+=1,0==e.redraw.get(s,l))continue;i+=1;let g=e.colors[h],d=4*(s*e.gridWidth+l);n+=Math.sqrt((t[d+0]-g.r)**2+(t[d+1]-g.g)**2+(t[d+2]-g.b)**2),r+=g.r+g.g+g.b;const c=Math.round(Math.random()*g.redPertStrength2-g.redPerturbationStrength),u=Math.round(Math.random()*g.greenPertStrength2-g.greenPerturbationStrength),m=Math.round(Math.random()*g.bluePertStrength2-g.bluePerturbationStrength),f=Math.round(Math.random()*g.brightnessPertStrength2-g.brightnessPerturbationStrength);t[d+0]=g.r+c+f,t[d+1]=g.g+u+f,t[d+2]=g.b+m+f,t[d+3]=g.t}!function(e,t,i,n,r){var a=e.gridHeight*e.gridWidth;e.activityLevel=be(e.activityLevel,t/a,e.sanityConfig.activityLevelWindowSize),e.nCellChangedHistoric=be(e.nCellChangedHistoric,t,e.sanityConfig.activityLevelWindowSize),e.meanColorChangeHistoric=be(e.meanColorChangeHistoric,i/(t+a/30),e.sanityConfig.activityLevelWindowSize),0==t?n=127:n/=3*t,e.brightness=be(e.brightness,n,e.sanityConfig.flickerIndexWindowSize);var o=(e.sanityConfig.flickerIndexWindowSize-1)/e.sanityConfig.flickerIndexWindowSize;e.maxBrightness=o*(e.maxBrightness-e.brightness)+e.brightness,e.minBrightness=o*(e.minBrightness-e.brightness)+e.brightness,e.relCellChanged=t/a,e.diffBrightness=e.maxBrightness-e.minBrightness,e.flickerIndex=be(e.flickerIndex,e.diffBrightness*e.relCellChanged,e.sanityConfig.flickerIndexWindowSize),e.maxBrightness<n?e.maxBrightness+=3:e.minBrightness>n&&(e.minBrightness-=3);for(var s=0;s<e.colorCount.length;s++)e.colorCount[s]=be(e.colorCount[s],r[s]/a,100)}(e,i,n,r,o),Se(e),e.imageData=t}function we(e,t,i){var n=function(e){var t=Math.exp(-e),i=1,n=0;do{n++,i*=Math.random()}while(i>t);return n-1}(10**(e.randomnessAmount+e.config.randomnessConfig.randomnessLogShift));if(0!=n)for(var r=e.config.randomnessConfig.seedSampler,a=e.config.randomnessConfig.seedMasks,o=0;o<n;o++){var s=Math.floor(Math.random()*e.gridHeight),l=Math.floor(Math.random()*e.gridWidth),h=r(),g=a[h],d=!0;null===g&&(g=ve(e,h),d=!1),pe(t,e,g,s,l,i,d)}}function pe(e,t,i,n,r,a,o){o&&(i=i.clone(),Math.random()<.25&&i.transpose(),Math.random()<.5&&i.flipX(),Math.random()<.75&&i.flipY());let s=i.height,l=i.width;for(let o=0;o<s;o++)for(let h=0;h<l;h++){let g=a(t,n,r,o-Math.floor(s/2),h-Math.floor(l/2));e.set(g[0],g[1],i.get(o,h))}}function ve(e,t){let[i,r]=function(e){let t=Math.floor(Math.random()*e.config.randomnessConfig.maxSeedSize)+1,i=t;Math.random()>e.config.randomnessConfig.squareVsRectangularMaskProbability&&(i=Math.floor(Math.random()*e.config.randomnessConfig.maxSeedSize)+1);return[t,i]}(e);return function(e,t,i){return"Random"==i?function(e,t){let i=new n(t,e);for(let n=0;n<e;n++)for(let e=0;e<t;e++)i.set(n,e,Math.floor(1e5*Math.random()));return i}(e,t):"Random p2h"==i?function(e,t){let i=new n(t,e);for(let n=0;n<Math.ceil(e/2);n++)for(let r=0;r<t;r++)i.set(n,r,Math.floor(1e5*Math.random())),i.set(e-1-n,r,i.get(n,r));return i}(e,t):"Random p2v"==i?function(e,t){let i=new n(t,e);for(let n=0;n<e;n++)for(let e=0;e<Math.ceil(t/2);e++)i.set(n,e,Math.floor(1e5*Math.random())),i.set(n,t-1-e,i.get(n,e));return i}(e,t):"Random d2a"==i?function(e){let t=new n(e,e);for(let i=0;i<e;i++)for(let n=i;n<e;n++)t.set(i,n,Math.floor(1e5*Math.random())),t.set(n,i,t.get(i,n));return t}(e):"Random d2b"==i?function(e){let t=new n(e,e);for(let i=0;i<e;i++)for(let n=i;n<e;n++)t.set(i,n,Math.floor(1e5*Math.random())),t.set(e-1-n,e-1-i,t.get(i,n));return t}(e):"Random g2"==i?function(e,t){let i=new n(t,e);for(let n=0;n<e;n++)for(let r=0;r<Math.ceil(t/2);r++)i.set(n,r,Math.floor(1e5*Math.random())),i.set(e-1-n,t-1-r,i.get(n,r));return i}(e,t):"Random p4"==i?function(e,t){let i=new n(t,e);for(let n=0;n<Math.ceil(e/2);n++)for(let r=0;r<Math.ceil(t/2);r++)i.set(n,r,Math.floor(1e5*Math.random())),i.set(e-1-n,r,i.get(n,r)),i.set(n,t-1-r,i.get(n,r)),i.set(e-1-n,t-1-r,i.get(n,r));return i}(e,t):"Random d4"==i?function(e){let t=new n(e,e);for(let i=0;i<e;i++)for(let n=Math.max(i,e-i);n<e;n++)t.set(i,n,Math.floor(1e5*Math.random())),t.set(n,i,t.get(i,n)),t.set(e-1-n,e-1-i,t.get(i,n)),t.set(e-1-i,e-1-n,t.get(i,n));return t}(e):"Random g4"==i?function(e){let t=new n(e,e);for(let i=0;i<Math.ceil(e/2);i++)for(let n=0;n<Math.ceil(e/2);n++)t.set(i,n,Math.floor(1e5*Math.random())),t.set(n,e-1-i,t.get(i,n)),t.set(e-1-i,e-1-n,t.get(i,n)),t.set(e-1-n,i,t.get(i,n));return t}(e):function(e){let t=new n(e,e);for(let i=0;i<Math.ceil(e/2);i++)for(let n=0;n<Math.ceil(e/2);n++)t.set(i,n,Math.floor(1e5*Math.random())),t.set(n,e-1-i,t.get(i,n)),t.set(e-1-i,e-1-n,t.get(i,n)),t.set(e-1-n,i,t.get(i,n)),t.set(e-1-i,n,t.get(i,n)),t.set(e-1-n,e-1-i,t.get(i,n)),t.set(i,e-1-n,t.get(i,n)),t.set(n,i,t.get(i,n));return t}(e)}(i,r,t)}function Me(e){!function(e){e.time>e.sanityConfig.gracePeriod&&(e.meanColorChangeHistoric>e.sanityConfig.maxColorChange||e.relCellChanged>e.sanityConfig.maxPropOfCellsChanged||e.flickerIndex>e.sanityConfig.maxFlickerIndex)&&(e.changeRuleFlag=!0,e.meanColorChangeHistoric>e.sanityConfig.maxColorChange?console.log("Changing rule because of suspected oscillations (meanColorChangeHistoric: "+e.meanColorChangeHistoric+")."):e.relCellChanged>e.sanityConfig.maxPropOfCellsChanged?console.log("Changing rule because of suspected oscillations (relCellChanged: "+e.relCellChanged+")."):console.log("Changing rule because of suspected oscillations (flickerIndex: "+e.flickerIndex+")."),Se(e,!0),e.nCellChangedHistoric=15,e.meanColorChangeHistoric=10,e.brightness=127,e.maxBrightness=130,e.minBrightness=124,e.flickerIndex=0)}(e),function(e){e.nCellChangedHistoric<e.sanityConfig.minNumberOfCellsChanged&&(e.changeRuleFlag=!0,console.log("Changing rule because not enough cells changed ("+e.nCellChangedHistoric+")."),Se(e,!0),e.nCellChangedHistoric=20)}(e),function(e){const t=e.colorCount.slice(1).some((t=>t>e.sanityConfig.maxPropOfPlainColor));e.time>e.sanityConfig.gracePeriod&&t&&(e.changeRuleFlag=!0,console.log("Changing rule because the canvas is too plainly colored."),Se(e,!0),e.colorCount=new Array(e.nColors).fill(0))}(e)}function Ie(e){return console.log("Loading image:",e),new Promise(((t,n)=>{const r=function(){if("undefined"!=typeof window)return new window.Image;try{const{Image:e}=i(Object(function(){var e=new Error("Cannot find module 'canvas'");throw e.code="MODULE_NOT_FOUND",e}()));return new e}catch(e){throw console.error('The canvas module is not installed. Please run "npm install canvas" to install it.'),e}}();r.onload=()=>{console.log("Image loaded:",e);const n=function(e,t){if("undefined"!=typeof window){const i=document.createElement("canvas");return i.width=e,i.height=t,i}try{const{createCanvas:n}=i(Object(function(){var e=new Error("Cannot find module 'canvas'");throw e.code="MODULE_NOT_FOUND",e}()));return n(e,t)}catch(e){throw console.error('The canvas module is not installed. Please run "npm install canvas" to install it.'),e}}(r.width,r.height),a=n.getContext("2d");a.drawImage(r,0,0,r.width,r.height);const o=a.getImageData(0,0,n.width,n.height).data,s=[];for(let e=0;e<r.height;e++){const t=[];for(let i=0;i<r.width;i++){const n=4*(e*r.width+i),a=(o[n]+o[n+1]+o[n+2])/3;t.push(a>128?1:0)}s.push(t)}t(s)},r.onerror=()=>{console.error("Error loading image:",e),n(new Error("Error loading image"))},r.src=e}))}async function Ne(e,t){if(null!==e.logo&&await function(e){return console.log("Attempting to load image"),Ie(e.logo).then((t=>{new n(e.gridWidth,e.gridHeight);const i=new n(e.gridWidth,e.gridHeight),r=t[0].length/e.gridWidth,a=t.length/e.gridHeight,o=Math.max(r,a),s=Math.floor((e.gridWidth-t[0].length/o)/2),l=Math.floor((e.gridHeight-t.length/o)/2);for(let n=0;n<e.gridHeight;n++)for(let r=0;r<e.gridWidth;r++){if(n<l||(n-l)*o>=t.length){i.set(n,r,1);continue}let e=Math.floor((r-s)*o);0===t[Math.floor((n-l)*o)][e]?i.set(n,r,0):i.set(n,r,1)}e.mask=i})).catch((t=>{console.log("Image loading failed, not using a mask."),console.error("Error loading image:",t),e.mask=new n(e.gridWidth,e.gridHeight)}))}(e),"zero"!=e.initialisation)return function(e,t=1e4){return Promise.resolve().then((()=>{e.grid=new n(e.gridWidth,e.gridHeight),e.redraw=new n(e.gridWidth,e.gridHeight);for(var i=0;i<e.gridHeight;i++)for(var r=0;r<e.gridWidth;r++)if("gr"!=e.initialisation||1!==e.mask.get(i,r)){for(var a=Math.random(),o=0;o<t;o++)if(a<(o+1)/(t+1)){e.grid.set(i,r,o);break}e.redraw.set(i,r,1)}else e.grid.set(i,r,0)}))}(e);e.grid=new n(e.gridWidth,e.gridHeight),e.redraw=new n(e.gridWidth,e.gridHeight)}var Re={signature:"GIF",version:"89a",trailer:59,extensionIntroducer:33,applicationExtensionLabel:255,graphicControlExtensionLabel:249,imageSeparator:44,signatureSize:3,versionSize:3,globalColorTableFlagMask:128,colorResolutionMask:112,sortFlagMask:8,globalColorTableSizeMask:7,applicationIdentifierSize:8,applicationAuthCodeSize:3,disposalMethodMask:28,userInputFlagMask:2,transparentColorFlagMask:1,localColorTableFlagMask:128,interlaceFlagMask:64,idSortFlagMask:32,localColorTableSizeMask:7};function xe(e=256){let t=0,i=new Uint8Array(e);return{get buffer(){return i.buffer},reset(){t=0},bytesView:()=>i.subarray(0,t),bytes:()=>i.slice(0,t),writeByte(e){n(t+1),i[t]=e,t++},writeBytes(e,r=0,a=e.length){n(t+a);for(let n=0;n<a;n++)i[t++]=e[n+r]},writeBytesView(e,r=0,a=e.byteLength){n(t+a),i.set(e.subarray(r,r+a),t),t+=a}};function n(e){var n=i.length;if(n>=e)return;e=Math.max(e,n*(n<1048576?2:1.125)>>>0),0!=n&&(e=Math.max(e,256));let r=i;i=new Uint8Array(e),t>0&&i.set(r.subarray(0,t),0)}}var Pe=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];var ke=function(e,t,i,n,r=xe(512),a=new Uint8Array(256),o=new Int32Array(5003),s=new Int32Array(5003)){let l=o.length,h=Math.max(2,n);a.fill(0),s.fill(0),o.fill(-1);let g=0,d=0,c=h+1,u=c,m=!1,f=u,y=(1<<f)-1,C=1<<c-1,b=C+1,S=C+2,B=0,w=i[0],p=0;for(let e=l;e<65536;e*=2)++p;p=8-p,r.writeByte(h),M(C);let v=i.length;for(let e=1;e<v;e++)e:{let t=i[e],n=(t<<12)+w,r=t<<p^w;if(o[r]===n){w=s[r];break e}let a=0===r?1:l-r;for(;o[r]>=0;)if(r-=a,r<0&&(r+=l),o[r]===n){w=s[r];break e}M(w),w=t,S<4096?(s[r]=S++,o[r]=n):(o.fill(-1),S=C+2,m=!0,M(C))}return M(w),M(b),r.writeByte(0),r.bytesView();function M(e){for(g&=Pe[d],d>0?g|=e<<d:g=e,d+=f;d>=8;)a[B++]=255&g,B>=254&&(r.writeByte(B),r.writeBytesView(a,0,B),B=0),g>>=8,d-=8;if((S>y||m)&&(m?(f=u,y=(1<<f)-1,m=!1):(++f,y=12===f?1<<f:(1<<f)-1)),e==b){for(;d>0;)a[B++]=255&g,B>=254&&(r.writeByte(B),r.writeBytesView(a,0,B),B=0),g>>=8,d-=8;B>0&&(r.writeByte(B),r.writeBytesView(a,0,B),B=0)}}};function Ee(e,t,i){return e<<8&63488|t<<2&992|i>>3}function Le(e,t,i,n){return e>>4|240&t|(240&i)<<4|(240&n)<<8}function Ae(e,t,i){return e>>4<<8|240&t|i>>4}function Fe(e,t,i){return e<t?t:e>i?i:e}function Ge(e){return e*e}function We(e,t,i){var n=0,r=1e100;let a=e[t],o=a.cnt,s=a.ac,l=a.rc,h=a.gc,g=a.bc;for(var d=a.fw;0!=d;d=e[d].fw){let t=e[d],a=t.cnt,u=o*a/(o+a);if(!(u>=r)){var c=0;i&&(c+=u*Ge(t.ac-s))>=r||!((c+=u*Ge(t.rc-l))>=r)&&(!((c+=u*Ge(t.gc-h))>=r)&&(!((c+=u*Ge(t.bc-g))>=r)&&(r=c,n=d)))}}a.err=r,a.nn=n}function He(e,t,i={}){let{format:n="rgb565",clearAlpha:r=!0,clearAlphaColor:a=0,clearAlphaThreshold:o=0,oneBitAlpha:s=!1}=i;if(!e||!e.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");let l=new Uint32Array(e.buffer),h=!1!==i.useSqrt,g="rgba4444"===n,d=function(e,t){let i=new Array("rgb444"===t?4096:65536),n=e.length;if("rgba4444"===t)for(let t=0;t<n;++t){let n=e[t],r=n>>24&255,a=n>>16&255,o=n>>8&255,s=255&n,l=Le(s,o,a,r),h=l in i?i[l]:i[l]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};h.rc+=s,h.gc+=o,h.bc+=a,h.ac+=r,h.cnt++}else if("rgb444"===t)for(let t=0;t<n;++t){let n=e[t],r=n>>16&255,a=n>>8&255,o=255&n,s=Ae(o,a,r),l=s in i?i[s]:i[s]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};l.rc+=o,l.gc+=a,l.bc+=r,l.cnt++}else for(let t=0;t<n;++t){let n=e[t],r=n>>16&255,a=n>>8&255,o=255&n,s=Ee(o,a,r),l=s in i?i[s]:i[s]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};l.rc+=o,l.gc+=a,l.bc+=r,l.cnt++}return i}(l,n),c=d.length,u=c-1,m=new Uint32Array(c+1);for(var f=0,y=0;y<c;++y){let e=d[y];if(null!=e){var C=1/e.cnt;g&&(e.ac*=C),e.rc*=C,e.gc*=C,e.bc*=C,d[f++]=e}}Ge(t)/f<.022&&(h=!1);for(y=0;y<f-1;++y)d[y].fw=y+1,d[y+1].bk=y,h&&(d[y].cnt=Math.sqrt(d[y].cnt));var b,S,B;for(h&&(d[y].cnt=Math.sqrt(d[y].cnt)),y=0;y<f;++y){We(d,y,!1);var w=d[y].err;for(S=++m[0];S>1&&!(d[b=m[B=S>>1]].err<=w);S=B)m[S]=b;m[S]=y}var p=f-t;for(y=0;y<p;){for(var v;;){var M=m[1];if((v=d[M]).tm>=v.mtm&&d[v.nn].mtm<=v.tm)break;v.mtm==u?M=m[1]=m[m[0]--]:(We(d,M,!1),v.tm=y);w=d[M].err;for(S=1;(B=S+S)<=m[0]&&(B<m[0]&&d[m[B]].err>d[m[B+1]].err&&B++,!(w<=d[b=m[B]].err));S=B)m[S]=b;m[S]=M}var I=d[v.nn],N=v.cnt,R=I.cnt;C=1/(N+R);g&&(v.ac=C*(N*v.ac+R*I.ac)),v.rc=C*(N*v.rc+R*I.rc),v.gc=C*(N*v.gc+R*I.gc),v.bc=C*(N*v.bc+R*I.bc),v.cnt+=I.cnt,v.mtm=++y,d[I.bk].fw=I.fw,d[I.fw].bk=I.bk,I.mtm=u}let x=[];var P=0;for(y=0;;++P){let e=Fe(Math.round(d[y].rc),0,255),t=Fe(Math.round(d[y].gc),0,255),i=Fe(Math.round(d[y].bc),0,255),n=255;if(g){if(n=Fe(Math.round(d[y].ac),0,255),s){n=n<=("number"==typeof s?s:127)?0:255}r&&n<=o&&(e=t=i=a,n=0)}let l=g?[e,t,i,n]:[e,t,i];if(De(x,l)||x.push(l),0==(y=d[y].fw))break}return x}function De(e,t){for(let i=0;i<e.length;i++){let n=e[i],r=n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2],a=!(n.length>=4&&t.length>=4)||n[3]===t[3];if(r&&a)return!0}return!1}function Te(e,t,i,n,r){let a=0,o=1e100;for(let s=0;s<r.length;s++){let l=r[s],h=Oe(l[3]-n);h>o||(h+=Oe(l[0]-e),h>o||(h+=Oe(l[1]-t),h>o||(h+=Oe(l[2]-i),!(h>o)&&(o=h,a=s))))}return a}function Ue(e,t,i,n){let r=0,a=1e100;for(let o=0;o<n.length;o++){let s=n[o],l=Oe(s[0]-e);l>a||(l+=Oe(s[1]-t),l>a||(l+=Oe(s[2]-i),!(l>a)&&(a=l,r=o)))}return r}function Oe(e){return e*e}function je(e={}){let{initialCapacity:t=4096,auto:i=!0}=e,n=xe(t),r=new Uint8Array(256),a=new Int32Array(5003),o=new Int32Array(5003),s=!1;return{reset(){n.reset(),s=!1},finish(){n.writeByte(Re.trailer)},bytes:()=>n.bytes(),bytesView:()=>n.bytesView(),get buffer(){return n.buffer},get stream(){return n},writeHeader:l,writeFrame(e,t,h,g={}){let{transparent:d=!1,transparentIndex:c=0,delay:u=0,palette:m=null,repeat:f=0,colorDepth:y=8,dispose:C=-1}=g,b=!1;if(i?s||(b=!0,l(),s=!0):b=Boolean(g.first),t=Math.max(0,Math.floor(t)),h=Math.max(0,Math.floor(h)),b){if(!m)throw new Error("First frame must include a { palette } option");(function(e,t,i,n,r=8){let a=1,o=0,s=Ve(n.length)-1,l=a<<7|r-1<<4|o<<3|s,h=0,g=0;Ye(e,t),Ye(e,i),e.writeBytes([l,h,g])})(n,t,h,m,y),ze(n,m),f>=0&&function(e,t){e.writeByte(33),e.writeByte(255),e.writeByte(11),qe(e,"NETSCAPE2.0"),e.writeByte(3),e.writeByte(1),Ye(e,t),e.writeByte(0)}(n,f)}let S=Math.round(u/10);!function(e,t,i,n,r){var a,o;e.writeByte(33),e.writeByte(249),e.writeByte(4),r<0&&(r=0,n=!1),n?(a=1,o=2):(a=0,o=0),t>=0&&(o=7&t),o<<=2;let s=0;e.writeByte(o|s|a),Ye(e,i),e.writeByte(r||0),e.writeByte(0)}(n,C,S,d,c);let B=Boolean(m)&&!b;(function(e,t,i,n){if(e.writeByte(44),Ye(e,0),Ye(e,0),Ye(e,t),Ye(e,i),n){let t=0,i=0,r=Ve(n.length)-1;e.writeByte(128|t|i|r)}else e.writeByte(0)})(n,t,h,B?m:null),B&&ze(n,m),function(e,t,i,n,r=8,a,o,s){ke(i,n,t,r,e,a,o,s)}(n,e,t,h,y,r,a,o)}};function l(){qe(n,"GIF89a")}}function ze(e,t){let i=1<<Ve(t.length);for(let n=0;n<i;n++){let i=[0,0,0];n<t.length&&(i=t[n]),e.writeByte(i[0]),e.writeByte(i[1]),e.writeByte(i[2])}}function Ye(e,t){e.writeByte(255&t),e.writeByte(t>>8&255)}function qe(e,t){for(var i=0;i<t.length;i++)e.writeByte(t.charCodeAt(i))}function Ve(e){return Math.max(Math.ceil(Math.log2(e)),1)}function Xe(e){if(e.startRecordingGifFlag){console.log("Starting GIF recording...");const{data:t,width:i,height:n}=e.ctx.getImageData(0,0,3*e.gridWidth,3*e.gridHeight);e.gifPalette=He(t,16),e.gif=je(),e.recordingGif=!0,e.startRecordingGifFlag=!1}if(e.stopRecordingGifFlag){e.gif.finish(),e.gifOutput=e.gif.bytes();const r=new Blob([e.gifOutput],{type:"image/gif"}),a=URL.createObjectURL(r);if("Download"==e.gifMode){const e=document.createElement("a");e.href=a,e.download="output.gif",document.body.appendChild(e),e.click(),document.body.removeChild(e)}else"InAppWebView"==e.gifMode&&(t=r,i=function(e){window.flutter_inappwebview.callHandler("saveGif",e)},(n=new FileReader).onload=function(e){i(e.target.result)},n.readAsDataURL(t));e.recordingGif=!1,e.stopRecordingGifFlag=!1,console.log("Stopped recording gif")}var t,i,n;if(e.recordingGif){const{data:t,width:i,height:n}=e.ctx.getImageData(0,0,e.gridWidth,e.gridHeight),r=function(e,t,i="rgb565"){if(!e||!e.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");if(t.length>256)throw new Error("applyPalette() only works with 256 colors or less");let n=new Uint32Array(e.buffer),r=n.length,a="rgb444"===i?4096:65536,o=new Uint8Array(r),s=new Array(a);if("rgba4444"===i)for(let e=0;e<r;e++){let i=n[e],r=i>>24&255,a=i>>16&255,l=i>>8&255,h=255&i,g=Le(h,l,a,r),d=g in s?s[g]:s[g]=Te(h,l,a,r,t);o[e]=d}else{let e="rgb444"===i?Ae:Ee;for(let i=0;i<r;i++){let r=n[i],a=r>>16&255,l=r>>8&255,h=255&r,g=e(h,l,a),d=g in s?s[g]:s[g]=Ue(h,l,a,t);o[i]=d}}return o}(t,e.gifPalette),a=e.gifPalette;e.gif.writeFrame(r,i,n,{palette:a}),e.nRecordedFrames=e.nRecordedFrames+1,e.nRecordedFrames>1e3&&(e.stopRecordingGifFlag=!0,e.paused=!0,console.log("Stopped recording gif after 1000 frames."))}}var $e=166320;function Ke(e,t=null){const i=performance.now();e.paused?(e.step&&(_e(e,t),e.step=!1),e.recordingGif&&Xe(e)):_e(e,t);const r=performance.now();e.frameExecutionTime=r-i,e.reinitialiseGridFlag&&(Ne(e),e.reinitialiseGridFlag=!1),e.changeGridSizeFlag&&(e.gridHeight=e.tempGridHeight,e.gridWidth=e.tempGridWidth,e.imageData=new Uint8ClampedArray(4*e.gridWidth*e.gridHeight),e.redraw=new n(e.gridWidth,e.gridHeight),e.canvas=document.getElementById("gameCanvas"),e.canvas.width=e.gridWidth,e.canvas.height=e.gridHeight,e.ctx=e.canvas.getContext("2d"),Ne(e),e.changeGridSizeFlag=!1),setTimeout((function(){requestAnimationFrame((()=>Ke(e,t)))}),Math.max(0,e.targetCycleTime-e.frameExecutionTime))}function _e(e,t){Be(e),null!=t&&t(e),Me(e),function(e){const t=e.ruleClass.ruleChain[0].nStates;var i=0;e.ruleClass.ruleChain.length>1&&(i=e.ruleClass.ruleChain[1].nStates);var r=a*t,s=a*i,l=Math.floor(a/2),h=[new Uint8Array(r),new Uint8Array(s)],g=new Uint8Array(l),d=new n(e.gridWidth,e.gridHeight),c=e.grid;const u=e.time;for(var m=0;m<e.gridHeight;m++)for(var f=0;f<e.gridWidth;f++){var y=o(e,m,f,c,h,g,u,t,i);const n=e.grid.get(m,f);var C=n;C=e.useLogo&&0!=e.mask.get(m,f)?e.ruleClass2.updateRule(n,C,y,e.time,e.activityLevel):e.ruleClass.updateRule(n,C,y,e.time,e.activityLevel),Math.floor(C/e.ruleClass.colorUnit)%e.nColors!=Math.floor(n/e.ruleClass.colorUnit)%e.nColors?e.redraw.set(m,f,1):e.redraw.set(m,f,0),d.set(m,f,C),h[0]=h[0].fill(0),h[1]=h[1].fill(0),g=g.fill(0)}e.addRandomness&&we(e,d,e.findNeighbour),e.grid=d}(e),he(e),Xe(e),e.time=(e.time+1)%$e,e.randomisePeriodicityShiftAndTopology&&function(e){Math.random()<1e-4&&(e.gridPeriodicityShiftX=Math.floor(Math.random()*e.gridWidth),console.log("Periodicity shift X: "+e.gridPeriodicityShiftX)),Math.random()<1e-4&&(e.gridPeriodicityShiftY=Math.floor(Math.random()*e.gridHeight),console.log("Periodicity shift Y: "+e.gridPeriodicityShiftY)),Math.random()<1e-4&&(e.gridFlipX=!e.gridFlipX,ye(e),console.log("Flip X: "+e.gridFlipX)),Math.random()<1e-4&&(e.gridFlipY=!e.gridFlipY,ye(e),console.log("Flip Y: "+e.gridFlipY))}(e),e.reloadColorPaletteFlag&&(Z(e),e.reloadColorPaletteFlag=!1),function(e){for(var t=0;t<e.colors.length;t++){var i=e.colors[t];i.drift>0&&(e.colors[t]=O(i))}}(e)}function Je(e,t){if(e.saveEventData){var i=e.ruleClass.ruleChain[0].getName(),n=new Blob([i],{type:"text/plain"}),r=URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download="dataAutomata.txt",a.click()}}function Ze(e){document.getElementById("submitButton").addEventListener("click",(function(){!function(e){Object.keys(e).forEach((e=>{let t=document.getElementById(e);var i;t&&(i="checkbox"===t.type?t.checked:"number"===t.type||"range"===t.type?parseFloat(t.value):t.value,localStorage.setItem(e,i))})),location.reload()}(e)}))}function Qe(e){document.getElementById("randomnessAmount").addEventListener("input",(function(){!function(e,t){e.randomnessAmount=parseFloat(t),document.getElementById("randomnessAmountValue").textContent=t}(e,this.value)}))}function et(e){let t=new ImageData(e.imageData,e.gridWidth,e.gridHeight);e.ctx.putImageData(t,e.canvasCornerX,e.canvasCornerY)}console.log("Loading main.js");var tt={gridHeight:192,gridWidth:192,targetCycleTime:100,addRandomness:!0,randomnessAmount:-1.5,randomisePeriodicityShiftAndTopology:!0,gridPeriodicityShiftX:0,gridPeriodicityShiftY:0,gridFlipX:!1,gridFlipY:!1,colorPalette:"variable",metaRule:"Variable",initialisation:"random",ruleSwitchPeriod:2e4,ruleEvolvePeriod:2e3,config:se.Mixed,sanityConfig:le.Default},it=new class{constructor({gridHeight:e=200,gridWidth:t=200,targetCycleTime:i=100,addRandomness:r=!0,randomnessAmount:a=-2,randomisePeriodicityShiftAndTopology:o=!0,gridPeriodicityShiftX:s=0,gridPeriodicityShiftY:l=0,gridFlipX:h=!1,gridFlipY:g=!1,colorPalette:d="black2",metaRule:c="VariableGR",initialisation:u="random",logo:m=null,useLogo:f=!1,config:y=null,sanityConfig:C=null}={}){this.config=y,this.sanityConfig=C,this.paused=!1,this.step=!1,this.targetCycleTime=i,this.gridHeight=e,this.gridWidth=t,this.grid=new n(this.gridWidth,this.gridHeight),this.gridPeriodicityShiftX=s,this.gridPeriodicityShiftY=l,this.gridFlipX=h,this.gridFlipY=g,this.mask=null,this.findNeighbour=null,this.tempGridHeight=null,this.tempGridWidth=null,this.imageData=new Uint8ClampedArray(4*this.gridWidth*this.gridHeight).fill(0),this.redraw=new n(this.gridWidth,this.gridHeight),this.colorPalette=d,this.initialisation=u,this.logo=m,this.useLogo=f,this.colors=[],this.nColors=4,this.addRandomness=r,this.randomnessAmount=a,this.randomisePeriodicityShiftAndTopology=o,this.reinitialiseGridFlag=!1,this.changeGridSizeFlag=!1,this.metaRule=c,this.ruleClass=null,this.updateCellValue=null,this.updateCellValueAuxiliary=null,this.currentRuleAndStyle=null,this.time=0,this.ruleLogSwitchProbability=-25,this.styleLogEvolveProbability=-25,this.changeRuleFlag=!0,this.changeBaseRuleFlag=!1,this.changeStyleFlag=!1,this.evolveColoringRuleFlag=!1,this.reloadColorPaletteFlag=!1,this.logMultiplicativeFactor=0,this.logMultiplicativeEvolveFactor=0,this.activityLevel=0,this.nCellChangedHistoric=0,this.meanColorChangeHistoric=0,this.brightness=127,this.maxBrightness=130,this.minBrightness=124,this.diffBrightness=0,this.relCellChanged=0,this.flickerIndex=0,this.colorCount=[0,0,0,0],this.frameExecutionTime=0,this.gif=null,this.gifMode="Download",this.startRecordingGifFlag=!1,this.stopRecordingGifFlag=!1,this.recordingGif=!1,this.nRecordedFrames=0,this.saveEventData=!1,this.updateGlobalDataFromConfig()}resampleRuleClass(){this.ruleClass=new T(this),null!==this.ruleClass2&&(this.ruleClass2=new T(this))}updateGlobalDataFromConfig(){"timeBetweenStyleChanges"in this.config.styleConfig?this.logMultiplicativeEvolveFactor=25/this.config.styleConfig.timeBetweenStyleChanges:this.logMultiplicativeEvolveFactor=0,"timeBetweenRuleChanges"in this.config.ruleConfig?this.logMultiplicativeFactor=25/this.config.ruleConfig.timeBetweenRuleChanges:this.logMultiplicativeFactor=0}}(tt);!function(e){e.canvasCornerX=0,e.canvasCornerY=0,e.canvas=document.getElementById("gameCanvas"),e.canvas.width=e.gridWidth,e.canvas.height=e.gridHeight,e.ctx=e.canvas.getContext("2d")}(it),window.onload=function(){!function(e){document.getElementById("addRandomness").addEventListener("change",(function(){e.addRandomness=this.checked}))}(it),function(e){document.getElementById("fullscreenButton").addEventListener("click",(function(){e.canvas.requestFullscreen?e.canvas.requestFullscreen():e.canvas.mozRequestFullScreen?e.canvas.mozRequestFullScreen():e.canvas.webkitRequestFullscreen?e.canvas.webkitRequestFullscreen():e.canvas.msRequestFullscreen&&e.canvas.msRequestFullscreen()}))}(it),function(e){e.canvas.addEventListener("mousemove",(function(t){if(t.shiftKey){var i=e.canvas.getBoundingClientRect(),n=t.clientX-i.left,r=t.clientY-i.top,a=i.width/e.gridWidth,o=i.height/e.gridHeight,s=Math.floor(n/a),l=Math.floor(r/o);e.grid.set(l,s,1)}}))}(it),function(e){e.canvas.addEventListener("mousedown",(function(t){var i=e.canvas.getBoundingClientRect(),n=t.clientX-i.left,r=t.clientY-i.top,a=i.width/e.gridWidth,o=i.height/e.gridHeight,s=Math.floor(n/a),l=Math.floor(r/o);t.shiftKey||t.ctrlKey?t.shiftKey&&!t.ctrlKey?(e.grid.set(l,(s+1)%e.gridWidth,1),e.grid.set(l,s,1),e.grid.set((l+1)%e.gridHeight,s,1)):!t.shiftKey&&t.ctrlKey?(e.grid.set(l,s,1),e.grid.set((l+1)%e.gridHeight,s,1)):t.shiftKey&&t.ctrlKey&&(e.grid.set(l,s,1),e.grid.set(l,(s+1)%e.gridWidth,1)):(e.grid.set((l+1)%e.gridHeight,(s+1)%e.gridWidth,1),e.grid.set((l-1+e.gridHeight)%e.gridHeight,(s+1)%e.gridWidth,1),e.grid.set((l-1+e.gridHeight)%e.gridHeight,(s-1+e.gridWidth)%e.gridWidth,1),e.grid.set((l+1)%e.gridHeight,(s-1+e.gridWidth)%e.gridWidth,1))}))}(it),Ze(it),Qe(it),function(e){document.getElementById("gridPeriodicityShiftX").addEventListener("input",(function(){let t=parseInt(this.value);isNaN(t)&&(t=0),e.gridPeriodicityShiftX=t,ye(e)})),document.getElementById("gridPeriodicityShiftY").addEventListener("input",(function(){let t=parseInt(this.value);isNaN(t)&&(t=0),e.gridPeriodicityShiftY=t,ye(e)})),document.getElementById("gridFlipX").addEventListener("change",(function(){e.gridFlipX=this.checked,ye(e)})),document.getElementById("gridFlipY").addEventListener("change",(function(){e.gridFlipY=this.checked,ye(e)}))}(it),function(e){document.getElementById("targetCycleTime").addEventListener("input",(function(){let t=parseInt(this.value);isNaN(t)&&(t=0),e.targetCycleTime=t}))}(it),function(e){document.getElementById("colorPalette").addEventListener("change",(function(){e.colorPalette=this.value,Z(e)}))}(it),function(e){document.getElementById("metaRule").addEventListener("change",(async function(){e.metaRule=this.value,e.currentRuleAndStyle=e.ruleClass.getName(),Ce(e)}))}(it),function(e){document.getElementById("changeRule").addEventListener("click",(function(){e.changeRuleFlag=!0})),document.getElementById("changeBaseRule").addEventListener("click",(function(){e.changeBaseRuleFlag=!0})),document.getElementById("changeColoringRule").addEventListener("click",(function(){e.changeStyleFlag=!0})),document.getElementById("evolveColoringRule").addEventListener("click",(function(){e.evolveColoringRuleFlag=!0})),null!==document.getElementById("reinitialiseGrid")&&document.getElementById("reinitialiseGrid").addEventListener("click",(function(){e.reinitialiseGridFlag=!0})),null!==document.getElementById("recordGif")&&document.getElementById("recordGif").addEventListener("click",(function(){e.recordingGif?(e.recordingGif=!1,e.stopRecordingGifFlag=!0,this.textContent="Record gif"):(e.recordingGif=!0,e.startRecordingGifFlag=!0,this.textContent="Stop recording")}))}(it),function(e){document.getElementById("changeColor").addEventListener("click",(function(){e.reloadColorPaletteFlag=!0}))}(it),function(e){document.getElementById("saveEventCheckbox").addEventListener("change",(function(){e.saveEventData=this.checked})),document.getElementById("likeButton").addEventListener("click",(function(){Je(e)})),document.getElementById("dislikeButton").addEventListener("click",(function(){Je(e)}))}(it),function(e){const t=document.getElementById("playPauseButton");t.addEventListener("click",(()=>{e.paused=!e.paused,t.textContent=e.paused?"Pause":"Play",console.log("Paused",e.paused)})),document.getElementById("stepButton").addEventListener("click",(()=>{e.paused=!0,e.step=!0}))}(it),function(e){Object.keys(e).forEach((t=>{let i=localStorage.getItem(t);null!==i&&("boolean"==typeof e[t]?e[t]="true"===i:"number"==typeof e[t]?e[t]=parseFloat(i):e[t]=i)}))}(it),function(e){Object.keys(e).forEach((t=>{let i=document.getElementById(t);i&&("checkbox"===i.type?i.checked=e[t]:i.value=e[t])}))}(it),function(e){e.canvas.width=Math.max(e.gridHeight,e.gridWidth),e.canvas.height=Math.max(e.gridHeight,e.gridWidth),e.canvasCornerX=0,e.canvasCornerY=0;var t=document.getElementById("gameCanvas");if(e.gridHeight>e.gridWidth){var i=Math.floor(e.gridWidth/e.gridHeight*800);t.style.width=i+"px",t.style.height="800px",t.width=i*e.gridHeight/800,t.height=e.gridHeight}else{var n=Math.floor(e.gridHeight/e.gridWidth*800);t.style.width="800px",t.style.height=n+"px",t.width=e.gridWidth,t.height=n*e.gridWidth/800}e.imageData=new Uint8ClampedArray(4*e.gridWidth*e.gridHeight)}(it),Z(it),ye(it),Ce(it);let e=atob("c2FtMzE0MTUuZ2l0aHViLmlv");window.location.hostname!==e&&""!==window.location.hostname||Ne(it).then((()=>{Ke(it,et)})).catch((e=>{console.error("Error initialising the grid: ",e)}))}})();
(()=>{"use strict";var e={},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,i),o.exports}class r{constructor(e,t){this.width=e,this.height=t,this.data=new Uint8Array(this.width*this.height),this.rows=new Array(this.height),this.transposed=!1,this.get=this.getNormal,this.set=this.setNormal}static fromArray(e,t=!1,i=!1,n=!1){const o=e.length,a=e[0].length,s=new r(a,o);for(let t=0;t<o;t++){n&&(t=o-t-1);for(let r=0;r<a;r++)i&&(r=a-r-1),s.set(t,r,e[t][r])}return t&&s.transpose(),s}toArray(){const e=[];for(let t=0;t<this.height;t++){const i=[];for(let e=0;e<this.width;e++)i.push(this.get(t,e));e.push(i)}return e}clone(){const e=new r;for(let t in this)this.hasOwnProperty(t)&&("object"==typeof this[t]&&null!==this[t]?e[t]=JSON.parse(JSON.stringify(this[t])):e[t]=this[t]);return e}transpose(){[this.width,this.height]=[this.height,this.width],[this.get,this.set]=this.transposed?[this.getNormal,this.setNormal]:[this.getTransposed,this.setTransposed],this.transposed=!this.transposed}flipX(){for(let e=0;e<this.height;e++)for(let t=0;t<this.width/2;t++){const i=this.get(e,t);this.set(e,t,this.get(e,this.width-t-1)),this.set(e,this.width-t-1,i)}}flipY(){for(let e=0;e<this.height/2;e++)for(let t=0;t<this.width;t++){const i=this.get(e,t);this.set(e,t,this.get(this.height-e-1,t)),this.set(this.height-e-1,t,i)}}getNormal(e,t){return this.data[e*this.width+t]}setNormal(e,t,i){this.data[e*this.width+t]=i}getTransposed(e,t){return this.data[t*this.height+e]}setTransposed(e,t,i){this.data[t*this.height+e]=i}}function n(e){let t=Object.values(e).reduce(((e,t)=>e+t),0),i=Object.values(e).reduce(((e,i,r)=>[...e,i/t+(e[r-1]||0)]),[]);return function(){let t=Math.random(),r=i.findIndex((e=>t<e));return Object.keys(e)[r]}}const o=15;function a(e,t,i,r,n,o,a,s,l){const g=r.height-1,h=r.width-1,d=r.data,c=r.width;var u=n[0],m=n[1];let f;for(var p=-1;p<=1;p++)for(var C=-1;C<=1;C++){if(0==p&&0==C)continue;if(o[0]=((-1===p?1:p)+(-1===C?1:C))%2,o[a%4+1]=-1==p?1:0,o[(1+a)%4+1]=-1==C?1:0,o[(2+a)%4+1]=1==p?1:0,o[(3+a)%4+1]=1==C?1:0,o[(1+a)%2+5]=p*C==1?0:1,o[a%2+5]=p*C==-1?0:1,0==t||0==i||t==g||i==h)var[b,y]=e.findNeighbour(e,t,i,p,C);else var b=t+p,y=i+C;const r=d[b*c+y],n=r%s,B=Math.floor(r/s)%l;f=0;for(var S=0;S<s-1;S++)n==S+1&&(u[S]+=1,f+=s,u[f+S]+=o[0],f+=s,u[f+S]+=1-o[0],f+=s,u[f+S]+=o[1],f+=s,u[f+S]+=1-o[1],f+=s,u[f+S]+=o[2],f+=s,u[f+S]+=1-o[2],f+=s,u[f+S]+=o[3],f+=s,u[f+S]+=1-o[3],f+=s,u[f+S]+=o[4],f+=s,u[f+S]+=1-o[4],f+=s,u[f+S]+=o[5],f+=s,u[f+S]+=1-o[5],f+=s,u[f+S]+=o[6],f+=s,u[f+S]+=1-o[6]),f=0;for(f=0,S=0;S<l;S++)B==S&&(m[S]+=1,f+=l,m[f+S]+=o[0],f+=l,m[f+S]+=1-o[0],f+=l,m[f+S]+=o[1],f+=l,m[f+S]+=1-o[1],f+=l,m[f+S]+=o[2],f+=l,m[f+S]+=1-o[2],f+=l,m[f+S]+=o[3],f+=l,m[f+S]+=1-o[3],f+=l,m[f+S]+=o[4],f+=l,m[f+S]+=1-o[4],f+=l,m[f+S]+=o[5],f+=l,m[f+S]+=1-o[5],f+=l,m[f+S]+=o[6],f+=l,m[f+S]+=1-o[6]),f=0}return[u,m]}const s="mix",l="isotropic",g="xcross",h="vcross",d="xvcross",c="directional1",u="directional2",m="directional3",f="directional2b",p="directional",C="hexagonal1",b="hexagonal2",y={[s]:.2,[l]:.4,[g]:.05,[h]:.05,[d]:.05,[c]:.05,[u]:.05,[m]:.05,[f]:.05,[p]:.05,[C]:.05,[b]:.05};function S(e,t){var i,r=t;if(r==s){var n=Math.random();r=n<.5?l:n<.7?g:n<.9?h:p}return r==l?Math.floor(Math.random()*e):r==h?Math.floor(Math.random()*e+e):r==g?Math.floor(Math.random()*e+2*e):r==d?Math.floor(2*Math.random()*e+e):r==c?Math.floor(2*Math.random()*e+3*e):r==u?Math.floor(4*Math.random()*e+3*e):r==m?Math.floor(6*Math.random()*e+3*e):r==f?((i=Math.floor(4*Math.random()*e+3*e))>=5*e&&(i+=2*e),i):r==p?Math.floor(8*Math.random()*e+3*e):r==C?((i=Math.floor(2*Math.random()*e+11*e))>=12*e&&(i+=e),i):r==b?((i=Math.floor(2*Math.random()*e+12*e))>=13*e&&(i+=e),i):void 0}function B(e){var t=8;return[1,2].includes(e)?t=4:[3,5,7,9].includes(e)?t=3:[4,6,8,10].includes(e)?t=5:[11,13].includes(e)?t=6:[12,14].includes(e)&&(t=2),t}const R="A",w="C",G="E",I="B";class v{constructor(e,t,i,r,n,o=null,a=4){this.type=e,this.threshold=t,this.neighbourType=i,this.inactivation=r,this.modulo=n,this.periodicity=o,this.nStatesPrimary=a,this.testInactive=function(e,t){return e==w?function(e){return 0==e}:e==R?function(e){return e%t==0}:function(e){return!0}}(this.inactivation,this.modulo);var s=[i[0],i[1][0]*a+i[1][1]];this.neighbourType.length>2&&s.push(i[2][0]*a+i[2][1]),this.testValue=function(e,t,i){return t==G&&2==i.length?function(t){return t[i[0]][i[1]]==e}:t==I&&2==i.length?function(t){return t[i[0]][i[1]]>e}:t==G&&3==i.length?function(t){return t[i[0]][i[1]]+t[i[0]][i[2]]==e}:t==I&&3==i.length?function(t){return t[i[0]][i[1]]+t[i[0]][i[2]]>e}:void 0}(this.threshold,this.type,s),this.testPeriodicity=function(e){let t;return t=null==e?function(e){return!0}:function(t){return e[t%e.length]},t}(o)}test(e,t,i){var r=this.testPeriodicity(i);return this.testValue(e)&&this.testInactive(t)&&r}name(){var e="";null!=this.periodicity&&this.periodicity.length>1&&(e=this.periodicity.map((e=>e?"1":"0")).join(""));var t=`${this.neighbourType[0]}|`;t+=`${this.neighbourType[1][0]}:${this.neighbourType[1][1]}`,this.neighbourType.length>2&&(t+=`|${this.neighbourType[2][0]}:${this.neighbourType[2][1]}`);var i=this.inactivation;return this.inactivation==R&&(i+=this.modulo),`${this.type}${this.threshold}${i}[${t}]${e}`}static fromName(e){var t=null,i=4;e.startsWith(G)?t=G:e.startsWith(I)&&(t=I);var r=e.substring(t.length),n=parseInt(r.substring(0,1)),o=null;(r=r.substring(1)).startsWith(w)?o=w:r.startsWith(R)?(isNaN(r.charAt(1))||(i=parseInt(r.charAt(1)),r=r.substring(1)),o=R):r.startsWith("N")&&(o="N");var a=(r=r.substring(o.length)).split("[")[1].split("]")[0].split("|"),s=[parseInt(a[0])],l=a[1].split(":").map((e=>parseInt(e)));if(s.push(l),a.length>2){var g=a[2].split(":").map((e=>parseInt(e)));s.push(g)}var h=null;return(r=r.split("]")[1]).length>0&&(h=r.split("").map((e=>"1"===e))),new v(t,n,s,o,i,h)}static randomSample(e,t,i=null,r=s,o=null){var a=[e,t];const l=[G,I],g=l[Math.floor(Math.random()*l.length)],h=[w,R,"N"],d=h[Math.floor(Math.random()*h.length)];null===i&&(i={0:2/3,1:1/3});const c=n(i)(),u=S(a[c],r),m=[Math.floor(u/a[c]),u%a[c]];var f=void 0;if(Math.random()<.5){for(var p=S(a[c],r);u==p;)p=S(a[c],r);f=[c,m,[Math.floor(p/a[c]),p%a[c]]]}else f=[c,m];var C,b=0,y=B(f[1][0]);if(f.length>2&&B(f[2][0])>y&&(y=B(f[2][0])),b=g===I?Math.floor(Math.random()*y):Math.floor(Math.random()*y)+1,C=Math.random()<.5&&d==R?Math.floor(5*Math.random())+2:0==c?e:t,Math.random()<.2)M=null;else{var M;null==o&&(o=Math.floor(20*Math.random())+2);do{M=new Array(o).fill(0).map((()=>Math.random()<.5))}while(!M.includes(!0))}return new v(g,b,f,d,C,M,e)}}function M(e){return e.replace(/\[([0-9]+)\]|\{([0-9A-Za-z|]+)\}/g,((e,t,i)=>{if(t){let e="";for(const i of t)Math.random()>.5&&(e+=i);return e}if(i){const e=i.split("|");return e[Math.floor(Math.random()*e.length)]}}))}function P(e,t){const i=`[${(new Date).toLocaleTimeString()}] ${t}`;e.logEvents.push(i),e.logEvents.length>50&&(e.logEvents=e.logEvents.slice(-50)),console.log(i)}class A{constructor(){this.nStates=void 0}updateRule(e,t,i,r){throw new Error("Must override method")}getName(){throw new Error("Must override method")}}class k extends A{constructor(e){super(),this.seedingPatterns=this.getSeedingPatterns(),this.constructSeedingSampler(e,!0),this.randomnessLogShift=0}getSeedingPatterns(){throw new Error("Must override method")}constructSeedingSampler(e,t=!0){t&&null!=e.config.ruleConfig.randomnessConfig&&(e.config.randomnessConfig=e.config.ruleConfig.randomnessConfig);let i=e.config.randomnessConfig;i.seedMasks=Object.keys(i.seedingPatterns).reduce(((e,t)=>(e[t]=i.seedingPatterns[t].mask,e)),{}),i.seedMasksAsArrays=Object.keys(i.seedingPatterns).reduce(((e,t)=>(null!=i.seedingPatterns[t].mask?e[t]=i.seedingPatterns[t].mask:e[t]=null,e)),{}),i.seedProb=Object.keys(i.seedingPatterns).reduce(((e,t)=>(e[t]=i.seedingPatterns[t].prob,e)),{}),e.seedSampler=n(i.seedProb)}}class N extends k{constructor(e,t,i){super(e),null==t&&(t=N.generateRule()),i||this.initialiseRule(e,t)}updateRule(e,t,i,r){var n=e%this.nStates;return 1==n&&this.survive.includes(i[0][this.neighbourhood[0]])?t=1:n>0&&n<this.nStates-1?t+=1:n==this.nStates-1?t=0:0==n&&this.birth.includes(i[0][this.neighbourhood[1]])?t=1:0==n&&this.inhibited.includes(i[0][this.neighbourhood[2]])&&(t=this.nStates-1),t}static getRuleString(e,t,i,r,n){let a=e.map((e=>Math.floor(e/n)%o+":"+e%n)),s=`B${t.join("")}`;return"0:0"!=a[0]&&(s+=`|${a[0]}`),s+=`/S${i.join("")}`,"0:0"!=a[1]&&(s+=`|${a[1]}`),s+=`/I${r.join("")}`,"0:0"!=a[2]&&(s+=`|${a[2]}`),s+=`/G${n}`,s}getNeighbourhoodFromString(e,t,i){let r,n;if(null==e||""==e)this.neighbourhood[t]=0,r=0;else{let i;[r,n]=e.split(":"),i=n?parseInt(r)*this.nStates+parseInt(n):parseInt(r)*this.nStates,this.neighbourhood[t]=i}return i[t]=B(r),i}initialiseRule(e,t,i=null){this.ruleString=M(t);const r=this.ruleString.split("/");this.neighbourhood=[0,0,0],this.inhibited=[],this.nStates=Number(r[r.length-1].substring(1));var n=[8,8,8];for(var o of r)if("B"==o[0]){let e=0,[t,i]=o.substring(1).split("|");this.birth=new Uint8Array(t.split("").map(Number)),n=this.getNeighbourhoodFromString(i,e,n),this.birth=new Uint8Array(Array.from(this.birth).filter((t=>t<=n[e])))}else if("S"==o[0]){let e=1,[t,i]=o.substring(1).split("|");this.survive=new Uint8Array(t.split("").map(Number)),n=this.getNeighbourhoodFromString(i,e,n),this.survive=new Uint8Array(Array.from(this.survive).filter((t=>t<=n[e])))}else if("I"==o[0]){let e=2,[t,i]=o.substring(1).split("|");this.inhibited=new Uint8Array(t.split("").map(Number)),n=this.getNeighbourhoodFromString(i,e,n),this.inhibited=new Uint8Array(Array.from(this.inhibited).filter((t=>t<=n[e])))}this.ruleString=N.getRuleString(this.neighbourhood,this.birth,this.survive,this.inhibited,this.nStates),null==i&&(i=t),P(e,"Rul | Sampled rulestring "+this.ruleString+" from the rule template "+i+".")}static generateRule(e){let t=Math.floor(10*Math.random())+3,i=[8,8,8];null==e&&(e=[Math.floor(Math.random()*o*t),Math.floor(Math.random()*o*t),Math.floor(Math.random()*o*t)]);let r=[Math.floor(e[0]/t)%o,Math.floor(e[1]/t)%o,Math.floor(e[2]/t)%o];for(let e=0;e<3;e++)i[e]=B(r[e]);let n=this.generateRandomArray(1,i[0]);0==n.length&&(n=[2]);let a=this.generateRandomArray(1,i[1]),s=this.generateRandomArray(1,i[2]);return s=s.filter((e=>!n.includes(e)&&!a.includes(e)&&2!=e)),this.getRuleString(e,n,a,s,t)}static generateRandomArray(e,t){let i=[];for(let r=e;r<=t;r++)Math.random()<.5&&i.push(r);return i}getName(){return this.ruleString}getSeedingPatterns(){return{random:{prob:1,mask:null}}}}class x extends N{constructor(e,t,i=null){super(e,null,!0),this.initialiseRule(e,t),e.birth3=this.birth[0]**3,e.ruleRegularisationSeed=this.ruleRegularisationSeed}updateRule(e,t,i,r,n){var o=e%this.nStates;return 1==o&&this.survive.includes(i[0][this.neighbourhood[0]])&&Math.random()>n/4-.05?t=1:o>0&&o<this.nStates-1?t+=1:o==this.nStates-1?t=0:0==o&&this.birth.includes(i[0][this.neighbourhood[1]])&&Math.random()>n-.05?t=1:0==o&&this.inhibited.includes(i[0][this.neighbourhood[2]])&&(t=this.nStates-1),t}getName(){return`${this.ruleString}/R${this.ruleRegularisationSeed.toFixed(0)}`}initialiseRule(e,t){if(t.includes("R")){var i=t;t=M(t),this.ruleRegularisationSeed=parseFloat(t.split("R")[1]);const r=t.split("/").slice(0,-1).join("/");super.initialiseRule(e,r,i)}else super.initialiseRule(e,t)}}class F extends A{constructor(e,t,i,r,n=4){super(),this.conditions=e,this.nStates=this.conditions.length+1,this.nStatesPrimary=n,this.conditionLevels=t,this.neighbourhoodGeometryType=i,this.periodicityLength=r}updateRule(e,t,i,r){t=0;for(let n=0;n<this.conditions.length;n++)if(this.conditions[n].test(i,e,r)){t=n+1;break}return t}getName(){return this.conditions.map((e=>e.name())).join("||")}static sampleRule(e,t,i){var r=t.nConditions,o=t.chosenConditionLevels,a=t.neighbourhoodGeometryType,s=t.periodicityLength,l=[];null==r&&(r=Math.floor(8*Math.random())+2),null==a&&(a=n(y)()),null==s&&(s=this.samplePeriodicityLength());var g=r+1;for(let e=0;e<r;e++)l.push(v.randomSample(i,g,o,a,s));var h=new F(l,o,a,s,i);return P(e,"Sty | Sampled style "+h.getName()+"."),h}static samplePeriodicityLength(){var e=Math.random();return e<.2?null:e<.6?1:e<.7?2:e<.8?3:e<.9?4:Math.floor(20*Math.random())+5}static ruleFromNames(e){var t=(e=M(e)).split("||").map((e=>v.fromName(e)));return new F(t,null,s,null)}evolveRule(e,t=null){var i,r=this.conditions.length;null==t&&(t=this.conditionLevels),i=2==r?Math.floor(2*Math.random())+1:10==r?Math.floor(2*Math.random()):Math.floor(3*Math.random());var n=e.config.styleConfig.nDeterministicConditions??0;0==i?this.removeCondition(e,n):1==i?this.changeCondition(e,t,n):this.addCondition(e,t)}addCondition(e,t){var i=this.conditions.slice(),r=v.randomSample(this.nStatesPrimary,this.nStates,this.conditionLevels,this.neighbourhoodGeometryType,this.periodicityLength);P(e,"Sty | Adding condition "+r.name()+" to the current style "+this.getName()+". New style: "+this.getName()+"."),i.push(r),P(e,"Sty | New style: "+this.getName()+"."),this.conditions=i}removeCondition(e,t){var i=this.conditions.slice(),r=Math.floor(Math.random()*(i.length-t))+t;P(e,"Sty | Removing condition "+(r+1).toString()+" from the current style "+this.getName()+". New style: "+this.getName()+"."),i.splice(r,1)[0],this.conditions=i}changeCondition(e,t,i){var r=this.conditions.slice(),n=Math.floor(Math.random()*(r.length-i))+i;P(e,"Sty | Replacing condition "+(n+1).toString()+" from the current style "+this.getName()+". New style: "+this.getName()+"."),r[n]=v.randomSample(this.nStatesPrimary,this.nStates,t,this.neighbourhoodGeometryType,this.periodicityLength),this.conditions=r}}function L({none:e=1,p2h:t=1,p2v:i=1,d2a:r=1,d2b:n=1,g2:o=1,p4:a=1,d4:s=1,g4:l=1,r8:g=1}={}){return{Random:{prob:e,mask:null},"Random p2h":{prob:t,mask:null},"Random p2v":{prob:i,mask:null},"Random d2a":{prob:r,mask:null},"Random d2b":{prob:n,mask:null},"Random g2":{prob:o,mask:null},"Random p4":{prob:a,mask:null},"Random d4":{prob:s,mask:null},"Random g4":{prob:l,mask:null},"Random r8":{prob:g,mask:null}}}function T({diamondWave:e=.001,glider:t=.001,oscillatorI:i=.001,oscillatorII:r=.001,shortLivedStar:n=.001,snake:o=.001,spaceship:a=.001,squareWave:s=.001,star:l=.001,butterflyGun:g=.001}){return{Butterfly:{prob:t,mask:[[0,0,1,2],[0,2,0,0],[1,2,1,0]]},"Diamond wave":{prob:e,mask:[[0,0],[1,1]]},"Oscillator I":{prob:i,mask:[[0,0,1,0],[1,2,2,0],[0,2,2,1],[0,1,0,0]]},"Oscillator II":{prob:r,mask:[[0,0,2,0,0,0,0],[0,1,1,0,0,1,0],[0,0,2,1,2,1,2],[0,0,1,0,1,0,0],[2,1,2,1,2,0,0],[0,1,0,0,1,1,0],[0,0,0,0,2,0,0]]},"Short-lived star":{prob:n,mask:[[1,0],[0,1]]},Snake:{prob:o,mask:[[0,1,2,1,2,1,0],[1,2,0,1,0,2,1],[1,2,0,1,0,2,1],[0,1,2,1,2,1,0]]},Spaceship:{prob:a,mask:[[1,1],[2,0],[0,2]]},"Square wave":{prob:s,mask:[[1,1],[1,1]]},Star:{prob:l,mask:[[1,0,1],[0,0,0],[1,0,1]]},"Butterfly gun":{prob:g,mask:[[0,2,1,0,0,0,0,0],[0,0,2,1,0,0,0,0],[2,0,0,2,1,0,0,0],[1,2,0,0,2,1,0,0],[0,1,0,2,1,0,2,1],[0,0,2,1,0,0,2,1]]}}}function W({glider:e=.001,oscillator:t=.001,spaceship:i=.001,gun:r=.001}){return{Glider:{prob:e,mask:[[0,0,1],[1,0,1],[0,1,1]]},Oscillator:{prob:t,mask:[[1,1,1]]},"Spaceship 1":{prob:i,mask:[[1,0,0,1,0],[0,0,0,0,1],[1,0,0,0,1],[0,1,1,1,1]]},"Spaceship 2":{prob:i,mask:[[0,0,0,0,1,0],[0,0,0,0,0,1],[1,0,0,0,0,1],[0,1,1,1,1,1]]},"Spaceship 3":{prob:i,mask:[[0,1,1,1,1],[1,0,0,0,1],[0,0,0,0,1],[1,0,0,1,0]]}}}const H={Default:{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:L()},"Brian's brain default":{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...T({glider:1,oscillatorI:2,oscillatorII:2,star:4,snake:4,squareWave:4})}},"Brian's brain butterflies":{randomnessLogShift:1,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...T({glider:120})}},"Brian's brain snakes":{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...T({snake:100})}},"Brian's brain stars":{randomnessLogShift:1,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...T({oscillatorI:20,oscillatorII:20,star:40,shortLivedStar:20})}},"Brian's brain waves":{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...T({spaceship:3,squareWave:8})}},"Brian's brain outernet":{hideInApp:!0,randomnessLogShift:-.5,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...T({glider:1,oscillatorI:2,oscillatorII:2,star:4,snake:4,squareWave:4})}},"Brian's brain outernet 2":{hideInApp:!0,randomnessLogShift:-.25,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...T({squareWave:.5})}},"Brian's brain outernet c":{hideInApp:!0,randomnessLogShift:-.25,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...T({squareWave:.2})}},"Brian's brain diamond waves":{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...T({diamondWave:20})}},"Brian's brain butterfly gun":{randomnessLogShift:-.5,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...T({butterflyGun:30})}},"Game of life classic":{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...W({glider:10,spaceship:10})}},"Game of life gliders":{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...W({glider:100})}},"Game of life spaceships":{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...W({spaceship:100})}},Generations:{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:20,seedingPatterns:{...L(),...T({spaceship:4,squareWave:4})}},"Star Wars":{randomnessLogShift:0,squareVsRectangularMaskProbability:.7,maxSeedSize:10,seedingPatterns:{...L(),...function({snakeWeight:e=.001,gunWeight:t=.001,starWeight:i=.001}){return{random:{prob:6,mask:null},Snake:{prob:e,mask:[[0,1,2,1,2,1,0],[1,2,0,1,0,2,1],[1,2,0,1,0,2,1],[0,1,2,1,2,1,0]]},"Gun 0":{prob:t,mask:[[1,2,3],[0,1,0],[1,1,0],[0,1,0],[0,1,0],[1,1,0],[0,1,2],[3,0,1]]},"Gun 1":{prob:t,mask:[[0,0,1,0,0,0,0,0,0],[0,1,1,1,0,0,1,2,0],[3,0,1,0,0,0,1,0,3],[0,0,1,1,0,1,1,1,0],[0,0,1,1,0,0,1,0,0],[0,0,2,0,0,3,2,1,0]]},"Gun 2":{prob:t,mask:[[0,0,0,1,0,1,0,0],[0,1,2,0,1,1,1,0],[1,2,3,1,1,0,1,1],[1,2,3,0,0,1,1,0],[0,0,0,0,1,2,0,0]]},"Gun 3":{prob:t,mask:[[0,0,0,0,0,3,2,0],[0,0,1,0,0,1,0,0],[1,1,1,1,1,1,1,1],[0,1,0,0,0,0,1,0],[0,1,0,0,0,0,1,0],[1,1,1,0,0,1,1,1],[0,1,0,0,0,0,1,0]]},"Gun 4":{prob:t,mask:[[0,0,0,1,0,0],[0,0,1,1,1,3],[0,0,0,1,0,2],[0,0,0,0,0,1],[0,1,0,1,1,0],[1,1,1,1,1,1],[0,1,0,0,1,0]]},"Gun 5":{prob:t,mask:[[0,1,1,2,0],[2,0,1,0,3],[3,1,1,1,0],[0,1,0,2,1]]},"Gun 6":{prob:t,mask:[[0,0,0,2,0],[3,0,1,1,0],[2,1,1,1,3],[1,0,1,0,2],[0,0,0,1,0]]},"Gun 7":{prob:t,mask:[[0,1,0,0,1,0,0,0,0,0],[1,1,1,2,2,1,0,3,2,0],[0,1,0,2,0,1,0,0,1,0],[0,1,2,2,1,1,1,1,1,1],[0,0,1,0,0,1,0,0,1,0]]},"Gun 8":{prob:t,mask:[[0,0,0,0,3,2,0,0],[0,0,0,0,1,0,3,0],[0,0,1,2,0,1,0,0],[0,0,2,3,1,1,0,0],[3,1,0,1,0,1,1,1],[2,0,1,1,1,0,1,3],[0,3,0,0,1,1,1,0],[0,0,0,0,1,3,0,0]]},"Gun 9":{prob:t,mask:[[0,0,0,1,0,3,0,0],[0,0,2,0,1,0,2,1],[0,0,3,1,1,1,2,1],[0,0,1,0,1,0,3,0],[3,0,1,0,1,0,0,0],[2,1,1,1,3,0,0,0],[1,0,1,0,2,0,0,0],[0,0,0,0,1,3,0,0]]},"Gun 10":{prob:t,mask:[[0,0,1,1,3,0,1,0],[0,1,0,2,2,1,1,1],[1,1,1,0,0,0,1,0],[0,1,0,0,0,0,3,0]]},"Gun 11":{prob:t,mask:[[0,3,2,1,1,2,3,0],[0,0,1,0,0,1,0,0],[1,1,1,1,1,1,1,1],[2,3,0,0,0,0,3,2]]},"Gun 12":{prob:t,mask:[[0,2,3,0,0,1,0,0,0],[1,0,1,1,1,1,0,3,0],[0,1,1,0,0,1,1,2,1],[0,0,1,1,1,1,0,2,1],[0,1,2,0,0,0,3,0,0]]},"Gun 13":{prob:t,mask:[[0,0,0,0,3,0,0,0,0],[0,0,0,0,2,0,0,0,0],[0,0,1,0,1,0,1,0,0],[0,2,3,1,1,1,3,2,0],[1,0,1,0,0,0,1,0,1],[1,1,1,1,0,1,1,1,1],[2,0,1,0,2,0,1,0,2],[0,3,0,1,0,1,0,3,0]]},"Gun 14":{prob:t,mask:[[0,0,0,1,0,1,0,0,0],[1,0,1,0,1,0,1,0,1],[2,1,1,1,1,1,1,1,2],[0,1,0,1,0,1,0,1,0],[0,1,0,0,1,0,0,1,0],[1,1,1,1,1,1,1,1,1],[0,1,0,0,1,0,0,1,0]]},"Gun 15":{prob:t,mask:[[0,1,0,0,0,0],[1,1,1,0,0,0],[0,1,0,0,1,0],[0,0,0,1,1,1],[0,0,0,0,1,0]]},Star:{prob:i,mask:[[0,0,0,1,0,0,0],[0,0,1,1,1,0,0],[0,1,0,0,0,1,0],[1,1,0,0,0,1,1],[0,1,0,0,0,1,0],[0,0,1,1,1,0,0],[0,0,0,1,0,0,0]]}}}({gunWeight:3,snakeWeight:1,starWeight:1})}}},O={1:1,2:1,3:1,4:1,6:1,8:1,12:1,16:1,24:1,32:1,48:1,64:1,96:1},E={Test:{name:"Test",hideInApp:!0,rules:{"N0/B{12|13|14|1}[5678]/S{12|13|14|23|24|34|1|2|3|4}[5678]/I[12345678]/G{6|7|8|9|10}/R{20|30|40|100}":20},randomnessConfig:H.Generations},Custom:{name:"Custom",hideInApp:!0,rules:{}},"Mixed safe":{name:"Mixed safe",recommended:!0,ruleGroup:{"BB (Brian's brain)":1,"BB (modified)":1,"BB diamond waves":1,"Brian's brain family":2,"BB butterflies":1,"BB S0 family":1,"BB snakes":1,"BB stars":1,"BB waves":1,"BB butterfly gun":1,Beacon:1,"Burning islands":2,"Game of life":1,"Game of life gliders":1,"Game of life spaceships":1,"Cranky Crawlers":2,"Extravagant Extenders":2,"Flaming ships":1,"Large ships I":2,"Large ships II":2,"Leggy ships":2,"Puffy Pulse":2,"Spiky waves":4,Spinners:1,"Spinners HS":1,"Star wars":1,"Star wars family":1,"Star cruisers":1,"Straight ships":1,"Straight ships":1,Swimmers:2,"Wiggly ships":8}},Mixed:{name:"Mixed",recommended:!0,ruleGroup:{"Asteroid fields":1,"Bloomerang family":1,"BB (Brian's brain)":1,"BB (modified)":1,"BB diamond waves":1,"Brian's brain family":1,"BB butterflies":1,"BB S0 family":1,"BB snakes":1,"BB stars":1,"BB waves":1,"BB butterfly gun":1,Beacon:1,"Burning islands":2,Burst:1,"Caterpillars+":1,"Cranky Crawlers":3,Deltas:1,"Extravagant Extenders":2,"Flaming ships":1,"Game of life":1,"Game of life gliders":1,"Game of life spaceships":1,"Generations high state count":3,"Generations low state count":3,"Generations unregularised":3,"Large ships I":2,"Large ships II":2,"Leggy ships":2,"Life-like":1,Millipedes:2,"Puffy Pulse":3,"Short Extenders":1,"Slow BB":1,"Slow growth":1,"Space shooter":2,"Spiky waves":4,Spinners:1,"Spinners HS":1,"Star wars":1,"Star wars family":1,"Star wars S0":1,"Star cruisers":1,"Straight ships":1,"Straight ships":1,Swimmers:2,Trains:1,Walls:1,"Wiggly ships":8}},"Classy Classics":{name:"Classy Classics",recommended:!0,deterministic:!0,ruleGroup:{"BB (Brian's brain)":3,"Game of life":1,"Game of life gliders":1,"Game of life spaceships":1,"Star wars":1}},"Asteroid fields":{name:"Asteroid fields",recommended:!0,deterministic:!1,rules:{"B2[5678]/S0[5678]/I[2345678]/G4":1,"B2[5678]/S02[45678]/I1[345678]/G{3|4|5|6|7|8}":1}},"Bloomerang family":{name:"Bloomerang family",deterministic:!1,rules:{"B34[5678]/S234[678]/I[12345678]/G{9|10|11|12|13|14|24}":1}},"BB (Brian's brain)":{name:"BB (Brian's brain)",deterministic:!0,rules:{"B2/S/I/G3":1},randomnessConfig:H["Brian's brain default"]},"BB butterflies":{name:"BB butterflies",deterministic:!1,rules:{"B2[45678]/S[45678]/I34[5678]/G3":1},randomnessConfig:H["Brian's brain butterflies"]},"BB butterfly gun":{name:"BB butterfly gun",deterministic:!0,rules:{"B2/S/I/G3/R50":1},randomnessConfig:H["Brian's brain butterfly gun"]},"BB (modified)":{name:"BB (modified)",deterministic:!0,rules:{"B2/S/I345678/G3":1},randomnessConfig:H["Brian's brain default"]},"BB (outernet)":{name:"BB (outernet)",hideInApp:!0,deterministic:!0,rules:{"B2/S/I345678/G3":1},randomnessConfig:H["Brian's brain outernet 2"]},"BB (outernetc)":{name:"BB (outernetc)",hideInApp:!0,deterministic:!0,rules:{"B2/S/I345678/G3":1},randomnessConfig:H["Brian's brain outernet c"]},"BB diamond waves":{name:"BB diamond waves",deterministic:!1,rules:{"B2[45678]/S[45678]/I34[5678]/G{3|4}":1},randomnessConfig:H["Brian's brain diamond waves"]},"Brian's brain family":{name:"Brian's brain family",recommended:!0,deterministic:!1,rules:{"B2[45678]/S[45678]/I[345678]/G{3|4}":1},randomnessConfig:H["Brian's brain default"]},"BB S0 family":{name:"BB S0 family",deterministic:!1,rules:{"B2[45678]/S0[45678]/I[345678]/G{4|5}":1},randomnessConfig:H["Brian's brain default"]},"BB snakes":{name:"BB snakes",deterministic:!1,rules:{"B2[45678]/S[45678]/I34[5678]/G{3|4}":1},randomnessConfig:H["Brian's brain snakes"]},"BB stars":{name:"BB stars",deterministic:!0,rules:{"B2/S/I345678/G3":1},randomnessConfig:H["Brian's brain stars"]},"BB waves":{name:"BB waves",deterministic:!1,rules:{"B2[45678]/S[45678]/I34[5678]/G{3|4}":1},randomnessConfig:H["Brian's brain waves"]},Beacon:{name:"Beacon",recommended:!0,deterministic:!1,rules:{"B2456[8]/S347[8]/I345[678]/G{4|5|6|7|8|9|10|11|12|13|14}":1,"B2456[8]/S347[8]/I345[678]/G{4|5|6|7|8|9|10|11|12|13|14}/R20":1}},"Burning islands":{name:"Burning islands",deterministic:!1,rules:{"B23[45678]/S24567[8]/I1/G4/R50":1}},Burst:{name:"Burst",deterministic:!1,rules:{"B34[568]/S0235[678]/I[345678]/G5":1,"B34[568]/S235[678]/I[345678]/G5":1,"B34[568]/S0235[678]/I[345678]/G3/R200":1,"B34[568]/S235[678]/I[345678]/G3/R200":1,"B34[568]/S0235[678]/I[345678]/G4/R50":1,"B34[568]/S235[678]/I[345678]/G4/R50":1}},"Caterpillars+":{name:"Caterpillars+",deterministic:!0,rules:{"B378/S124567/I1345678/G3":1}},"Cranky Crawlers":{name:"Cranky Crawlers",deterministic:!1,rules:{"B2[45678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1}/S1[345678]/I1[2345678]/G{5|6|7|8|9|10|11|12|13|14|15}/R100":1},randomnessConfig:H["Brian's brain waves"]},Deltas:{name:"Deltas",deterministic:!1,rules:{"B23[45678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1}/S1[345678]/I1[2345678]/G{5|6|7|8|9|10|11|12|13|14|15}/R100":1}},"Extravagant Extenders":{name:"Extravagant Extenders",deterministic:!1,rules:{"B24{5|6}[78]/S345[78]/I1[2345678]/G{5|6|7|8|9|10|11|12|13|14}/R20":1}},"Short Extenders":{name:"Short Extenders",deterministic:!1,rules:{"B24[78]/S345[78]/I12[345678]/G{5|6|7}/R100":1}},"Flaming ships":{name:"Flaming ships",deterministic:!0,rules:{"B24/S34/I15678/G4":1}},"Game of life":{name:"Game of life",recommended:!0,deterministic:!0,rules:{"B3/S23/I/G2":1},randomnessConfig:H["Game of life classic"]},"Game of life gliders":{name:"Game of life gliders",deterministic:!0,rules:{"B3/S23/I/G2":1},randomnessConfig:H["Game of life gliders"]},"Game of life spaceships":{name:"Game of life spaceships",deterministic:!0,rules:{"B3/S23/I/G2":1},randomnessConfig:H["Game of life spaceships"]},Generations:{name:"Generations",recommended:!0,deterministic:!1,ruleGroup:{"Generations high state count":1,"Generations low state count":1,"Generations unregularised":1}},"Generations high state count":{name:"Generations high state count",deterministic:!1,rules:{"B1[2345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/S[12345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/I[12345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/G{25|30|35|40|45|50|55|60|65|70|75|80|90|100}/R200":1,"B2[345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/S[12345678]/I[12345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/G{25|30|35|40|45|50|55|60|65|70|75|80|90|100}/R200":1},randomnessConfig:H.Generations},"Generations unregularised":{name:"Generations unregularised",deterministic:!1,rules:{"B2[345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/S[12345678]/I[12345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/G{25|30|35|40|45|50|55|60|65|70|75|80|90|100}":1,"B1[2345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/S[12345]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/I[12345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/G{25|30|35|40|45|50|55|60|65|70|75|80|90|100}":1},randomnessConfig:H.Generations},"Generations low state count":{name:"Generations low state count",deterministic:!1,rules:{"B1[2345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/S[12345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/I[12345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/G{3|4|5|6|7|8|9|10|15|20|25}/R100":1,"B2[345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/S[12345678]/I[12345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/G{3|4|5|6|7|8|9|10|15|20|25}/R100":1},randomnessConfig:H.Generations},"Large ships I":{name:"Large ships I",deterministic:!1,rules:{"B234[5678]/S2[45678]/I1[2345678]/G{10|11|12|13|14|15}":1}},"Large ships II":{name:"Large ships II",deterministic:!1,rules:{"B245[678]/S346[78]/I123[45678]/G{4|5|6|7|8|9|10|11}":1}},"Leggy ships":{name:"Leggy ships",deterministic:!1,rules:{"B23[5678]/S14[5678]/I1[2345678]/G{5|6|7|8|9|10}":1}},"Life-like":{name:"Life-like",deterministic:!1,rules:{"B34[5678]/S235[678]/I[45678]/G5":1}},Millipedes:{name:"Millipedes",deterministic:!1,rules:{"B2[45678]|{11|13}:1/S13[45678]/I1[2345678]/G{25|30|35|40|45|50}/R{10|30|100}":1,"B2[45678]|{1|2|3|4|5|6|7|8|9}:{0|1}/S13[45678]/I1[2345678]/G{25|30|35|40|45|50}/R{10|30|100}":3},randomnessConfig:H.Generations},"Puffy Pulse":{name:"Puffy Pulse",recommended:!0,deterministic:!1,rules:{"B{12|13|14|1}[5678]/S{12|13|14|23|24|34|1|2|3|4}[5678]/I[12345678]/G{6|7|8|9|10}/R{20|30|50|75|100}":1}},"Slow BB":{name:"Slow BB",deterministic:!1,rules:{"B2[45678]|1:0/S3[45678]|1:0/I[12345678]|1:0/G{5|6|7|8|9|10|11|12|13|14}":3}},"Slow growth":{name:"Slow growth",deterministic:!1,rules:{"B34[5678]/S234[678]/I2[45678]/G{10|11|12|13|14|15|16|17|18|19|20}":1}},"Space shooter":{name:"Space shooter",deterministic:!1,rules:{"B23[5678]/S34[678]/I1[2345678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/G{6|7|8|9|10|11|12|13}/R{50|100|200}":1}},"Spiky waves":{name:"Spiky waves",recommended:!0,deterministic:!1,rules:{"B23[45678]/S3[5678]/I[45678]|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/G{5|6|7|8|9|10|11|12}":8}},Spinners:{name:"Spinners",deterministic:!1,rules:{"B2[45678]|{3|4|5|6|7|8|9|10}:1/S2[345678]/I[2345678]/G{4|5|6|7|8|9|10|11|12|13|14}/R200":1}},"Spinners HS":{name:"Spinners HS",deterministic:!1,rules:{"B2[45678]|{3|4|5|6|7|8|9|10}:1/S2[345678]/I[2345678]/G{25|30|35|40|45|50|55|60|65|70|75}/R200":1}},"Star wars":{name:"Star wars",deterministic:!0,rules:{"B2/S345/I/G4":1},randomnessConfig:H["Star Wars"]},"Star wars family":{name:"Star wars family",recommended:!0,deterministic:!1,rules:{"B2[5678]/S345[78]/I[12345678]/G{3|4}":6,"B2[5678]/S345[678]/I[12345678]/G{5|6|7|8|9|10}":1,"B2[5678]/S345[78]/I[12345678]/G{3|4}/R{10|20}":12,"B2[5678]/S345[678]/I[12345678]/G{5|6|7|8|9|10}/R{10|20}":2},randomnessConfig:H["Star Wars"]},"Star wars S0":{name:"Star wars S0",deterministic:!1,rules:{"B2[5678]/S0345[678]/I[12345678]/G{7|8}":8},randomnessConfig:H["Star Wars"]},"Star cruisers":{name:"Star cruisers",recommended:!0,deterministic:!1,rules:{"B245[678]/S34[678]/I[12345678]/G{5|6|7|8}":15}},"Straight ships":{name:"Straight ships",deterministic:!1,rules:{"B2[5678]/S2[45678]/I1[345678]/G{3|4|5|6|7|8}/R100":1}},Swimmers:{name:"Swimmers",deterministic:!1,rules:{"B2[45678]|{3|4|5|6|7|8|9|10}:1/S2[345678]/I1[345678]/G{4|5|6|7|8|9|10|11|12|13|14}":1}},Trains:{name:"Trains",deterministic:!1,rules:{"B14|1:0/S[34]|1:0/I1[345678]/G{12|13|14|15|16|17|18|19|20}":1}},Walls:{name:"Walls",deterministic:!1,rules:{"B2[5678]/S34567/I1[345678]/G{5|6|7|8|9|10|11|12|13|14}":5}},"Wiggly ships":{name:"Wiggly ships",recommended:!0,rules:{"B24[5678]/S346[78]/I3[45678]/G{4|5|6|7|8|9|10|11}":1}},"Safe mixed generations":{name:"Safe mixed generations",hideInApp:!0,rules:{"N0/B2/S/I345678/G3":20,"N0/B2/S/I/G3":4,"N0/B2/S345/I/G4":5,"N0/B2/S245678/I1/G4":5,"N0/B24/S34/I15678/G4":5,"N0/B3/S23/I/G2":8,"N0/B2[45678]/S[45678]/I[345678]/G{3|4}":12,"N0/B2[5678]/S345[78]/I[12345678]/G{3|4}":6,"N0/B27/S345/I12357/G5":4,"N0/B2[5678]/S2[45678]/I1[345678]/G{3|4|5|6|7|8}":12,"N0/B24[678]/S34[678]/I[12345678]/G{3|4|5|6|7|8|9|10|11|12|13|14}":15,"N0/B34[5678]/S235[678]/I[45678]/G5":15,"N0/B24568/S34678/I34678/G7":5,"N0/B24568/S34678/I3[45678]/G{4|5|6|7|8|9|10|11}":15,"N0/B245[678]/S34[678]/I[12345678]/G{5|6|7|8}":15}},"Mixed generations":{name:"Mixed generations",hideInApp:!0,rules:{"N0/B2/S/I345678/G3":20,"N0/B2/S/I/G3":4,"N0/B2/S345/I/G4":5,"N0/B2/S245678/I1/G4":5,"N0/B24/S34/I15678/G4":5,"N0/B3/S23/I/G2":8,"N0/B2[45678]/S[45678]/I[345678]/G{3|4}":12,"N0/B2[5678]/S345[678]/I[12345678]/G{5|6|7|8|9|10}":9,"N0/B2[5678]/S345[78]/I[12345678]/G{3|4}":6,"N0/B2[5678]/S2[45678]/I1[345678]/G{3|4|5|6|7|8}":12,"N0/B24[678]/S34[678]/I[12345678]/G{3|4|5|6|7|8|9|10|11|12|13|14}":15,"N0/B34[5678]/S235[678]/I[45678]/G5":15,"N0/B23[5678]/S14[5678]/I1[2345678]/G{5|6|7|8|9|10}":10,"N0/B34[5678]/S234[678]/I2[45678]/G{10|11|12|13|14|15|16|17|18|19|20}":12,"N0/B34[5678]/S234[678]/I[12345678]/G{9|10|11|12|13|14|24}":12,"N0/B24[5678]/S345[678]/I[12345678]/G{11|12|13|14}":8,"N0/B34[568]/S0235[678]/I[345678]/G5":8,"N0/B34[568]/S235[678]/I[345678]/G5":8,"N0/B378/S124567/I1345678/G3":5,"N0/B2[5678]/S0[5678]/I[2345678]/G4":8,"N0/B2[5678]/S02[45678]/I1[345678]/G5":8,"N0/B2[45678]/S0[45678]/I[345678]/G{4|5}":8,"N0/B2[5678]/S0345[678]/I[12345678]/G{7|8}":8,"N0/B27/S345/I12357/G5":2,"N0/B245[678]/S34[678]/I[12345678]/G{5|6|7|8}":15,"N{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1}|0:{0|1}|0:0/B2[45678]/S2[45678]/I1[345678]/G{9|10|11|12|13|14}":6,"N0/B23/S34[678]/I1[2345678]/G{6|7|8|9|10|11|12|13}":3,"N0/B234[5678]/S2[45678]/I1[5678]/G{6|7|8|9|10|11|12|13|14}":12,"N0/B234[5678]/S3[45678]/I1[5678]/G{6|7|8|9|10|11|12|13|14}":8,"N0/B234[5678]/S[45678]/I1[5678]/G{6|7|8|9|10|11|12|13|14}":8,"N0/B234578/S37/I/G11":1,"N0/B23[45678]/S3[5678]/I[45678]/G{5|6|7|8|9|10|11|12}":8,"N0/B2368/S358/I/G5":1,"N0/B24[5678]/S3[45678]/I[5678]/G{5|6|7|8|9|10|11|12|13|14}":5,"N0/B24568/S3478/I34578/G{5|6|7}":3,"N0/B24568/S34578/I34578/G{9|12|14|14}":4,"N0/B24568/S34678/I34678/G7":5,"N0/B24568/S34678/I3[45678]/G{4|5|6|7|8|9|10|11}":15,"N0/B245[678]/S346[78]/I123[45678]/G{4|5|6|7|8|9|10|11}":8,"N0/B25[678]/S3[45678]/I[5678]/G{5|6|7|8|9|10|11|12|13|14}":12,"N0/B25/S345/I/G4":1,"N0/B25/S345/I/G5":1,"N0:0/B2[5678]/S34567/I1[345678]/G{5|6|7|8|9|10|11|12|13|14}":5,"N0/B2[5678]/S34[5678]/I[5678]/G{5|6}":15,"N0/B25678/S2478/I345678/G12":1,"N0/B2568/S345678/I345678/G8":1,"N0/B2568/S345678/I345678/G10":1,"N0/B2568/S345678/I345678/G12":1,"N0/B2568/S34578/I34578/G4":1,"N0/B2568/S34578/I34578/G5":1,"N0/B2568/S34578/I34578/G6":1,"N0/B2568/S34578/I34578/G7":1,"N0/B2568/S34578/I34578/G8":1,"N{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1}|0:0|0:0/B2[45678]/S1[345678]/I1[2345678]/G{5|6|7|8|9|10|11|12|13|14|15}":15,"N{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1}|0:0|0:0/B23[45678]/S1[345678]/I1[2345678]/G{5|6|7|8|9|10|11|12|13|14|15}":6,"N1/B2[45678]/S3[45678]/I[12345678]/G{5|6|7|8|9|10|11|12|13|14}":3,"N1/B23[45678]/S1[2345678]/I[12345678]/G{5|6|7|8|9|10|11|12|13|14}":3,"N5|1|18/B2[345678]/S1[345678]/I[345678]/G{7|7|7|8|8|8|11|12|13|14|15}":8,"N11:1|0:0|0:0/B245/S1/I12357/G6":3,"N0/B2[345678]/S[2345678]/I[12345678]/G{3|4|5|6|7|8|9|10|11|12|13|14}/R":20,"N0/B[12345678]/S[012345678]/I[12345678]/G{3|4|5|6|7|8|9|10|11|12|13|14}/R":10,"N0/B{12|13|14|1}[5678]/S{12|13|14|23|24|34|1|2|3|4}[5678]/I[12345678]/G{6|7|8|9|10}/R{50|75|100}":20,"N0/B1[2345678]/S[12345678]/I[12345678]/G{25|50|75|100}":12,"N0/B1/S[5678]/I[2345678]/G{25|50|75|100}":12,"N{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:0/B1[2345678]/S[12345678]/I[12345678]/G{25|50|75|100}":20,"N45|0|33/B2/S/I34/G7":1,"N58|0|16/B24568/S/I1/G{5|6|7|8}":3,"N66|0|67/B2/S23/I23/G6":3,"N66|0|0/B2/S1/I1/G6":2,"N67|0|0/B2/S1/I1/G6":2}}};Object.keys(E).filter((e=>E[e].recommended)),Object.keys(E).filter((e=>!E[e].hasOwnProperty("hideInApp")||!E[e].hideInApp));class D{colorUnit;ruleChain;updateRule;setRuleChain(){throw new Error("Must override method")}setUpdateRule(){this.updateRule=function(e,t,i,r,n){t=this.ruleChain[0].updateRule(e%this.ruleChain[0].nStates,t,i,r,n);var o=this.ruleChain[0].nStates;for(let n=1;n<this.ruleChain.length;n++)t+=o*this.ruleChain[n].updateRule(Math.floor(e/o)%this.ruleChain[n].nStates,t,i,r),t%=o*=this.ruleChain[n].nStates;return t%o}}setBaseRule(){throw new Error("Must override method")}setStyleRule(){throw new Error("Must override method")}getName(){return this.ruleChain.map((e=>e.getName())).join("-")}}class z extends D{constructor(e,t=!1){super(),this.ruleConfig=e.config.ruleConfig,t?(this.styleConfig=e.config.styleConfig2,console.log("Second style: ",this.styleConfig.name)):(this.styleConfig=e.config.styleConfig,console.log("First style: ",this.styleConfig.name)),this.randomnessConfig=e.config.randomnessConfig,this.currentGenerationsRule=null,this.setRuleChain(e),this.setUpdateRule()}setRuleChain(e){this.ruleChain=[null],this.setBaseRule(e),this.setStyleRule(e)}setBaseRule(e){if(this.ruleConfig=e.config.ruleConfig,"ruleGroup"in this.ruleConfig){var t=n(this.ruleConfig.ruleGroup)();this.ruleConfig.sampledRuleFamily=t,this.ruleConfig.rules=e.ruleConfigs[t].rules,this.ruleConfig.randomnessConfig=e.ruleConfigs[t].randomnessConfig,P(e,"Rul | Sampled the rule "+t+" from the rule group "+this.ruleConfig.name+".")}else this.ruleConfig=e.config.ruleConfig;let i=n(this.ruleConfig.rules)();var r=x;i.includes("R")||(i+="/R0"),["Random","andom"].includes(i)&&(i=null),this.ruleConfig.sampledRuleTemplate=i,null==this.ruleConfig.activityLevelForRuleWindowSize&&(this.ruleConfig.activityLevelForRuleWindowSize=parseInt(n(O)(),10)),this.ruleChain[0]=new r(e,i),"No style"==this.styleConfig.name?this.colorUnit=1:this.colorUnit=this.ruleChain[0].nStates}setStyleRule(e){if(0===Object.keys(this.styleConfig).length||"No style"==this.styleConfig.name)return this.colorUnit=1,void(this.ruleChain=this.ruleChain.slice(0,1));for(;this.ruleChain.length>1;)this.ruleChain.pop();if(this.styleConfig.style)return this.ruleChain.push(F.ruleFromNames(this.styleConfig.style)),void(this.colorUnit=this.ruleChain[0].nStates);var t=this.styleConfig.conditionLevels,i=n(t.reduce(((e,t,i)=>(e[i]=t.weight,e)),{}))();this.styleConfig.chosenConditionLevels=t[i].probabilities;var r=this.ruleChain[0].nStates;this.ruleChain.push(F.sampleRule(e,this.styleConfig,r)),this.colorUnit=this.ruleChain[0].nStates}updateGlobalDataWithConfig(e){}}const U={"GR blue":{name:"GR blue",hideInApp:!0,r:13,g:112,b:255},"GR grey":{name:"GR grey",hideInApp:!0,r:240,g:239,b:239},Black:{name:"Black",referenceColorOk:!0,r:0,g:0,b:0},"GR yellow":{name:"GR yellow",hideInApp:!0,r:247,g:255,b:28},White:{name:"White",referenceColorOk:!0,r:255,g:255,b:255},Grey:{name:"Grey",referenceColorOk:!0,r:127,g:127,b:127},Whitish:{name:"Whitish",hideInApp:!0,r:240,g:240,b:240},redBlue1:{name:"redBlue1",hideInApp:!0,r:221,g:12,b:12},redBlue2:{name:"redBlue2",hideInApp:!0,r:29,g:29,b:189},turquoiseRed1:{name:"turquoiseRed1",hideInApp:!0,r:39,g:192,b:177},turquoiseRed2:{name:"turquoiseRed2",hideInApp:!0,r:252,g:53,b:47},magentaCyan1:{name:"magentaCyan1",hideInApp:!0,r:156,g:36,b:150},magentaCyan2:{name:"magentaCyan2",hideInApp:!0,r:114,g:223,b:174},transparent:{name:"transparent",hideInApp:!0,r:0,g:0,b:0,t:0},Red:{name:"Red",referenceColorOk:!0,r:255,g:0,b:0},Orange:{name:"Orange",referenceColorOk:!0,r:255,g:127,b:0},Yellow:{name:"Yellow",referenceColorOk:!0,r:255,g:255,b:0},Chartreuse:{name:"Chartreuse",referenceColorOk:!0,r:127,g:255,b:0},Green:{name:"Green",referenceColorOk:!0,r:0,g:255,b:0},"Spring green":{name:"Spring green",referenceColorOk:!0,r:0,g:255,b:127},Cyan:{name:"Cyan",referenceColorOk:!0,r:0,g:255,b:255},Azure:{name:"Azure",referenceColorOk:!0,r:0,g:127,b:255},Blue:{name:"Blue",referenceColorOk:!0,r:0,g:0,b:255},Violet:{name:"Violet",referenceColorOk:!0,r:127,g:0,b:255},Majenta:{name:"Majenta",referenceColorOk:!0,r:255,g:0,b:255},Rose:{name:"Rose",referenceColorOk:!0,r:255,g:0,b:127},"Dark Sepia":{name:"Dark Sepia",referenceColorOk:!0,r:26,g:24,b:21},"CGA dark grey":{name:"CGA dark grey",referenceColorOk:!0,r:85,g:85,b:85},"CGA blue":{name:"CGA blue",referenceColorOk:!0,r:0,g:0,b:170},"CGA light blue":{name:"CGA light blue",referenceColorOk:!0,r:85,g:85,b:255},"CGA green":{name:"CGA green",referenceColorOk:!0,r:0,g:170,b:0},"CGA light green":{name:"CGA light green",referenceColorOk:!0,r:85,g:255,b:85},"CGA cyan":{name:"CGA cyan",referenceColorOk:!0,r:0,g:170,b:170},"CGA light cyan":{name:"CGA light cyan",referenceColorOk:!0,r:85,g:255,b:255},"CGA red":{name:"CGA red",referenceColorOk:!0,r:170,g:0,b:0},"CGA light red":{name:"CGA light red",referenceColorOk:!0,r:255,g:85,b:85},"CGA magenta":{name:"CGA magenta",referenceColorOk:!0,r:170,g:0,b:170},"CGA light magenta":{name:"CGA light magenta",referenceColorOk:!0,r:255,g:85,b:255},"CGA brown":{name:"CGA brown",referenceColorOk:!0,r:170,g:85,b:0},"CGA yellow":{name:"CGA yellow",referenceColorOk:!0,r:255,g:255,b:85},"CGA grey":{name:"CGA grey",referenceColorOk:!0,r:170,g:170,b:170},refFullSatMidInt:{name:"refFullSatMidInt",hideInApp:!0,r:255,g:127,b:0},refNoSatMidInt:{name:"refFullSatMidInt",hideInApp:!0,r:127,g:127,b:127},"Light saturated":{name:"Light saturated",hideInApp:!0,r:255,g:250,b:250},"Basic color":{name:"Basic color",recommended:!0,sampler:["Black","White","Red","Green","Blue","Yellow","Majenta","Cyan"]},"Secondary color":{name:"Secondary color",recommended:!0,sampler:["Black","White","Red","Orange","Yellow","Chartreuse","Green","Spring green","Cyan","Azure","Blue","Violet","Majenta","Rose"]},"CGA color":{name:"CGA color",sampler:["Black","CGA dark grey","CGA blue","CGA light blue","CGA green","CGA light green","CGA cyan","CGA light cyan","CGA red","CGA light red","CGA magenta","CGA light magenta","CGA brown","CGA yellow","CGA grey","White"]},"Hue constrained color":{name:"Hue constrained color",sampler:"Random",sampleDrift:"Random",sampleRedPerturbationStrength:"Random",sampleGreenPerturbationStrength:"Random",sampleBluePerturbationStrength:"Random",sampleBrightnessPerturbationStrength:"Random",brightnessRange:1,saturationRange:1,hueRange:.1},"Brightness oscillator":{name:"Rainbow color",recommended:!0,sampler:"Random",sampleDrift:"Sine brightness",sampleRedPerturbationStrength:"Random",sampleGreenPerturbationStrength:"Random",sampleBluePerturbationStrength:"Random",sampleBrightnessPerturbationStrength:"Random",referenceColorName:"Grey",brightnessRange:1,saturationConstraintType:"Attractive",saturationRange:.05,hueRange:1},"Rainbow color":{name:"Rainbow color",recommended:!0,sampler:"Random",sampleDrift:"Linear hue",sampleRedPerturbationStrength:"Random",sampleGreenPerturbationStrength:"Random",sampleBluePerturbationStrength:"Random",sampleBrightnessPerturbationStrength:"Random",referenceColorName:"Red",brightnessConstraintType:"Attractive",brightnessRange:.05,saturationConstraintType:"Attractive",saturationRange:.05,hueRange:1},"Random color":{name:"Random color",recommended:!0,sampler:"Random",sampleDrift:"Random",sampleRedPerturbationStrength:"Random",sampleGreenPerturbationStrength:"Random",sampleBluePerturbationStrength:"Random",sampleBrightnessPerturbationStrength:"Random"},"Repulsive brightness color":{name:"Repulsive brightness color",sampler:"Random",sampleDrift:"Random",sampleRedPerturbationStrength:"Random",sampleGreenPerturbationStrength:"Random",sampleBluePerturbationStrength:"Random",sampleBrightnessPerturbationStrength:"Random",referenceColorName:"White",brightnessConstraintType:"Repulsive",brightnessRange:1.5,saturationRange:1,hueRange:1},"Random grey":{name:"Random grey",recommended:!0,sampler:"Random",sampleDrift:"Random",sampleRedPerturbationStrength:"Random",sampleGreenPerturbationStrength:"Random",sampleBluePerturbationStrength:"Random",sampleBrightnessPerturbationStrength:"Random",referenceColorName:"Grey",brightnessRange:1,saturationConstraintType:"Attractive",saturationRange:.01,hueRange:1},"Saturated color":{name:"Saturated color",recommended:!0,sampler:"Random",drift:10,sampleRedPerturbationStrength:"Random",sampleGreenPerturbationStrength:"Random",sampleBluePerturbationStrength:"Random",sampleBrightnessPerturbationStrength:"Random",referenceColorName:"Orange",brightnessConstraintType:"Attractive",brightnessRange:.05,saturationConstraintType:"Attractive",saturationRange:.05,hueRange:1},"Textured black":{name:"Textured black",r:0,g:0,b:0,recommended:!0,sampleRedPerturbationStrength:"Random",sampleGreenPerturbationStrength:"Random",sampleBluePerturbationStrength:"Random",sampleBrightnessPerturbationStrength:"Random"},"Textured white":{name:"Textured white",r:255,g:255,b:255,recommended:!0,sampleRedPerturbationStrength:"Random",sampleGreenPerturbationStrength:"Random",sampleBluePerturbationStrength:"Random",sampleBrightnessPerturbationStrength:"Random"},Grisaille:{name:"Grisaille",sampler:"Random",sampleDrift:"Random",sampleBrightnessPerturbationStrength:"Random",referenceColorName:"Dark Sepia",brightnessRange:2,saturationRange:.1,hueRange:.1},Nacre:{name:"Nacre",sampler:"Random",sampleDrift:"Random",sampleBrightnessPerturbationStrength:"Random",referenceColorName:"Light saturated",brightnessRange:.05,saturationRange:.1,hueRange:1},"Hue and saturation constrained color":{name:"Hue and saturation constrained color",sampler:"Random",sampleDrift:"Random",sampleBrightnessPerturbationStrength:"Random",brightnessRange:2,saturationRange:.1,hueRange:.03}};Object.keys(U).filter((e=>!0===U[e].referenceColorOk)),Object.keys(U).filter((e=>!0===U[e].recommended)),Object.keys(U).filter((e=>!0!==U[e].hideInApp));var q=["Background color"];for(let e=1;e<30;e++)q.push(`Color ${e}`);class V{constructor({r:e=0,g:t=0,b:i=0,t:r=255,sampler:n=null,drift:o=0,sampleDrift:a=null,redPerturbationStrength:s=0,sampleRedPerturbationStrength:l=null,greenPerturbationStrength:g=0,sampleGreenPerturbationStrength:h=null,bluePerturbationStrength:d=0,sampleBluePerturbationStrength:c=null,brightnessPerturbationStrength:u=0,sampleBrightnessPerturbationStrength:m=null,referenceColor:f=null,referenceColorName:p="No constraint",brightnessConstraintType:C="Attractive",brightnessRange:b=1,saturationConstraintType:y="Attractive",saturationRange:S=1,hueConstraintType:B="Attractive",hueRange:R=1}={}){this.r=e,this.g=t,this.b=i,this.t=r,this.sampler=n,this.drift=o,this.sampleDrift=a,this.redPerturbationStrength=s,this.sampleRedPerturbationStrength=l,this.greenPerturbationStrength=g,this.sampleGreenPerturbationStrength=h,this.bluePerturbationStrength=d,this.sampleBluePerturbationStrength=c,this.brightnessPerturbationStrength=u,this.sampleBrightnessPerturbationStrength=m,this.referenceColor=f,this.referenceColorName=p,this.brightnessConstraintType=C,this.brightnessRange=b,this.saturationConstraintType=y,this.saturationRange=S,this.hueConstraintType=B,this.hueRange=R,this.phase=Math.random(),this.updateDoubles(),null==this.referenceColorName&&(this.referenceColorName="No constraint",this.referenceColor=null)}static fromConfig(e,t,i=[]){if(!e)return new V;if("referenceColorName"in e&&null!=e.referenceColorName&&!q.includes(e.referenceColorName)&&(e.referenceColor=V.fromConfig(t.colorConfigs[e.referenceColorName],t)),"Random"===e.sampler)e.r=j(),e.g=j(),e.b=j();else if(Array.isArray(e.sampler)){let r=e.sampler[Math.floor(Math.random()*e.sampler.length)],n=0;for(;i.includes(r)||n>10;)r=e.sampler[Math.floor(Math.random()*e.sampler.length)],n++;return V.fromConfig(t.colorConfigs[r],t)}return["Random","Linear hue","Sine brightness"].includes(e.sampleDrift)&&null==e.drift&&(e.drift=X()),"Random"===e.sampleRedPerturbationStrength&&(e.redPerturbationStrength=Y()),"Random"===e.sampleGreenPerturbationStrength&&(e.greenPerturbationStrength=Y()),"Random"===e.sampleBluePerturbationStrength&&(e.bluePerturbationStrength=Y()),"Random"===e.sampleBrightnessPerturbationStrength&&(e.brightnessPerturbationStrength=Y()),new V(e)}updateDoubles(){this.redPertStrength2=2*this.redPerturbationStrength,this.greenPertStrength2=2*this.greenPerturbationStrength,this.bluePertStrength2=2*this.bluePerturbationStrength,this.brightnessPertStrength2=2*this.brightnessPerturbationStrength}hardConstraint(e,t,i,r,n=!1){return n?i<r/2&&i>0?e=t+r/2:i>-r/2&&i<0&&(e=t-r/2):i>r/2?e=t+r/2:i<-r/2&&(e=t-r/2),e}keepWithinRange(){if(null==this.referenceColor)return;let e=this.referenceColor.rgbToHsb(),t=this.rgbToHsb(),i=t.h,r=t.s,n=t.b,o=e.h,a=e.s,s=e.b,l=i-o,g=r-a,h=n-s;l>.5?(i-=1,l-=1):l<-.5&&(i+=1,l+=1),i="Attractive"===this.hueConstraintType?this.hardConstraint(i,o,l,this.hueRange,!1):this.hardConstraint(i,o,l,this.hueRange,!0),r="Attractive"===this.saturationConstraintType?this.hardConstraint(r,a,g,this.saturationRange,!1):this.hardConstraint(r,a,g,this.saturationRange,!0),n="Attractive"===this.brightnessConstraintType?this.hardConstraint(n,s,h,this.brightnessRange,!1):this.hardConstraint(n,s,h,this.brightnessRange,!0);let d=this.hsbToRgb(i,r,n);this.r=d.r,this.g=d.g,this.b=d.b}hsbToRgb(e,t,i){let r=0,n=0,o=0;if(0===t)r=n=o=i;else{let a=i<.5?i*(1+t):i+t-i*t,s=2*i-a;r=this.hueToRgb(s,a,e+1/3),n=this.hueToRgb(s,a,e),o=this.hueToRgb(s,a,e-1/3)}return{r:Math.round(255*r),g:Math.round(255*n),b:Math.round(255*o)}}hueToRgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}rgbToHsb(){let e=this.r/255,t=this.g/255,i=this.b/255,r=Math.max(e,t,i),n=Math.min(e,t,i),o=(r+n)/2,a=0;o>0&&o<1&&(a=(r-n)/(1-Math.abs(2*o-1)));let s=0;return r!==n&&(s=r===e?(t-i)/(r-n)+(t<i?6:0):r===t?(i-e)/(r-n)+2:(e-t)/(r-n)+4,s/=6),{h:s,s:a,b:o}}toDict(){return{r:this.r,g:this.g,b:this.b,t:this.t,drift:this.drift,redPerturbationStrength:this.redPerturbationStrength,greenPerturbationStrength:this.greenPerturbationStrength,bluePerturbationStrength:this.bluePerturbationStrength,brightnessPerturbationStrength:this.brightnessPerturbationStrength,referenceColor:this.referenceColor.toDict(),brightnessRange:this.brightnessRange,saturationRange:this.saturationRange,hueRange:this.hueRange}}}function j(){return Math.floor(256*Math.random())}function Y(){return 21*Math.random()}function X(){return 10**(1.5*Math.random()-.5)}function $(e,t,i){let r=t;if("Random"===t.sampleDrift)for(let e of["r","g","b"]){let i=Math.round(2*Math.random()*t.drift-t.drift),n=t[e]+i;n=Math.max(0,Math.min(255,n)),r[e]=n}else if("Linear hue"===t.sampleDrift){let e=t.rgbToHsb();e.h=e.h+.001*t.drift;let i=t.hsbToRgb(e.h,e.s,e.b);t.r=i.r,t.g=i.g,t.b=i.b}else if("Sine brightness"===t.sampleDrift){let i=Math.round(255*(.5+.5*Math.sin(.01*e.time*t.drift+t.phase)));t.r=i,t.g=i,t.b=i}return r.keepWithinRange(),r}function K(e,t,i){let r;if(r="colorDefinitions"in e.config.paletteConfig&&void 0!==e.config.paletteConfig.colorDefinitions[t]?V.fromConfig(e.config.paletteConfig.colorDefinitions[t],e,i):V.fromConfig(e.colorConfigs[t],e,i),i.push(r.name),null===e.colorConfigs[t].referenceColorName)r.referenceColor=null,r.referenceColorName=null;else if("Background color"==e.colorConfigs[t].referenceColorName&&e.colors.length>0)r.referenceColor=e.colors[0],r.referenceColorName="Background color";else if(n=e.colorConfigs[t].referenceColorName,/^Color \d+$/.test(n)){let i=e.colorConfigs[t].referenceColorName.match(/^Color (\d+)$/),n=parseInt(i[1],10);n<e.colors.length&&(r.referenceColor=e.colors[n],r.referenceColorName="Color "+n.toString())}var n;return r}function _(e,t,i,r){let n=K(e,t,i);if("First"===e.config.paletteConfig.colorDependency&&e.colors.length>0)n.referenceColor=e.colors[0],n.referenceColorName="Background color";else if("Second"===e.config.paletteConfig.colorDependency&&e.colors.length>1)n.referenceColor=e.colors[0],n.referenceColorName="Color 1";else if("Previous"===e.config.paletteConfig.colorDependency&&e.colors.length>0)n.referenceColor=e.colors[r-1],n.referenceColorName=r-1==0?"Background color":"Color "+(r-1).toString();else if(/^Color \d+$/.test(e.config.paletteConfig.colorDependency)){let t=e.config.paletteConfig.colorDependency.match(/^Color (\d+)$/),i=parseInt(t[1],10);i<e.colors.length&&(n.referenceColor=e.colors[i],n.referenceColorName=0==i?"Background color":"Color "+i.toString())}return n.keepWithinRange(),n}function J(e){let t;if(null!=e.config.paletteConfig.samplingPalettes){var i=e.config.paletteConfig.name,r=e.config.paletteConfig.samplingPalettes;let t=n(r)();e.config.paletteConfig=JSON.parse(JSON.stringify(e.paletteConfigs[t])),e.config.paletteConfig.sampledName=e.config.paletteConfig.name,e.config.paletteConfig.name=i,e.config.paletteConfig.samplingPalettes=r}if(null==e.config.paletteConfig.nColors){let i=e.config.paletteConfig.colorPattern.length-e.config.paletteConfig.minNColors;t=Math.floor(Math.random()*i)+e.config.paletteConfig.minNColors}else t=e.config.paletteConfig.nColors;e.nColors=t,e.colors=[];let o=0,a=[];for(let i of e.config.paletteConfig.colorPattern){let r=_(e,i,a,o);if(e.colors.push(r),e.colors.length>=t)break;o++}e.nColors=e.colors.length,e.colorCount=new Array(e.nColors).fill(0);let s="Col | Set the color palette according to the preset "+e.config.paletteConfig.name+".";null!=e.config.paletteConfig.sampledName&&(s+=" The color palette "+e.config.paletteConfig.sampledName+" was sampled."),P(e,s)}function Z(e){if("VariableGR"!=e.metaRule)for(var t of e.colors)null!=t.sampleRedPerturbationStrength&&0!=t.sampleRedPerturbationStrength&&(t.redPerturbationStrength=Y()),null!=t.sampleGreenPerturbationStrength&&0!=t.sampleGreenPerturbationStrength&&(t.greenPerturbationStrength=Y()),null!=t.sampleBluePerturbationStrength&&0!=t.sampleBluePerturbationStrength&&(t.bluePerturbationStrength=Y()),null!=t.sampleBrightnessPerturbationStrength&&0!=t.sampleBrightnessPerturbationStrength&&(t.brightnessPerturbationStrength=Y()),t.updateDoubles()}function Q(e){for(var t of e.colors)null!=t.sampleDrift&&0!=t.drift&&(t.drift=X())}function ee(e,t=!1){if(t||e.changeMetaRuleFlag){e.colorCount=new Array(e.nColors).fill(0);var i=e.sanityConfig;if("VariableGR"==e.metaRule);else if("VariableDemo"==e.metaRule)e.config=e.stagingConfigs["Mixed safe"],e.sanityConfig=e.sanityConfigs.Default,e.useLogo=!1;else if("Variable"==e.metaRule)e.config=e.stagingConfigs["Mixed safe"],e.sanityConfig=e.sanityConfigs.Default;else if("VariableMix"==e.metaRule)e.config=e.stagingConfigs.Mixed,e.sanityConfig=e.sanityConfigs.Default;else if("VariableUnsafe"==e.metaRule)e.config=e.stagingConfigs.Mixed,e.sanityConfig=e.sanityConfigs.Default;else if("VariableTest"==e.metaRule)e.config=e.stagingConfigs["Test rule"],e.sanityConfig=e.sanityConfigs.Disabled;else if("VariableTestNoStyle"==e.metaRule)e.config=e.stagingConfigs["Test rule no style"],e.sanityConfig=e.sanityConfigs.Disabled;else if("CustomRule"==e.metaRule){if(e.config=e.stagingConfigs.Custom,e.sanityConfig=e.sanityConfigs.Disabled,e.currentRuleAndStyle){var[r,n]=e.currentRuleAndStyle.split("-");e.config.ruleConfig.rules={[r]:1},n?e.config.styleConfig.style=n:e.config.styleConfig={}}}else"GRMouse"==e.metaRule&&(e.config=e.stagingConfigs.GRMouse,e.sanityConfig=e.sanityConfigs.Default);e.sanityConfig=i,e.resampleRuleClass(),e.ruleLogSwitchProbability=-25,e.styleLogEvolveProbability=-25,e.changeMetaRuleFlag=!1,e.time=0,te(e),J(e)}if((Math.random()<Math.exp(e.ruleLogSwitchProbability)||e.changeRuleFlag)&&(e.ruleClass.setBaseRule(e),e.ruleClass.setStyleRule(e),e.changeRuleFlag=!1,e.ruleLogSwitchProbability=-25,e.changeBaseRuleFlag=!1,e.styleLogEvolveProbability=-25,e.changeStyleFlag=!1,e.time=0,te(e),Z(e),Q(e)),e.changeBaseRuleFlag&&(e.ruleClass.setBaseRule(e),e.ruleLogSwitchProbability=-25,e.changeBaseRuleFlag=!1,e.time=0,te(e),Z(e),Q(e)),e.changeStyleFlag&&(e.ruleClass.setStyleRule(e),e.styleLogEvolveProbability=-25,e.changeStyleFlag=!1,e.time=0,te(e),Z(e),Q(e)),(Math.random()<Math.exp(e.styleLogEvolveProbability)||e.evolveColoringRuleFlag&&"CustomRule"!=e.metaRule&&!e.config.styleConfig.deterministic)&&(ie(e,e.ruleClass),e.useLogo&&null!=e.ruleClass2&&ie(e,e.ruleClass2),e.styleLogEvolveProbability=-25,e.evolveColoringRuleFlag=!1,e.time=0,te(e),Z(e),Q(e)),e.reloadColorPaletteFlag,(null!=e.config.paletteConfig.samplingPalettes&&Math.random()<Math.exp(e.paletteLogSwitchProbability)||e.reloadColorPaletteFlag)&&(e.paletteLogSwitchProbability=-25,J(e),e.reloadColorPaletteFlag=!1),!e.pauseEvolution){let t=1;e.ruleLogSwitchProbability=e.ruleLogSwitchProbability+e.logMultiplicativeFactor*t,e.ruleLogSwitchProbability>0&&(e.ruleLogSwitchProbability=0),e.styleLogEvolveProbability=e.styleLogEvolveProbability+e.logMultiplicativeEvolveFactor*t,e.styleLogEvolveProbability>0&&(e.styleLogEvolveProbability=0),null!=e.config.paletteConfig.samplingPalettes&&(e.paletteLogSwitchProbability=e.paletteLogSwitchProbability+e.logMultiplicativePaletteFactor*t,e.paletteLogSwitchProbability>0&&(e.paletteLogSwitchProbability=0))}}function te(e){if("undefined"!=typeof document){var t=document.getElementById("currentRuleAndStyle");t&&(e.useLogo&&null!=e.ruleClass2?t.value=e.ruleClass.getName()+"__"+e.ruleClass2.getName():t.value=e.ruleClass.getName())}}function ie(e,t){t.ruleChain[1]&&"function"==typeof t.ruleChain[1].evolveRule&&t.ruleChain[1].evolveRule(e,t.conditionLevels)}function re(e,t,i,r,n){let o=(t+r+e.gridHeight)%e.gridHeight,a=(i+n+e.gridWidth)%e.gridWidth,s=o,l=a;return(o-t-r>0||o-t-r<0)&&(l=(e.gridWidth-a-e.gridPeriodicityShiftX+e.gridWidth)%e.gridWidth),(a-i-n>0||a-i-n<0)&&(s=(e.gridHeight-o-e.gridPeriodicityShiftY+e.gridHeight)%e.gridHeight),[s,l]}function ne(e,t,i,r,n){let o=(t+r+e.gridHeight)%e.gridHeight,a=(i+n+e.gridWidth)%e.gridWidth,s=o,l=a;return(o-t-r>0||o-t-r<0)&&(l=(e.gridWidth-a-e.gridPeriodicityShiftX+e.gridWidth)%e.gridWidth),a-i-n>0?s=(o+e.gridPeriodicityShiftY+e.gridHeight)%e.gridHeight:a-i-n<0&&(s=(o-e.gridPeriodicityShiftY+e.gridHeight)%e.gridHeight),[s,l]}function oe(e,t,i,r,n){let o=(t+r+e.gridHeight)%e.gridHeight,a=(i+n+e.gridWidth)%e.gridWidth,s=o,l=a;return o-t-r>0?l=(a+e.gridPeriodicityShiftX+e.gridWidth)%e.gridWidth:o-t-r<0&&(l=(a-e.gridPeriodicityShiftX+e.gridWidth)%e.gridWidth),(a-i-n>0||a-i-n<0)&&(s=(e.gridHeight-o-e.gridPeriodicityShiftY+e.gridHeight)%e.gridHeight),[s,l]}function ae(e,t,i,r,n){let o=(t+r+e.gridHeight)%e.gridHeight,a=(i+n+e.gridWidth)%e.gridWidth,s=o,l=a;return o-t-r>0?l=(a+e.gridPeriodicityShiftX+e.gridWidth)%e.gridWidth:o-t-r<0&&(l=(a-e.gridPeriodicityShiftX+e.gridWidth)%e.gridWidth),a-i-n>0?s=(o+e.gridPeriodicityShiftY+e.gridHeight)%e.gridHeight:a-i-n<0&&(s=(o-e.gridPeriodicityShiftY+e.gridHeight)%e.gridHeight),[s,l]}function se(e){e.gridFlipX&&e.gridFlipY?e.findNeighbour=re:e.gridFlipX?e.findNeighbour=ne:e.gridFlipY?e.findNeighbour=oe:e.findNeighbour=ae}function le(e,t,i){return(e*(i-1)+t)/i}function ge(e,t=!1){(e.time%200==0||t)&&(isNaN(e.brightness)&&(e.brightness=127,e.maxBrightness=130,e.minBrightness=124),isNaN(e.maxBrightness)&&(e.maxBrightness=130),isNaN(e.minBrightness)&&(e.minBrightness=124))}function he(e){let t=e.imageData;for(var i=0,r=0,n=0,o=e.colors.length,a=new Array(o).fill(0),s=0;s<e.imageHeight;s++)for(var l=0;l<e.imageWidth;l++){var g=Math.floor(e.grid.get(s%e.gridHeight,l%e.gridWidth)/e.ruleClass.colorUnit)%o;if(a[g]+=1,0==e.redraw.get(s%e.gridHeight,l%e.gridWidth))continue;i+=1;let h=e.colors[g],d=4*(s*e.imageWidth+l);r+=Math.sqrt((t[d+0]-h.r)**2+(t[d+1]-h.g)**2+(t[d+2]-h.b)**2),n+=h.r+h.g+h.b;const c=Math.round(Math.random()*h.redPertStrength2-h.redPerturbationStrength),u=Math.round(Math.random()*h.greenPertStrength2-h.greenPerturbationStrength),m=Math.round(Math.random()*h.bluePertStrength2-h.bluePerturbationStrength),f=Math.round(Math.random()*h.brightnessPertStrength2-h.brightnessPerturbationStrength);t[d+0]=h.r+c+f,t[d+1]=h.g+u+f,t[d+2]=h.b+m+f,t[d+3]=h.t}!function(e,t,i,r,n){var o=e.gridHeight*e.gridWidth;e.activityLevel=le(e.activityLevel,t/o,e.sanityConfig.activityLevelWindowSize),e.activityLevelForRule=le(e.activityLevel,t/o,e.config.ruleConfig.activityLevelForRuleWindowSize),e.nCellChangedHistoric=le(e.nCellChangedHistoric,t,e.sanityConfig.activityLevelWindowSize),e.meanColorChangeHistoric=le(e.meanColorChangeHistoric,i/(t+o/30),e.sanityConfig.activityLevelWindowSize),0==t?r=127:r/=3*t,e.brightness=le(e.brightness,r,e.sanityConfig.flickerIndexWindowSize);var a=(e.sanityConfig.flickerIndexWindowSize-1)/e.sanityConfig.flickerIndexWindowSize;e.maxBrightness=a*(e.maxBrightness-e.brightness)+e.brightness,e.maxBrightness=Math.min(255,e.maxBrightness),e.minBrightness=a*(e.minBrightness-e.brightness)+e.brightness,e.minBrightness=Math.max(0,e.minBrightness),e.relCellChanged=t/o,e.diffBrightness=e.maxBrightness-e.minBrightness,e.flickerIndex=le(e.flickerIndex,e.diffBrightness*e.relCellChanged,e.sanityConfig.flickerIndexWindowSize),e.maxBrightness<r?e.maxBrightness+=3:e.minBrightness>r&&(e.minBrightness-=3);for(var s=0;s<e.colorCount.length;s++)e.colorCount[s]=le(e.colorCount[s],n[s]/o,100)}(e,i,r,n,a),ge(e),e.imageData=t}function de(e,t,i){var r=function(e){var t=Math.exp(-e),i=1,r=0;do{r++,i*=Math.random()}while(i>t);return r-1}(10**(e.randomnessAmount+e.config.randomnessConfig.randomnessLogShift));if(0!=r)for(var n=e.seedSampler,o=e.config.randomnessConfig.seedMasks,a=0;a<r;a++){var s=Math.floor(Math.random()*e.gridHeight),l=Math.floor(Math.random()*e.gridWidth),g=n(),h=o[g],d=!0;null===h&&(h=ue(e,g),d=!1),ce(t,e,h,s,l,i,d)}}function ce(e,t,i,n,o,a,s){i instanceof r||(i=r.fromArray(i)),s&&(Math.random()<.25&&i.transpose(),Math.random()<.5&&i.flipX(),Math.random()<.75&&i.flipY());let l=i.height,g=i.width;for(let r=0;r<l;r++)for(let s=0;s<g;s++){let h=a(t,n,o,r-Math.floor(l/2),s-Math.floor(g/2));e.set(h[0],h[1],i.get(r,s))}}function ue(e,t){let[i,n]=function(e){let t=Math.floor(Math.random()*e.config.randomnessConfig.maxSeedSize)+1,i=t;Math.random()>e.config.randomnessConfig.squareVsRectangularMaskProbability&&(i=Math.floor(Math.random()*e.config.randomnessConfig.maxSeedSize)+1);return[t,i]}(e);return function(e,t,i){return"Random"==i?function(e,t){let i=new r(t,e);for(let r=0;r<e;r++)for(let e=0;e<t;e++)i.set(r,e,Math.floor(1e5*Math.random()));return i}(e,t):"Random p2h"==i?function(e,t){let i=new r(t,e);for(let r=0;r<Math.ceil(e/2);r++)for(let n=0;n<t;n++)i.set(r,n,Math.floor(1e5*Math.random())),i.set(e-1-r,n,i.get(r,n));return i}(e,t):"Random p2v"==i?function(e,t){let i=new r(t,e);for(let r=0;r<e;r++)for(let e=0;e<Math.ceil(t/2);e++)i.set(r,e,Math.floor(1e5*Math.random())),i.set(r,t-1-e,i.get(r,e));return i}(e,t):"Random d2a"==i?function(e){let t=new r(e,e);for(let i=0;i<e;i++)for(let r=i;r<e;r++)t.set(i,r,Math.floor(1e5*Math.random())),t.set(r,i,t.get(i,r));return t}(e):"Random d2b"==i?function(e){let t=new r(e,e);for(let i=0;i<e;i++)for(let r=i;r<e;r++)t.set(i,r,Math.floor(1e5*Math.random())),t.set(e-1-r,e-1-i,t.get(i,r));return t}(e):"Random g2"==i?function(e,t){let i=new r(t,e);for(let r=0;r<e;r++)for(let n=0;n<Math.ceil(t/2);n++)i.set(r,n,Math.floor(1e5*Math.random())),i.set(e-1-r,t-1-n,i.get(r,n));return i}(e,t):"Random p4"==i?function(e,t){let i=new r(t,e);for(let r=0;r<Math.ceil(e/2);r++)for(let n=0;n<Math.ceil(t/2);n++)i.set(r,n,Math.floor(1e5*Math.random())),i.set(e-1-r,n,i.get(r,n)),i.set(r,t-1-n,i.get(r,n)),i.set(e-1-r,t-1-n,i.get(r,n));return i}(e,t):"Random d4"==i?function(e){let t=new r(e,e);for(let i=0;i<e;i++)for(let r=Math.max(i,e-i);r<e;r++)t.set(i,r,Math.floor(1e5*Math.random())),t.set(r,i,t.get(i,r)),t.set(e-1-r,e-1-i,t.get(i,r)),t.set(e-1-i,e-1-r,t.get(i,r));return t}(e):"Random g4"==i?function(e){let t=new r(e,e);for(let i=0;i<Math.ceil(e/2);i++)for(let r=0;r<Math.ceil(e/2);r++)t.set(i,r,Math.floor(1e5*Math.random())),t.set(r,e-1-i,t.get(i,r)),t.set(e-1-i,e-1-r,t.get(i,r)),t.set(e-1-r,i,t.get(i,r));return t}(e):function(e){let t=new r(e,e);for(let i=0;i<Math.ceil(e/2);i++)for(let r=0;r<Math.ceil(e/2);r++)t.set(i,r,Math.floor(1e5*Math.random())),t.set(r,e-1-i,t.get(i,r)),t.set(e-1-i,e-1-r,t.get(i,r)),t.set(e-1-r,i,t.get(i,r)),t.set(e-1-i,r,t.get(i,r)),t.set(e-1-r,e-1-i,t.get(i,r)),t.set(i,e-1-r,t.get(i,r)),t.set(r,i,t.get(i,r));return t}(e)}(i,n,t)}function me(e){const t=e.ruleClass.ruleChain[0].nStates;var i=0;e.ruleClass.ruleChain.length>1&&(i=e.ruleClass.ruleChain[1].nStates);var n=o*t,s=o*i,l=Math.floor(o/2),g=[new Uint8Array(n),new Uint8Array(s)],h=new Uint8Array(l),d=new r(e.gridWidth,e.gridHeight),c=e.grid;const u=e.time;for(var m=0,f=e.activityLevelForRule*e.ruleRegularisationSeed/e.birth3,p=0;p<e.gridHeight;p++)for(var C=0;C<e.gridWidth;C++){var b=a(e,p,C,c,g,h,u,t,i);const r=e.grid.get(p,C);var y=r;y=e.useLogo&&0!=e.mask.get(p,C)?e.ruleClass2.updateRule(r,y,b,e.time,f):e.ruleClass.updateRule(r,y,b,e.time,f),Math.floor(y/e.ruleClass.colorUnit)%e.nColors!=Math.floor(r/e.ruleClass.colorUnit)%e.nColors?e.redraw.set(p,C,1):e.redraw.set(p,C,0),d.set(p,C,y),g[0]=g[0].fill(0),g[1]=g[1].fill(0),h=h.fill(0),y%t==1&&m++}!function(e,t){t.activeCells=le(t.activeCells,e,t.sanityConfig.activityLevelWindowSize)}(m/(e.gridHeight*e.gridWidth),e),e.addRandomness&&de(e,d,e.findNeighbour),e.grid=d}function fe(e){e.sanityConfig.enabled&&(function(e){e.time>e.sanityConfig.gracePeriod&&(e.meanColorChangeHistoric>e.sanityConfig.maxColorChange||e.relCellChanged>e.sanityConfig.maxPropOfCellsChanged||e.flickerIndex>e.sanityConfig.maxFlickerIndex)&&(e.changeRuleFlag=!0,e.meanColorChangeHistoric>e.sanityConfig.maxColorChange?P(e,"San | Rule and style change triggered by the sanity checks: the color index change ("+e.meanColorChangeHistoric.toFixed(0)+") exceeded the limit of "+e.sanityConfig.maxColorChange.toFixed(0)+"."):e.relCellChanged>e.sanityConfig.maxPropOfCellsChanged?P(e,"San | Rule and style change triggered by the sanity checks: the proportion of cells changed ("+e.relCellChanged.toFixed(2)+") exceeded the limit of "+e.sanityConfig.maxPropOfCellsChanged.toFixed(2)+"."):P(e,"San | Rule and style change triggered by the sanity checks: the flicker index ("+e.flickerIndex.toFixed(1)+") exceeded the limit of "+e.sanityConfig.maxFlickerIndex.toFixed(1)+"."),ge(e,!0),e.nCellChangedHistoric=15,e.meanColorChangeHistoric=10,e.brightness=127,e.maxBrightness=130,e.minBrightness=124,e.flickerIndex=0)}(e),function(e){e.nCellChangedHistoric<e.sanityConfig.minNumberOfCellsChanged&&(e.changeRuleFlag=!0,P(e,"San | Rule and style change triggered by the sanity checks: the number of cells recolored ("+e.nCellChangedHistoric.toFixed(0)+") was below the threshold of "+e.sanityConfig.minNumberOfCellsChanged.toFixed(0)+"."),ge(e,!0),e.nCellChangedHistoric=20)}(e),function(e){const t=e.colorCount.slice(1).some((t=>t>e.sanityConfig.maxPropOfPlainColor));e.time>e.sanityConfig.gracePeriod&&t&&(e.changeRuleFlag=!0,P(e,"San | Rule and style change triggered by the sanity checks: a foreground color exceeded the threshold of "+e.sanityConfig.maxPropOfPlainColor.toFixed(3)+"% of the canvas."),ge(e,!0),e.colorCount=new Array(e.nColors).fill(0))}(e))}function pe(e){return console.log("Loading image:",e),new Promise(((t,r)=>{const n=function(){if("undefined"!=typeof window)return new window.Image;try{const{Image:e}=i(Object(function(){var e=new Error("Cannot find module 'canvas'");throw e.code="MODULE_NOT_FOUND",e}()));return new e}catch(e){throw console.error('The canvas module is not installed. Please run "npm install canvas" to install it.'),e}}();n.onload=()=>{console.log("Image loaded:",e);const r=function(e,t){if("undefined"!=typeof window){const i=document.createElement("canvas");return i.width=e,i.height=t,i}try{const{createCanvas:r}=i(Object(function(){var e=new Error("Cannot find module 'canvas'");throw e.code="MODULE_NOT_FOUND",e}()));return r(e,t)}catch(e){throw console.error('The canvas module is not installed. Please run "npm install canvas" to install it.'),e}}(n.width,n.height),o=r.getContext("2d");o.drawImage(n,0,0,n.width,n.height);const a=o.getImageData(0,0,r.width,r.height).data,s=[];for(let e=0;e<n.height;e++){const t=[];for(let i=0;i<n.width;i++){const r=4*(e*n.width+i),o=(a[r]+a[r+1]+a[r+2])/3;t.push(o>128?1:0)}s.push(t)}t(s)},n.onerror=()=>{console.error("Error loading image:",e),r(new Error("Error loading image"))},n.src=e}))}async function Ce(e,t){if(null!=e.logo&&await function(e){return console.log("Attempting to load image"),pe(e.logo).then((t=>{new r(e.gridWidth,e.gridHeight);const i=new r(e.gridWidth,e.gridHeight),n=t[0].length/e.gridWidth,o=t.length/e.gridHeight,a=Math.max(n,o),s=Math.floor((e.gridWidth-t[0].length/a)/2),l=Math.floor((e.gridHeight-t.length/a)/2);for(let r=0;r<e.gridHeight;r++)for(let n=0;n<e.gridWidth;n++){if(r<l||(r-l)*a>=t.length){i.set(r,n,1);continue}let e=Math.floor((n-s)*a);0===t[Math.floor((r-l)*a)][e]?i.set(r,n,0):i.set(r,n,1)}e.mask=i})).catch((t=>{console.log("Image loading failed, not using a mask."),console.error("Error loading image:",t),e.mask=new r(e.gridWidth,e.gridHeight)}))}(e),"zero"!=e.initialisation)return function(e,t=1e4){return Promise.resolve().then((()=>{e.grid=new r(e.gridWidth,e.gridHeight),e.redraw=new r(e.gridWidth,e.gridHeight);for(var i=0;i<e.gridHeight;i++)for(var n=0;n<e.gridWidth;n++)if("gr"!=e.initialisation||1!==e.mask.get(i,n)){for(var o=Math.random(),a=0;a<t;a++)if(o<(a+1)/(t+1)){e.grid.set(i,n,a);break}e.redraw.set(i,n,1)}else e.grid.set(i,n,0)}))}(e);e.grid=new r(e.gridWidth,e.gridHeight),e.redraw=new r(e.gridWidth,e.gridHeight)}var be={signature:"GIF",version:"89a",trailer:59,extensionIntroducer:33,applicationExtensionLabel:255,graphicControlExtensionLabel:249,imageSeparator:44,signatureSize:3,versionSize:3,globalColorTableFlagMask:128,colorResolutionMask:112,sortFlagMask:8,globalColorTableSizeMask:7,applicationIdentifierSize:8,applicationAuthCodeSize:3,disposalMethodMask:28,userInputFlagMask:2,transparentColorFlagMask:1,localColorTableFlagMask:128,interlaceFlagMask:64,idSortFlagMask:32,localColorTableSizeMask:7};function ye(e=256){let t=0,i=new Uint8Array(e);return{get buffer(){return i.buffer},reset(){t=0},bytesView:()=>i.subarray(0,t),bytes:()=>i.slice(0,t),writeByte(e){r(t+1),i[t]=e,t++},writeBytes(e,n=0,o=e.length){r(t+o);for(let r=0;r<o;r++)i[t++]=e[r+n]},writeBytesView(e,n=0,o=e.byteLength){r(t+o),i.set(e.subarray(n,n+o),t),t+=o}};function r(e){var r=i.length;if(r>=e)return;e=Math.max(e,r*(r<1048576?2:1.125)>>>0),0!=r&&(e=Math.max(e,256));let n=i;i=new Uint8Array(e),t>0&&i.set(n.subarray(0,t),0)}}var Se=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];var Be=function(e,t,i,r,n=ye(512),o=new Uint8Array(256),a=new Int32Array(5003),s=new Int32Array(5003)){let l=a.length,g=Math.max(2,r);o.fill(0),s.fill(0),a.fill(-1);let h=0,d=0,c=g+1,u=c,m=!1,f=u,p=(1<<f)-1,C=1<<c-1,b=C+1,y=C+2,S=0,B=i[0],R=0;for(let e=l;e<65536;e*=2)++R;R=8-R,n.writeByte(g),G(C);let w=i.length;for(let e=1;e<w;e++)e:{let t=i[e],r=(t<<12)+B,n=t<<R^B;if(a[n]===r){B=s[n];break e}let o=0===n?1:l-n;for(;a[n]>=0;)if(n-=o,n<0&&(n+=l),a[n]===r){B=s[n];break e}G(B),B=t,y<4096?(s[n]=y++,a[n]=r):(a.fill(-1),y=C+2,m=!0,G(C))}return G(B),G(b),n.writeByte(0),n.bytesView();function G(e){for(h&=Se[d],d>0?h|=e<<d:h=e,d+=f;d>=8;)o[S++]=255&h,S>=254&&(n.writeByte(S),n.writeBytesView(o,0,S),S=0),h>>=8,d-=8;if((y>p||m)&&(m?(f=u,p=(1<<f)-1,m=!1):(++f,p=12===f?1<<f:(1<<f)-1)),e==b){for(;d>0;)o[S++]=255&h,S>=254&&(n.writeByte(S),n.writeBytesView(o,0,S),S=0),h>>=8,d-=8;S>0&&(n.writeByte(S),n.writeBytesView(o,0,S),S=0)}}};function Re(e,t,i){return e<<8&63488|t<<2&992|i>>3}function we(e,t,i,r){return e>>4|240&t|(240&i)<<4|(240&r)<<8}function Ge(e,t,i){return e>>4<<8|240&t|i>>4}function Ie(e,t,i){return e<t?t:e>i?i:e}function ve(e){return e*e}function Me(e,t,i){var r=0,n=1e100;let o=e[t],a=o.cnt,s=o.ac,l=o.rc,g=o.gc,h=o.bc;for(var d=o.fw;0!=d;d=e[d].fw){let t=e[d],o=t.cnt,u=a*o/(a+o);if(!(u>=n)){var c=0;i&&(c+=u*ve(t.ac-s))>=n||!((c+=u*ve(t.rc-l))>=n)&&(!((c+=u*ve(t.gc-g))>=n)&&(!((c+=u*ve(t.bc-h))>=n)&&(n=c,r=d)))}}o.err=n,o.nn=r}function Pe(e,t,i={}){let{format:r="rgb565",clearAlpha:n=!0,clearAlphaColor:o=0,clearAlphaThreshold:a=0,oneBitAlpha:s=!1}=i;if(!e||!e.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");let l=new Uint32Array(e.buffer),g=!1!==i.useSqrt,h="rgba4444"===r,d=function(e,t){let i=new Array("rgb444"===t?4096:65536),r=e.length;if("rgba4444"===t)for(let t=0;t<r;++t){let r=e[t],n=r>>24&255,o=r>>16&255,a=r>>8&255,s=255&r,l=we(s,a,o,n),g=l in i?i[l]:i[l]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};g.rc+=s,g.gc+=a,g.bc+=o,g.ac+=n,g.cnt++}else if("rgb444"===t)for(let t=0;t<r;++t){let r=e[t],n=r>>16&255,o=r>>8&255,a=255&r,s=Ge(a,o,n),l=s in i?i[s]:i[s]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};l.rc+=a,l.gc+=o,l.bc+=n,l.cnt++}else for(let t=0;t<r;++t){let r=e[t],n=r>>16&255,o=r>>8&255,a=255&r,s=Re(a,o,n),l=s in i?i[s]:i[s]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};l.rc+=a,l.gc+=o,l.bc+=n,l.cnt++}return i}(l,r),c=d.length,u=c-1,m=new Uint32Array(c+1);for(var f=0,p=0;p<c;++p){let e=d[p];if(null!=e){var C=1/e.cnt;h&&(e.ac*=C),e.rc*=C,e.gc*=C,e.bc*=C,d[f++]=e}}ve(t)/f<.022&&(g=!1);for(p=0;p<f-1;++p)d[p].fw=p+1,d[p+1].bk=p,g&&(d[p].cnt=Math.sqrt(d[p].cnt));var b,y,S;for(g&&(d[p].cnt=Math.sqrt(d[p].cnt)),p=0;p<f;++p){Me(d,p,!1);var B=d[p].err;for(y=++m[0];y>1&&!(d[b=m[S=y>>1]].err<=B);y=S)m[y]=b;m[y]=p}var R=f-t;for(p=0;p<R;){for(var w;;){var G=m[1];if((w=d[G]).tm>=w.mtm&&d[w.nn].mtm<=w.tm)break;w.mtm==u?G=m[1]=m[m[0]--]:(Me(d,G,!1),w.tm=p);B=d[G].err;for(y=1;(S=y+y)<=m[0]&&(S<m[0]&&d[m[S]].err>d[m[S+1]].err&&S++,!(B<=d[b=m[S]].err));y=S)m[y]=b;m[y]=G}var I=d[w.nn],v=w.cnt,M=I.cnt;C=1/(v+M);h&&(w.ac=C*(v*w.ac+M*I.ac)),w.rc=C*(v*w.rc+M*I.rc),w.gc=C*(v*w.gc+M*I.gc),w.bc=C*(v*w.bc+M*I.bc),w.cnt+=I.cnt,w.mtm=++p,d[I.bk].fw=I.fw,d[I.fw].bk=I.bk,I.mtm=u}let P=[];var A=0;for(p=0;;++A){let e=Ie(Math.round(d[p].rc),0,255),t=Ie(Math.round(d[p].gc),0,255),i=Ie(Math.round(d[p].bc),0,255),r=255;if(h){if(r=Ie(Math.round(d[p].ac),0,255),s){r=r<=("number"==typeof s?s:127)?0:255}n&&r<=a&&(e=t=i=o,r=0)}let l=h?[e,t,i,r]:[e,t,i];if(Ae(P,l)||P.push(l),0==(p=d[p].fw))break}return P}function Ae(e,t){for(let i=0;i<e.length;i++){let r=e[i],n=r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2],o=!(r.length>=4&&t.length>=4)||r[3]===t[3];if(n&&o)return!0}return!1}function ke(e,t,i,r,n){let o=0,a=1e100;for(let s=0;s<n.length;s++){let l=n[s],g=xe(l[3]-r);g>a||(g+=xe(l[0]-e),g>a||(g+=xe(l[1]-t),g>a||(g+=xe(l[2]-i),!(g>a)&&(a=g,o=s))))}return o}function Ne(e,t,i,r){let n=0,o=1e100;for(let a=0;a<r.length;a++){let s=r[a],l=xe(s[0]-e);l>o||(l+=xe(s[1]-t),l>o||(l+=xe(s[2]-i),!(l>o)&&(o=l,n=a)))}return n}function xe(e){return e*e}function Fe(e={}){let{initialCapacity:t=4096,auto:i=!0}=e,r=ye(t),n=new Uint8Array(256),o=new Int32Array(5003),a=new Int32Array(5003),s=!1;return{reset(){r.reset(),s=!1},finish(){r.writeByte(be.trailer)},bytes:()=>r.bytes(),bytesView:()=>r.bytesView(),get buffer(){return r.buffer},get stream(){return r},writeHeader:l,writeFrame(e,t,g,h={}){let{transparent:d=!1,transparentIndex:c=0,delay:u=0,palette:m=null,repeat:f=0,colorDepth:p=8,dispose:C=-1}=h,b=!1;if(i?s||(b=!0,l(),s=!0):b=Boolean(h.first),t=Math.max(0,Math.floor(t)),g=Math.max(0,Math.floor(g)),b){if(!m)throw new Error("First frame must include a { palette } option");(function(e,t,i,r,n=8){let o=1,a=0,s=He(r.length)-1,l=o<<7|n-1<<4|a<<3|s,g=0,h=0;Te(e,t),Te(e,i),e.writeBytes([l,g,h])})(r,t,g,m,p),Le(r,m),f>=0&&function(e,t){e.writeByte(33),e.writeByte(255),e.writeByte(11),We(e,"NETSCAPE2.0"),e.writeByte(3),e.writeByte(1),Te(e,t),e.writeByte(0)}(r,f)}let y=Math.round(u/10);!function(e,t,i,r,n){var o,a;e.writeByte(33),e.writeByte(249),e.writeByte(4),n<0&&(n=0,r=!1),r?(o=1,a=2):(o=0,a=0),t>=0&&(a=7&t),a<<=2;let s=0;e.writeByte(a|s|o),Te(e,i),e.writeByte(n||0),e.writeByte(0)}(r,C,y,d,c);let S=Boolean(m)&&!b;(function(e,t,i,r){if(e.writeByte(44),Te(e,0),Te(e,0),Te(e,t),Te(e,i),r){let t=0,i=0,n=He(r.length)-1;e.writeByte(128|t|i|n)}else e.writeByte(0)})(r,t,g,S?m:null),S&&Le(r,m),function(e,t,i,r,n=8,o,a,s){Be(i,r,t,n,e,o,a,s)}(r,e,t,g,p,n,o,a)}};function l(){We(r,"GIF89a")}}function Le(e,t){let i=1<<He(t.length);for(let r=0;r<i;r++){let i=[0,0,0];r<t.length&&(i=t[r]),e.writeByte(i[0]),e.writeByte(i[1]),e.writeByte(i[2])}}function Te(e,t){e.writeByte(255&t),e.writeByte(t>>8&255)}function We(e,t){for(var i=0;i<t.length;i++)e.writeByte(t.charCodeAt(i))}function He(e){return Math.max(Math.ceil(Math.log2(e)),1)}function Oe(e){if(e.startRecordingGifFlag){P(e,"Gif | Starting the GIF recording...");const{data:t,width:i,height:r}=e.ctx.getImageData(0,0,3*e.gridWidth,3*e.gridHeight);e.gifPalette=Pe(t,16),e.gif=Fe(),e.recordingGif=!0,e.startRecordingGifFlag=!1}if(e.stopRecordingGifFlag){e.gif.finish(),e.gifOutput=e.gif.bytes();const n=new Blob([e.gifOutput],{type:"image/gif"}),o=URL.createObjectURL(n);if("Download"==e.gifMode){const e=document.createElement("a");e.href=o,e.download="output.gif",document.body.appendChild(e),e.click(),document.body.removeChild(e)}else"InAppWebView"==e.gifMode&&(t=n,i=function(e){window.flutter_inappwebview.callHandler("saveGif",e)},(r=new FileReader).onload=function(e){i(e.target.result)},r.readAsDataURL(t));e.recordingGif=!1,e.stopRecordingGifFlag=!1,e.nRecordedFrames=0,P(e,"Gif | Stopped the GIF recording.")}var t,i,r;if(e.recordingGif){const{data:t,width:i,height:r}=e.ctx.getImageData(0,0,e.gridWidth,e.gridHeight),n=function(e,t,i="rgb565"){if(!e||!e.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");if(t.length>256)throw new Error("applyPalette() only works with 256 colors or less");let r=new Uint32Array(e.buffer),n=r.length,o="rgb444"===i?4096:65536,a=new Uint8Array(n),s=new Array(o);if("rgba4444"===i)for(let e=0;e<n;e++){let i=r[e],n=i>>24&255,o=i>>16&255,l=i>>8&255,g=255&i,h=we(g,l,o,n),d=h in s?s[h]:s[h]=ke(g,l,o,n,t);a[e]=d}else{let e="rgb444"===i?Ge:Re;for(let i=0;i<n;i++){let n=r[i],o=n>>16&255,l=n>>8&255,g=255&n,h=e(g,l,o),d=h in s?s[h]:s[h]=Ne(g,l,o,t);a[i]=d}}return a}(t,e.gifPalette),o=e.gifPalette;e.gif.writeFrame(n,i,r,{palette:o,delay:e.targetCycleTime}),e.nRecordedFrames=e.nRecordedFrames+1,e.nRecordedFrames>1e3&&(e.stopRecordingGifFlag=!0,e.paused=!0,P(e,"Gif | The GIF recording recording reached 1000 frames, stopping."))}}var Ee=166320;function De(e,t=null){const i=performance.now();e.paused?(e.step&&(ze(e,t),e.step=!1),e.recordingGif&&Oe(e)):ze(e,t);const n=performance.now();e.frameExecutionTime=n-i,e.reinitialiseGridFlag&&(Ce(e),e.reinitialiseGridFlag=!1),e.changeGridSizeFlag&&(e.gridHeight=e.tempGridHeight,e.gridWidth=e.tempGridWidth,e.imageData=new Uint8ClampedArray(4*e.gridWidth*e.gridHeight),e.redraw=new r(e.gridWidth,e.gridHeight),e.canvas=document.getElementById("gameCanvas"),e.canvas.width=e.gridWidth,e.canvas.height=e.gridHeight,e.ctx=e.canvas.getContext("2d",{willReadFrequently:!0}),Ce(e),e.changeGridSizeFlag=!1),setTimeout((function(){requestAnimationFrame((()=>De(e,t)))}),Math.max(0,e.targetCycleTime-e.frameExecutionTime))}function ze(e,t){he(e),null!=t&&t(e),fe(e),me(e),ee(e),Oe(e),e.time=(e.time+1)%Ee,e.randomisePeriodicityShiftAndTopology&&function(e){Math.random()<1e-4&&(e.gridPeriodicityShiftX=Math.floor(Math.random()*e.gridWidth),P(e,"Top | Monodromy along the vertical axis set to "+e.gridPeriodicityShiftX+" cells.")),Math.random()<1e-4&&(e.gridPeriodicityShiftY=Math.floor(Math.random()*e.gridHeight),P(e,"Top | Monodromy along the horizontal axis set to "+e.gridPeriodicityShiftY+" cells.")),Math.random()<1e-4&&(e.gridFlipX=!e.gridFlipX,se(e),e.gridFlipX?e.gridFlipY?P(e,"Top | Twisting the topology along the vertical axis. The cellular world is now a projective plane."):P(e,"Top | Twisting the topology along the vertical axis. The cellular world is now a Klein bottle."):e.gridFlipY?P(e,"Top | Untwisting the topology along the vertical axis. The cellular world is now a Klein bottle."):P(e,"Top | Untwisting the topology along the vertical axis. The cellular world is now a torus.")),Math.random()<1e-4&&(e.gridFlipY=!e.gridFlipY,se(e),e.gridFlipY?e.gridFlipX?P(e,"Top | Twisting the topology along the horizontal axis. The cellular world is now a projective plane."):P(e,"Top | Twisting the topology along the horizontal axis. The cellular world is now a Klein Bottle."):e.gridFlipX?P(e,"Top | Untwisting the topology along the horizontal axis. The cellular world is now a Klein Bottle."):P(e,"Top | Untwisting the topology along the horizontal axis. The cellular world is now a torus."))}(e),function(e){for(var t=0;t<e.colors.length;t++){var i=e.colors[t];i.drift>0&&(e.colors[t]=$(e,i))}}(e)}function Ue(e){let t=new ImageData(e.imageData,e.imageWidth,e.imageHeight);e.ctx.putImageData(t,e.canvasCornerX,e.canvasCornerY)}function qe(e,t,i){return{probabilities:{0:e,1:t},weight:i}}const Ve={Mixed:[qe(1,0,3),qe(.8,.2,3),qe(.5,.5,2),qe(0,1,2)],Static:[qe(1,0,1)],"Almost static":[qe(.8,.2,1)],Dynamic:[qe(.5,.5,1)],"Fully dynamic":[qe(0,1,1)]};function je(e,t=2){return 1==t?Array(e).fill("{E|B}{1|2|3|4}{A|N|C}[0|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1|2|3|4|5}]").join("||"):2==t?Array(e).fill("{E|B}{2|3|4}{A|N|C}[0|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1|2|3|4|5}]").join("||"):3==t?Array(e).fill("{E|B}{3|4}{A|N|C}[0|{0|1|2|3|4|5|6|7|8|9|10|11|12|13|14}:{0|1|2|3|4|5}]").join("||"):void 0}const Ye={Test:{name:"Test",showInApp:!1,nConditions:null,conditionLevels:Ve.Static,conditionLevelsName:"Static",neighbourhoodGeometryType:null,periodicityLength:1,deterministic:!1},TestFixedStyle:{name:"TestFixStyle",showInApp:!1,style:"E2C[1|0:0]1||E8N[1|0:0]1",deterministic:!0},Mixed:{name:"Mixed",nConditions:null,conditionLevels:Ve.Mixed,conditionLevelsName:"Mixed",neighbourhoodGeometryType:null,periodicityLength:1,deterministic:!1},"Mixed static":{name:"Mixed static",nConditions:null,conditionLevels:Ve.Static,conditionLevelsName:"Static",neighbourhoodGeometryType:null,periodicityLength:1,deterministic:!1},"Mixed almost static":{name:"Mixed almost static",nConditions:null,conditionLevels:Ve["Almost static"],conditionLevelsName:"Almost static",neighbourhoodGeometryType:null,periodicityLength:1,deterministic:!1},"Mixed dynamic":{name:"Mixed dynamic",nConditions:null,conditionLevels:Ve.Dynamic,conditionLevelsName:"Dynamic",neighbourhoodGeometryType:null,periodicityLength:1,deterministic:!1},"Mixed fully dynamic":{name:"Mixed fully dynamic",nConditions:null,conditionLevels:Ve["Fully dynamic"],conditionLevelsName:"Fully dynamic",neighbourhoodGeometryType:null,periodicityLength:1,deterministic:!1},"Mixed with periodicity":{name:"Mixed with periodicity",nConditions:null,conditionLevels:Ve.Mixed,conditionLevelsName:"Mixed",neighbourhoodGeometryType:null,periodicityLength:null,deterministic:!1},"Mixed safe":{name:"Mixed safe",nConditions:null,conditionLevels:Ve.Static,conditionLevelsName:"Static",neighbourhoodGeometryType:null,periodicityLength:1,deterministic:!1},Custom:{name:"Custom",showInApp:!1,style:null},"No style":{name:"No style"},GROuternetI:{name:"GROuternetI",style:"E1C[0|2:1]||E3N[0|4:0]||E4A[0|0:0]",deterministic:!0,showInApp:!1},GROuternetII:{name:"GROuternetII",style:"E5A3[0|3:1|8:2]||E6C[0|0:1]||B3C[0|0:0]||B0C[0|2:2]",deterministic:!0,showInApp:!1},GROuternetIb:{name:"GROuternetIb",style:"E2C[0|2:1]||E1C[0|0:2]||B3A3[0|0:1|0:0]||B2A3[0|0:0]",deterministic:!0,showInApp:!1},GROuternetIIb:{name:"GROuternetIIb",style:"B0C[0|0:1|0:2]||B1A3[0|0:2|0:0]||E3A3[0|0:1|0:2]||E1N[0|0:0]||E4C[0|0:0]",deterministic:!0,showInApp:!1},GROuternetIc:{name:"GROuternetIc",style:"B3A3[0|10:0|2:2]||B3A3[0|11:2]||E4A4[0|11:0|11:2]||E4N[0|11:2|11:1]",deterministic:!0,showInApp:!1},GROuternetIIc:{name:"GROuternetIIc",style:"B1A3[0|10:0|2:2]||B5N[0|0:0|2:2]||E3C[0|0:0|0:1]",deterministic:!0,showInApp:!1},"*Ancient Greece I":{name:"*Ancient Greece I",style:"E1C[0|2:1]||"+je(3),deterministic:!1,nDeterministicConditions:1},"*Bars I":{name:"*Bars I",style:"B1N[0|4:0]||"+je(5),deterministic:!1,nDeterministicConditions:1},"Blinking stained glass I":{name:"Blinking stained glass I",style:"E2C[1|0:0]1||E8N[1|0:0]",deterministic:!0},"Blobs I":{name:"Blobs I",style:"E3C[1|0:9]",deterministic:!0},"Brutalist I":{name:"Brutalist I",style:"E4C[1|0:4|0:8]1||E3C[1|0:9]",deterministic:!0},"*Checkerboard I":{name:"*Checkerboard I",style:"E4A3[1|0:4|0:7]||"+je(5),deterministic:!1,nDeterministicConditions:1},"Checkerboard II":{name:"Checkerboard II",style:"E3A6[0|11:0|13:1]||E3N[0|13:0]||B2N[0|11:2]||E5N[0|11:2]||E2C[0|13:1|11:0]||E4A6[0|13:2|13:0]",deterministic:!0},"Comics I":{name:"Comics I",style:"B3C[0|2:2|2:0]||B3N[0|2:1]||B0A3[0|2:0]||E3C[0|2:0]||B1N[0|2:0|2:2]||E4C[0|2:0]||E1A3[0|2:0|2:1]",deterministic:!0},"*Diagonal I":{name:"*Diagonal I",style:"E4A2[0|4:2|3:0]||"+je(5),deterministic:!1,nDeterministicConditions:1},"Diamonds I":{name:"Diamonds I",style:"E4C[1|0:4|0:8]",deterministic:!0},"Diamonds II":{name:"Diamonds II",style:"E4C[1|0:5|0:7]",deterministic:!0},"*Dots I":{name:"*Dots I",style:"B1C[0|9:0]||"+je(5),deterministic:!1,nDeterministicConditions:1},"*Glyph I":{name:"*Glyph I",style:"B1N[0|4:2|3:0]||"+je(5),deterministic:!1,nDeterministicConditions:1},"*Glyph II":{name:"*Glyph II",style:"E3C[0|7:2|3:1]||"+je(5),deterministic:!1,nDeterministicConditions:1},"Growing checkerboards II":{name:"Growing checkerboards II",style:"B3C[0|2:1]1||B1C[0|0:0]1||B5C[0|0:0]1||E2C[1|0:0]1||E4C[1|1:2|0:7]1||E8N[1|0:0]",deterministic:!0},"Growing checkerboards I":{name:"Growing checkerboards I",style:"B1C[0|0:0]1||B5C[0|0:0]1||E2C[1|0:0]1||E4C[1|1:2|0:7]1||E8N[1|0:0]",deterministic:!0},"Jiggly squares I":{name:"Jiggly squares I",style:"B1A6[1|13:3]||B4N[1|11:2|11:5]||B0A3[0|13:2]||B3C[0|13:1]||B4C[1|11:3|13:1]",deterministic:!0},"*Lines I":{name:"*Lines I",condition:"B0A2[0|0:0|0:2]||"+je(5),deterministic:!1},"Loose labyrinth I":{name:"Loose labyrinth I",style:"E3C[1|0:9]||E4C[1|0:4|0:8]",deterministic:!0},"Loose labyrinth II":{name:"Loose labyrinth II",style:"E3C[1|0:9]||E3C[0|0:0]",deterministic:!0},"Matrix I":{name:"Matrix I",style:"E3C[1|0:9]||E5A2[1|0:7]1||E7A5[1|0:7]1||B6C[1|0:6]1||E4C[1|0:4|0:8]1||E4N[1|0:8|0:0]1||E4A3[1|0:4|0:7]||B1A4[1|0:7|0:6]1||E1C[1|0:7|0:4]1",deterministic:!0},"Morse I":{name:"Morse I",style:"E4A3[1|0:4|0:7]",deterministic:!0},"*Morse II":{name:"*Morse II",style:"B0A3[0|7:1|4:0]||"+je(3,1),deterministic:!1},"*Morse III":{name:"*Morse I",style:"B0A3[0|4:0]||"+je(3,1),deterministic:!1},"*Ragged I":{name:"*Ragged I",style:"E1C[0|0:1|0:2]||B2A3[0|0:1|0:2]"+je(5),deterministic:!1},"*Silouhette I":{name:"*Silouhette I",style:"E1C[0|0:0|0:1]||"+je(5),deterministic:!1},"Sparse blinkers I":{name:"Sparse blinkers I",style:"B4N[1|0:6|0:2]",deterministic:!0},"*Stripes I":{name:"*Stripes I",style:"E1A4[0|3:0]||"+je(5,1),deterministic:!1}},Xe=(Object.keys(Ye).filter((e=>null!=Ye[e].conditionLevels&&0!=Ye[e].showInApp)),Object.keys(Ye).filter((e=>!Ye[e].hasOwnProperty("showInApp")||!Ye[e].showInApp)),{Mixed:{name:"Mixed",recommended:!0,samplingPalettes:{"Cartoon Cacophony":7,"Chaotic Carnival":4,"Primary Pop":1,"Secondary Seizure":1,"Cloudy Canvas":1,"Discordant Disco":2,"Black Blanc":4,"Foggy Fluctuations":1,"Oscillating Overcast":1,"Rainbow Rampage":1,"Saturated Satire":1,"Homogenous Hues":3,"Black + Homogenous Hues":3,"Alternating Altercation":1,"Tint Train":1,"Grim Grisaille":1}},"Cartoon Cacophony":{name:"Cartoon Cacophony",recommended:!0,colorPattern:["Textured black","Textured white","Random color","Random color","Random color","Random color","Random color"],minNColors:3},"Chaotic Carnival":{name:"Chaotic Carnival",recommended:!0,colorPattern:["Random color","Random color","Random color","Random color","Random color","Random color","Random color"],minNColors:2},"Primary Pop":{name:"Primary Pop",colorPattern:["Black","Basic color","Basic color","Basic color","Basic color","Basic color","Basic color"],minNColors:3},"Secondary Seizure":{name:"Secondary Seizure",colorPattern:["Black","Secondary color","Secondary color","Secondary color","Secondary color","Secondary color","Secondary color"],minNColors:3},"Cloudy Canvas":{name:"Cloudy Canvas",colorPattern:["Textured black","Textured white","Random grey","Random grey"],minNColors:4},"Discordant Disco":{name:"Discordant Disco",recommended:!0,colorPattern:["Textured black","Rainbow color","Rainbow color","Rainbow color","Rainbow color","Rainbow color","Rainbow color"],minNColors:2},"Black Blanc":{name:"Black Blanc",recommended:!0,colorPattern:["Textured black","Textured white"],minNColors:2},"Foggy Fluctuations":{name:"Foggy Fluctuations",colorPattern:["Random grey","Random grey","Random grey","Random grey","Random grey","Random grey","Random grey"],minNColors:4},"Shadow Shock":{name:"Shadow Shock",colorPattern:["Random grey","Saturated color","Random grey","Random grey","Saturated color","Random grey","Random grey"],minNColors:4},"Grim Grisaille":{name:"Grim Grisaille",colorPattern:["Grisaille","Hue and saturation constrained color","Hue and saturation constrained color","Hue and saturation constrained color","Hue and saturation constrained color","Hue and saturation constrained color","Hue and saturation constrained color"],colorDependency:"First",minNColors:3},"Oscillating Overcast":{name:"Oscillating Overcast",recommended:!0,colorPattern:["Brightness oscillator","Brightness oscillator","Brightness oscillator","Brightness oscillator","Brightness oscillator","Brightness oscillator","Brightness oscillator"],minNColors:4},"Rainbow Rampage":{name:"Rainbow Rampage",colorPattern:["Rainbow color","Rainbow color","Rainbow color","Rainbow color","Rainbow color","Rainbow color","Rainbow color"],minNColors:4},"Saturated Satire":{name:"Saturated Satire",colorPattern:["Saturated color","Saturated color","Saturated color","Saturated color","Saturated color","Saturated color","Saturated color"],minNColors:4},"Homogenous Hues":{name:"Homogenous Hues",recommended:!0,colorPattern:["Random color","Hue constrained color","Hue constrained color","Hue constrained color","Hue constrained color","Hue constrained color","Hue constrained color"],colorDependency:"First",minNColors:4},"Black + Homogenous Hues":{name:"Black + Homogenous Hues",colorPattern:["Textured black","Random color","Hue constrained color","Hue constrained color","Hue constrained color","Hue constrained color","Hue constrained color"],colorDependency:"Second",minNColors:4},"Alternating Altercation":{name:"Alternating Altercation",colorPattern:["Repulsive brightness color","Repulsive brightness color","Repulsive brightness color","Repulsive brightness color","Repulsive brightness color","Repulsive brightness color","Repulsive brightness color"],colorDependency:"Previous",minNColors:4},"Tint Train":{name:"Tint Train",colorPattern:["Random color","Hue constrained color","Hue constrained color","Hue constrained color","Hue constrained color","Hue constrained color","Hue constrained color"],colorDependency:"Previous",minNColors:4},GR:{name:"GR",hideInApp:!0,colorPattern:["Black","GR blue","GR grey","GR yellow"],minNColors:4},GROuternet:{name:"GROuternet",hideInApp:!0,colorPattern:["Black","GR grey","GR blue","GR yellow"],minNColors:4},GROuternet2:{name:"GROuternet2",hideInApp:!0,colorPattern:["GR grey","Black","GR yellow","GR blue"],minNColors:4},"CGA-4-0":{name:"CGA-4-0",colorPattern:["Black","CGA light green","CGA light red","CGA yellow"],minNColors:4},"CGA-4-1":{name:"CGA-4-1",colorPattern:["Black","White","CGA light cyan","CGA light magenta"],minNColors:4},"CGA-16":{name:"CGA-16",colorPattern:["CGA color","CGA color","CGA color","CGA color","CGA color","CGA color","CGA color","CGA color"],minNColors:4},GRMouse:{name:"GRMouse",hideInApp:!0,colorPattern:["transparent","GR blue","Black","GR yellow"],minNColors:4},Test:{name:"Test",hideInApp:!0,colorPattern:["Rainbow color","Rainbow color","Rainbow color","Rainbow color","Rainbow color","Rainbow color","Rainbow color"],minNColors:2}}),$e=(Object.keys(Xe).filter((e=>null!=Xe[e].samplingPalettes)),Object.keys(Xe).filter((e=>!0===Xe[e].recommended)),Object.keys(Xe).filter((e=>!Xe[e].hideInApp)),2e4),Ke=2e3,_e=5e3,Je=1e4,Ze={Mixed:{name:"Mixed",ruleConfig:E.Mixed,styleConfig:Ye.Mixed,paletteConfig:Xe.Mixed,randomnessConfig:H.Default,timeBetweenRuleChanges:$e,timeBetweenStyleChanges:Ke,timeBetweenPaletteChanges:Je},"Mixed safe":{name:"Mixed safe",ruleConfig:E["Mixed safe"],styleConfig:Ye["Mixed safe"],paletteConfig:Xe.Mixed,randomnessConfig:H.Default,timeBetweenRuleChanges:$e,timeBetweenStyleChanges:Ke,timeBetweenPaletteChanges:Je},Safe:{name:"Safe",ruleConfig:E["BB (modified)"],styleConfig:Ye["Mixed safe"],paletteConfig:Xe.Mixed,randomnessConfig:H.Default,timeBetweenRuleChanges:$e,timeBetweenStyleChanges:Ke,timeBetweenPaletteChanges:Je},"Art deco":{name:"Art deco",ruleConfig:E["Spiky waves"],styleConfig:Ye["Mixed safe"],paletteConfig:Xe["Oscillating Overcast"],randomnessConfig:H.Default,timeBetweenRuleChanges:$e,timeBetweenStyleChanges:Ke},"Classy Classics":{name:"Classy Classics",ruleConfig:E["Classy Classics"],styleConfig:Ye["No style"],paletteConfig:Xe["Primary Pop"],randomnessConfig:H.Default,timeBetweenRuleChanges:_e,timeBetweenStyleChanges:Ke},"Retro Remix":{name:"Retro Remix",ruleConfig:E.Mixed,styleConfig:Ye["No style"],paletteConfig:Xe["Primary Pop"],randomnessConfig:H.Default,timeBetweenRuleChanges:_e,timeBetweenStyleChanges:Ke},GR:{name:"GR",hideInApp:!0,doubelRule:!0,ruleConfig:E["BB (modified)"],styleConfig:Ye["Mixed safe"],styleConfig2:Ye["Mixed safe"],paletteConfig:Xe.GR,randomnessConfig:H.Default,timeBetweenRuleChanges:$e,timeBetweenStyleChanges:Ke},GROuternet:{name:"GROuternet",hideInApp:!0,doubelRule:!0,ruleConfig:E["BB (outernet)"],styleConfig:Ye.GROuternetI,styleConfig2:Ye.GROuternetII,paletteConfig:Xe.GROuternet},GROuternetb:{name:"GROuternetb",hideInApp:!0,doubelRule:!0,ruleConfig:E["BB (outernet)"],styleConfig:Ye.GROuternetIb,styleConfig2:Ye.GROuternetIIb,paletteConfig:Xe.GROuternet2},GROuternetc:{name:"GROuternetc",hideInApp:!0,doubelRule:!0,ruleConfig:E["BB (outernetc)"],styleConfig:Ye.GROuternetIc,styleConfig2:Ye.GROuternetIIc,paletteConfig:Xe.GROuternet2},GRMouse:{name:"GRMouse",hideInApp:!0,ruleConfig:E["BB (modified)"],styleConfig:Ye["Mixed safe"],styleConfig2:Ye["Mixed safe"],paletteConfig:Xe.GRMouse,randomnessConfig:H.Default,timeBetweenRuleChanges:$e,timeBetweenStyleChanges:Ke},"Test rule no style":{name:"Test rule no style",hideInApp:!0,ruleConfig:E.Test,styleConfig:Ye["No style"],paletteConfig:Xe["Cartoon Cacophony"],randomnessConfig:H.Default},"Test rule":{name:"Retro Remix",ruleConfig:E.Millipedes,styleConfig:Ye.Mixed,paletteConfig:Xe.Test,randomnessConfig:H.Default,timeBetweenRuleChanges:_e,timeBetweenStyleChanges:Ke},Custom:{name:"Custom",hideInApp:!0,ruleConfig:E.Custom,styleConfig:Ye.Custom,paletteConfig:Xe["Cartoon cacophony"],randomnessConfig:H.Default}},Qe=(Object.keys(Ze).filter((e=>!Ze[e].hasOwnProperty("hideInApp")||!Ze[e].hideInApp)),{Default:{name:"Default",enabled:!0,gracePeriod:100,maxColorChange:330,maxFlickerIndex:10,maxPropOfCellsChanged:.5,minNumberOfCellsChanged:3,maxPropOfPlainColor:.99,activityLevelWindowSize:50,flickerIndexWindowSize:100},"No flicker":{name:"No flicker",enabled:!0,gracePeriod:30,maxColorChange:200,maxFlickerIndex:4,maxPropOfCellsChanged:.5,minNumberOfCellsChanged:3,maxPropOfPlainColor:.97,activityLevelWindowSize:30,flickerIndexWindowSize:30},Strict:{name:"Strict",enabled:!0,gracePeriod:30,maxColorChange:150,maxFlickerIndex:5,maxPropOfCellsChanged:.4,minNumberOfCellsChanged:15,maxPropOfPlainColor:.95,activityLevelWindowSize:30,flickerIndexWindowSize:30},Disabled:{name:"Disabled",enabled:!1,gracePeriod:100,maxColorChange:330,maxFlickerIndex:10,maxPropOfCellsChanged:1,minNumberOfCellsChanged:3,maxPropOfPlainColor:.99,activityLevelWindowSize:50,flickerIndexWindowSize:100}});console.log("Loading main.js");var et={gridHeight:29,gridWidth:78,targetCycleTime:100,addRandomness:!1,randomisePeriodicityShiftAndTopology:!1,gridPeriodicityShiftX:0,gridPeriodicityShiftY:0,gridFlipX:!1,gridFlipY:!1,colorPalette:"mouseAnimation",metaRule:"GRMouse",initialisation:"zero",config:Ze.GRMouse,sanityConfig:Qe.Default},tt=new class{constructor({gridHeight:e=200,gridWidth:t=200,widthMult:i=1,heightMult:n=1,targetCycleTime:o=100,addRandomness:a=!0,randomnessAmount:s=-2,randomisePeriodicityShiftAndTopology:l=!0,gridPeriodicityShiftX:g=null,gridPeriodicityShiftY:h=null,gridFlipX:d=!1,gridFlipY:c=!1,colorPalette:u="black2",metaRule:m="VariableGR",initialisation:f="random",logo:p=null,useLogo:C=!1,config:b=null,sanityConfig:y=null}={}){this.config=b,this.sanityConfig=y,this.paused=!1,this.step=!1,this.targetCycleTime=o,this.gridHeight=e,this.gridWidth=t,this.widthMult=i,this.heightMult=n,this.imageHeight=this.heightMult*this.gridHeight,this.imageWidth=this.widthMult*this.gridWidth,this.grid=new r(this.gridWidth,this.gridHeight),this.gridPeriodicityShiftX=g,null==this.gridPeriodicityShiftX&&(this.gridPeriodicityShiftX=Math.floor(1e3*Math.random())%this.gridWidth),this.gridPeriodicityShiftY=h,null==this.gridPeriodicityShiftY&&(this.gridPeriodicityShiftY=Math.floor(1e3*Math.random())%this.gridHeight),this.gridFlipX=d,this.gridFlipY=c,this.mask=null,this.findNeighbour=null,this.tempGridHeight=null,this.tempGridWidth=null,this.imageData=new Uint8ClampedArray(4*this.imageWidth*this.imageHeight).fill(0),this.redraw=new r(this.gridWidth,this.gridHeight),this.colorPalette=u,this.initialisation=f,this.logo=p,this.useLogo=C,this.colors=[],this.nColors=4,this.addRandomness=a,this.randomnessAmount=s,this.randomisePeriodicityShiftAndTopology=l,this.reinitialiseGridFlag=!1,this.changeGridSizeFlag=!1,this.seedSampler=null,this.metaRule=m,this.ruleClass=null,this.updateCellValue=null,this.updateCellValueAuxiliary=null,this.currentRuleAndStyle=null,this.sampledRuleTemplate=null,this.time=0,this.ruleLogSwitchProbability=-25,this.styleLogEvolveProbability=-25,this.paletteLogSwitchProbability=-25,this.changeMetaRuleFlag=!0,this.changeRuleFlag=!1,this.changeBaseRuleFlag=!1,this.changeStyleFlag=!1,this.evolveColoringRuleFlag=!1,this.reloadColorPaletteFlag=!1,this.logMultiplicativeFactor=0,this.logMultiplicativeEvolveFactor=0,this.logMultiplicativePaletteFactor=0,this.pauseEvolution=!1,this.activityLevel=0,this.activityLevelForRule=0,this.activeCells=0,this.nCellChangedHistoric=0,this.meanColorChangeHistoric=0,this.brightness=127,this.maxBrightness=130,this.minBrightness=124,this.diffBrightness=0,this.relCellChanged=0,this.flickerIndex=0,this.colorCount=[0,0,0,0],this.frameExecutionTime=0,this.logEvents=[],this.gif=null,this.gifMode="Download",this.startRecordingGifFlag=!1,this.stopRecordingGifFlag=!1,this.recordingGif=!1,this.nRecordedFrames=0,this.saveEventData=!1,this.updateGlobalDataFromConfig()}resampleRuleClass(){this.ruleClass=new z(this),null!=this.config.styleConfig2&&(this.ruleClass2=new z(this,!0))}updateGlobalDataFromConfig(){"timeBetweenStyleChanges"in this.config?this.logMultiplicativeEvolveFactor=25/this.config.timeBetweenStyleChanges:this.logMultiplicativeEvolveFactor=0,"timeBetweenRuleChanges"in this.config?this.logMultiplicativeFactor=25/this.config.timeBetweenRuleChanges:this.logMultiplicativeFactor=0,"timeBetweenPaletteChanges"in this.config&&(this.logMultiplicativePaletteFactor=25/this.config.timeBetweenPaletteChanges)}determineColorPalette(){J(this)}reloadColor(e){!function(e,t){let i=e.config.paletteConfig.colorPattern[t],r=e.colors.map((e=>e.name)),n=K(e,i,r);n.keepWithinRange(),e.colors[t]=n;let o="color "+t.toString();0==t&&(o="background color"),P(e,"Col | Set the "+o+" to "+e.config.paletteConfig.colorPattern[t]+".")}(this,e)}adjustColorNumber(e){!function(e,t){let i=e.colors.map((e=>e.name));if(t>e.nColors)for(var r=e.nColors;r<t;r++){let t=e.config.paletteConfig.colorPattern[r];e.colors.push(_(e,t,i,r)),i.push(e.colors[r].name)}else t<e.nColors&&(e.colors=e.colors.slice(0,t));e.nColors=t,e.colorCount=new Array(e.nColors).fill(0)}(this,e)}}(et);!function(e){e.canvasCornerX=0,e.canvasCornerY=0,e.canvas=document.getElementById("gameCanvas"),e.canvas.width=e.imageWidth,e.canvas.height=e.imageHeight,e.ctx=e.canvas.getContext("2d",{willReadFrequently:!0})}(tt),window.onload=function(){tt.grid=new r(tt.gridWidth,tt.gridHeight),tt.redraw=new r(tt.gridWidth,tt.gridHeight);const e=document.getElementById("background"),t=e.getContext("2d");tt.backgroundCanvas=e;const i=new Image;i.src="./grWebsiteBackgroundTransp.png?"+(new Date).getTime(),i.onload=function(){t.drawImage(i,0,0,e.width,e.height)},function(e){e.backgroundCanvas.addEventListener("mousemove",(function(t){var i=e.canvas.getBoundingClientRect(),r=t.clientX-i.left,n=t.clientY-i.top,o=i.width/e.gridWidth,a=i.height/e.gridHeight,s=Math.floor(r/o),l=Math.floor(n/a);e.grid.set(l,s,1)}))}(tt),function(e){e.backgroundCanvas.addEventListener("mousedown",(function(t){var i=e.canvas.getBoundingClientRect(),r=t.clientX-i.left,n=t.clientY-i.top,o=i.width/e.gridWidth,a=i.height/e.gridHeight,s=Math.floor(r/o),l=Math.floor(n/a);t.shiftKey||t.ctrlKey?t.shiftKey&&!t.ctrlKey?(e.grid.set(l,(s+1)%e.gridWidth,1),e.grid.set(l,s,1),e.grid.set((l+1)%e.gridHeight,s,1)):!t.shiftKey&&t.ctrlKey?(e.grid.set(l,s,1),e.grid.set((l+1)%e.gridHeight,s,1)):t.shiftKey&&t.ctrlKey&&(e.grid.set(l,s,1),e.grid.set(l,(s+1)%e.gridWidth,1)):(e.grid.set((l+1)%e.gridHeight,(s+1)%e.gridWidth,1),e.grid.set((l-1+e.gridHeight)%e.gridHeight,(s+1)%e.gridWidth,1),e.grid.set((l-1+e.gridHeight)%e.gridHeight,(s-1+e.gridWidth)%e.gridWidth,1),e.grid.set((l+1)%e.gridHeight,(s-1+e.gridWidth)%e.gridWidth,1))}))}(tt),se(tt),function(e){e.stagingConfigs=Ze,e.ruleConfigs=E,e.styleConfigs=Ye,e.paletteConfigs=Xe,e.colorConfigs=U,e.sanityConfigs=Qe,e.randomnessConfigs=H}(tt),function(e){ee(e,!0)}(tt),De(tt,Ue)}})();